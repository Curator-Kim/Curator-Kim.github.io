<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Curator-Kim的小站</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Curator-Kim的小站"><meta name="msapplication-TileImage" content="https://cdn.jsdelivr.net/gh/removeif/removeif-demo@latest/img/favicon.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Curator-Kim的小站"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="NothingLe3t_h3re"><meta property="og:type" content="blog"><meta property="og:title" content="Curator-Kim"><meta property="og:url" content="https://curator-kim.github.io/"><meta property="og:site_name" content="Curator-Kim"><meta property="og:description" content="NothingLe3t_h3re"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://curator-kim.github.io/img/icon.jpg"><meta property="article:author" content="Curator-Kim"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/icon.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://Curator-Kim.github.io"},"headline":"Curator-Kim的小站","image":["http://curator-kim.github.io/img/og_image.png"],"author":{"@type":"Person","name":"Curator-Kim"},"description":"NothingLe3t_h3re"}</script><link rel="icon" href="https://cdn.jsdelivr.net/gh/removeif/removeif-demo@latest/img/favicon.png"><meta name="referrer" content="no-referrer-when-downgrade"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css?family=Ubuntu:400,600|Source+Code+Pro|Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Microsoft YaHei:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&amp;amp;subset=latin,latin-ext|Inconsolata|Itim|Lobster.css"><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="/js/globalUtils.js"></script><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/pace/1.0.2/pace.min.js"></script><link rel="stylesheet" href="/live2d/waifu.css"><script type="text/javascript" async src="/live2d/autoload.js"></script><meta name="generator" content="Hexo 5.4.0"></head><body class="is-3-column has-navbar-fixed-top"><nav class="navbar navbar-main is-fixed-top"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="https://github.com/Curator-Kim/Curator-Kim.github.io/blob/master/img/logo.png?raw=true" alt="Curator-Kim的小站" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item is-active" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a><a class="navbar-item" href="/album">Album</a><a class="navbar-item" href="/friend">Friend</a><a class="navbar-item" href="/message">Message</a><a class="navbar-item" href="/self-talking">Self-talking</a><a class="navbar-item" href="/music">Music</a><a class="navbar-item" href="/media">Media</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Join Gitter" href="https://gitter.im/hexo-theme-amazing/community"><i class="fab fa-gitter"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/removeif/hexo-theme-amazing"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a><a class="navbar-item" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a></div></div></div></nav><script type="text/javascript" src="/js/theme-setting.js"></script><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><!--!--><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2024-02-21  <a class="commentCountImg" href="/2024/02/21/010editor%20%E7%A0%B4%E8%A7%A3%E8%AE%B0%E5%BD%95/#comment-container"><span class="display-none-class">d41d8cd98f00b204e9800998ecf8427e</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="d41d8cd98f00b204e9800998ecf8427e">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>11 m  <i class="fas fa-pencil-alt"> </i>1.7 k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/02/21/010editor%20%E7%A0%B4%E8%A7%A3%E8%AE%B0%E5%BD%95/"> </a></h1><div class="content"><h1 id="010editor-破解记录"><a href="#010editor-破解记录" class="headerlink" title="010editor 破解记录"></a>010editor 破解记录</h1><p>IDA载入，shift+f12搜索字符串，在License界面中有Purchase关键词，搜索相关字符串</p>
<p><img src="/2024/02/21/010editor%20%E7%A0%B4%E8%A7%A3%E8%AE%B0%E5%BD%95/image-20240221200655921.png" alt="image-20240221200655921" style="zoom: 50%;"></p>
<img src="/2024/02/21/010editor%20%E7%A0%B4%E8%A7%A3%E8%AE%B0%E5%BD%95/image-20240221200735396.png" class title="image-20240221200735396">
<p>发现有购买成功相关的字符串，通过交叉引用找到相关代码</p>
<p>在此处根据条件语句，当状态码为219时激活成功，那么网上找到相关赋值函数，进入到sub_140008657中</p>
<img src="/2024/02/21/010editor%20%E7%A0%B4%E8%A7%A3%E8%AE%B0%E5%BD%95/image-20240222161140044.png" class title="image-20240222161140044">
<p>需要v6值为45才可</p>
<img src="/2024/02/21/010editor%20%E7%A0%B4%E8%A7%A3%E8%AE%B0%E5%BD%95/image-20240222161907526.png" class title="image-20240222161907526">
<p>进入该函数中，前面一部分为特殊字符校验，影响不大</p>
<img src="/2024/02/21/010editor%20%E7%A0%B4%E8%A7%A3%E8%AE%B0%E5%BD%95/image-20240223111136789.png" class title="image-20240223111136789">
<p>来到下面的switch(v42)处，据说是三个注册机的版本，分别为0x9c,0xfc和0xac</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">   <span class="keyword">switch</span> ( v42 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0x9C</span>:</span><br><span class="line">        v19 = (<span class="keyword">unsigned</span> __int8)(v44 ^ v41) + ((<span class="keyword">unsigned</span> __int8)(v46 ^ v40) &lt;&lt; <span class="number">8</span>);</span><br><span class="line">        *(_DWORD *)(a1 + <span class="number">44</span>) = (<span class="keyword">unsigned</span> __int8)sub_7FF607F44A1B((<span class="keyword">unsigned</span> __int8)(v45 ^ v39));</span><br><span class="line">        v20 = (<span class="keyword">unsigned</span> __int16)sub_7FF607F4B06E(v19);</span><br><span class="line">        *(_DWORD *)(a1 + <span class="number">48</span>) = (<span class="keyword">unsigned</span> __int16)v20;</span><br><span class="line">        v21 = *(_DWORD *)(a1 + <span class="number">44</span>);</span><br><span class="line">        <span class="keyword">if</span> ( v21 &amp;&amp; (<span class="keyword">unsigned</span> <span class="keyword">int</span>)(v20 - <span class="number">1</span>) &lt;= <span class="number">0x3E7</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          v22 = <span class="number">0</span>;</span><br><span class="line">          <span class="keyword">if</span> ( v21 &lt; <span class="number">2</span> )</span><br><span class="line">            v22 = *(_DWORD *)(a1 + <span class="number">44</span>);</span><br><span class="line">LABEL_26:</span><br><span class="line">          QString::toUtf8(a1 + <span class="number">8</span>, v36);</span><br><span class="line">          LOBYTE(v4) = v18 != <span class="number">-4</span>;</span><br><span class="line">          v24 = QByteArray::data((QByteArray *)v36);</span><br><span class="line">          v25 = j_encrypt((__int64)v24, v4, v22, *(<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(a1 + <span class="number">48</span>));</span><br><span class="line">          <span class="keyword">if</span> ( v43 == (_BYTE)v25 &amp;&amp; (_BYTE)v14 == BYTE1(v25) &amp;&amp; v45 == BYTE2(v25) &amp;&amp; v46 == HIBYTE(v25) )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">if</span> ( v18 == <span class="number">-100</span> )</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="keyword">if</span> ( v34 &gt; *(_DWORD *)(a1 + <span class="number">44</span>) )</span><br><span class="line">              &#123;</span><br><span class="line">                v26 = <span class="number">78</span>;</span><br><span class="line">LABEL_41:</span><br><span class="line">                QByteArray::~QByteArray((QByteArray *)v36);</span><br><span class="line">                <span class="keyword">return</span> v26;                     <span class="comment">// make it 45</span></span><br><span class="line">              &#125;</span><br><span class="line">LABEL_33:</span><br><span class="line">              v26 = <span class="number">45</span>;                         <span class="comment">// here: v18==-100 &amp;&amp; v34&lt;=*(a1+44)</span></span><br><span class="line">              <span class="keyword">goto</span> LABEL_41;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> ( v18 == <span class="number">-4</span> )</span><br><span class="line">            &#123;</span><br><span class="line">              v27 = sub_7FF607F49B8D(v39 + (v40 &lt;&lt; <span class="number">8</span>) + (v41 &lt;&lt; <span class="number">16</span>), v25);</span><br><span class="line">              <span class="keyword">if</span> ( v27 )</span><br><span class="line">              &#123;</span><br><span class="line">                *(_DWORD *)(a1 + <span class="number">40</span>) = v27;</span><br><span class="line">                v26 = <span class="number">147</span>;</span><br><span class="line">                <span class="keyword">goto</span> LABEL_41;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> ( v29 )</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="keyword">if</span> ( v35 &gt; v29 )</span><br><span class="line">              &#123;</span><br><span class="line">                v26 = <span class="number">78</span>;</span><br><span class="line">                <span class="keyword">goto</span> LABEL_41;</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">goto</span> LABEL_33;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          v26 = <span class="number">231</span>;</span><br><span class="line">          <span class="keyword">goto</span> LABEL_41;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xFC</span>:</span><br><span class="line">        v22 = <span class="number">255</span>;</span><br><span class="line">        *(_DWORD *)(a1 + <span class="number">44</span>) = <span class="number">255</span>;</span><br><span class="line">        *(_DWORD *)(a1 + <span class="number">48</span>) = <span class="number">1</span>;</span><br><span class="line">        *(_DWORD *)(a1 + <span class="number">64</span>) = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">goto</span> LABEL_26;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0xAC</span>:</span><br><span class="line">        *(_DWORD *)(a1 + <span class="number">44</span>) = <span class="number">2</span>;</span><br><span class="line">        v23 = sub_7FF607F4B06E((<span class="keyword">unsigned</span> __int16)((<span class="keyword">unsigned</span> __int8)(v14 ^ v15) + ((<span class="keyword">unsigned</span> __int8)(v46 ^ v16) &lt;&lt; <span class="number">8</span>)));</span><br><span class="line">        *(_DWORD *)(a1 + <span class="number">48</span>) = v23;</span><br><span class="line">        <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> <span class="keyword">int</span>)v23 - <span class="number">1</span> &lt;= <span class="number">0x3E7</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          v29 = sub_7FF607F49B8D((v45 ^ v17) + ((v14 ^ v48) &lt;&lt; <span class="number">16</span>) + ((v47 ^ (<span class="keyword">unsigned</span> <span class="keyword">int</span>)v43) &lt;&lt; <span class="number">8</span>), <span class="number">5999655</span>i64);</span><br><span class="line">          *(_DWORD *)(a1 + <span class="number">68</span>) = v29;</span><br><span class="line">          v22 = v29;</span><br><span class="line">          <span class="keyword">goto</span> LABEL_26;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>此处分析0xac版本的注册机</p>
<p>注意第一次if，需要v23-1&lt;=0x3e7</p>
<img src="/2024/02/21/010editor%20%E7%A0%B4%E8%A7%A3%E8%AE%B0%E5%BD%95/image-20240223160541196.png" class title="image-20240223160541196">
<p>随后有第二个函数sub_7FF607F49B8D也进行了类似的操作</p>
<p>注意所赋值的v29在后面需要与v35进行比较，而v35在一开始便被赋值19569，因此需要函数返回大于等于19569的值</p>
<img src="/2024/02/21/010editor%20%E7%A0%B4%E8%A7%A3%E8%AE%B0%E5%BD%95/image-20240224092847505.png" class title="image-20240224092847505">
<p>在所有版本的注册机最后都会对用户名进行操作，计算相应的注册码</p>
<img src="/2024/02/21/010editor%20%E7%A0%B4%E8%A7%A3%E8%AE%B0%E5%BD%95/image-20240224093138362.png" class title="image-20240224093138362">
<p>encrypt的参数v22和*(a1+48)为此前两个if处计算得到的结果，而encrypt的算法并不太需要去分析，根据输入的用户名和参数顺着计算一遍即可</p>
<img src="/2024/02/21/010editor%20%E7%A0%B4%E8%A7%A3%E8%AE%B0%E5%BD%95/image-20240224093401137.png" class title="image-20240224093401137">
<p>据此可以得到0xac版本的注册机算法，代码略微凌乱，还有些部分注册码的含义为搞明白，例如有效期啥的，后面有空再补吧</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line">name=<span class="string">&quot;DeadBeeef&quot;</span></span><br><span class="line">NUM1=<span class="number">0xff</span></span><br><span class="line">NUM2=<span class="number">0x5b</span></span><br><span class="line"></span><br><span class="line">v5=<span class="number">0</span></span><br><span class="line">v9=<span class="number">0</span></span><br><span class="line">v10 = <span class="number">15</span> * NUM2</span><br><span class="line">v11 = <span class="number">0</span></span><br><span class="line">v12 = <span class="number">17</span> * NUM1</span><br><span class="line">box=[<span class="number">0x39CB44B8</span>, <span class="number">0x23754F67</span>, <span class="number">0x5F017211</span>, <span class="number">0x3EBB24DA</span>, <span class="number">0x351707C6</span>, <span class="number">0x63F9774B</span>, <span class="number">0x17827288</span>,</span><br><span class="line"><span class="number">0x0FE74821</span>, <span class="number">0x5B5F670F</span>, <span class="number">0x48315AE8</span>, <span class="number">0x785B7769</span>, <span class="number">0x2B7A1547</span>, <span class="number">0x38D11292</span>, <span class="number">0x42A11B32</span>,</span><br><span class="line"><span class="number">0x35332244</span>, <span class="number">0x77437B60</span>, <span class="number">0x1EAB3B10</span>, <span class="number">0x53810000</span>, <span class="number">0x1D0212AE</span>, <span class="number">0x6F0377A8</span>, <span class="number">0x43C03092</span>,</span><br><span class="line"><span class="number">0x2D3C0A8E</span>, <span class="number">0x62950CBF</span>, <span class="number">0x30F06FFA</span>, <span class="number">0x34F710E0</span>, <span class="number">0x28F417FB</span>, <span class="number">0x350D2F95</span>, <span class="number">0x5A361D5A</span>,</span><br><span class="line"><span class="number">0x15CC060B</span>, <span class="number">0x0AFD13CC</span>, <span class="number">0x28603BCF</span>, <span class="number">0x3371066B</span>, <span class="number">0x30CD14E4</span>, <span class="number">0x175D3A67</span>, <span class="number">0x6DD66A13</span>,</span><br><span class="line"><span class="number">0x2D3409F9</span>, <span class="number">0x581E7B82</span>, <span class="number">0x76526B99</span>, <span class="number">0x5C8D5188</span>, <span class="number">0x2C857971</span>, <span class="number">0x15F51FC0</span>, <span class="number">0x68CC0D11</span>,</span><br><span class="line"><span class="number">0x49F55E5C</span>, <span class="number">0x275E4364</span>, <span class="number">0x2D1E0DBC</span>, <span class="number">0x4CEE7CE3</span>, <span class="number">0x32555840</span>, <span class="number">0x112E2E08</span>, <span class="number">0x6978065A</span>,</span><br><span class="line"><span class="number">0x72921406</span>, <span class="number">0x314578E7</span>, <span class="number">0x175621B7</span>, <span class="number">0x40771DBF</span>, <span class="number">0x3FC238D6</span>, <span class="number">0x4A31128A</span>, <span class="number">0x2DAD036E</span>,</span><br><span class="line"><span class="number">0x41A069D6</span>, <span class="number">0x25400192</span>, <span class="number">0x0DD4667</span>, <span class="number">0x6AFC1F4F</span>, <span class="number">0x571040CE</span>, <span class="number">0x62FE66DF</span>, <span class="number">0x41DB4B3E</span>,</span><br><span class="line"><span class="number">0x3582231F</span>, <span class="number">0x55F6079A</span>, <span class="number">0x1CA70644</span>, <span class="number">0x1B1643D2</span>, <span class="number">0x3F7228C9</span>, <span class="number">0x5F141070</span>, <span class="number">0x3E1474AB</span>,</span><br><span class="line"><span class="number">0x444B256E</span>, <span class="number">0x537050D9</span>, <span class="number">0x0F42094B</span>, <span class="number">0x2FD820E6</span>, <span class="number">0x778B2E5E</span>, <span class="number">0x71176D02</span>, <span class="number">0x7FEA7A69</span>,</span><br><span class="line"><span class="number">0x5BB54628</span>, <span class="number">0x19BA6C71</span>, <span class="number">0x39763A99</span>, <span class="number">0x178D54CD</span>, <span class="number">0x1246E88</span>, <span class="number">0x3313537E</span>, <span class="number">0x2B8E2D17</span>,</span><br><span class="line"><span class="number">0x2A3D10BE</span>, <span class="number">0x59D10582</span>, <span class="number">0x37A163DB</span>, <span class="number">0x30D6489A</span>, <span class="number">0x6A215C46</span>, <span class="number">0x0E1C7A76</span>, <span class="number">0x1FC760E7</span>,</span><br><span class="line"><span class="number">0x79B80C65</span>, <span class="number">0x27F459B4</span>, <span class="number">0x799A7326</span>, <span class="number">0x50BA1782</span>, <span class="number">0x2A116D5C</span>, <span class="number">0x63866E1B</span>, <span class="number">0x3F920E3C</span>,</span><br><span class="line"><span class="number">0x55023490</span>, <span class="number">0x55B56089</span>, <span class="number">0x2C391FD1</span>, <span class="number">0x2F8035C2</span>, <span class="number">0x64FD2B7A</span>, <span class="number">0x4CE8759A</span>, <span class="number">0x518504F0</span>,</span><br><span class="line"><span class="number">0x799501A8</span>, <span class="number">0x3F5B2CAD</span>, <span class="number">0x38E60160</span>, <span class="number">0x637641D8</span>, <span class="number">0x33352A42</span>, <span class="number">0x51A22C19</span>, <span class="number">0x85C5851</span>,</span><br><span class="line"><span class="number">0x32917AB</span>, <span class="number">0x2B770AC7</span>, <span class="number">0x30AC77B3</span>, <span class="number">0x2BEC1907</span>, <span class="number">0x35202D0</span>, <span class="number">0x0FA933D3</span>, <span class="number">0x61255DF3</span>,</span><br><span class="line"><span class="number">0x22AD06BF</span>, <span class="number">0x58B86971</span>, <span class="number">0x5FCA0DE5</span>, <span class="number">0x700D6456</span>, <span class="number">0x56A973DB</span>, <span class="number">0x5AB759FD</span>, <span class="number">0x330E0BE2</span>,</span><br><span class="line"><span class="number">0x5B3C0DDD</span>, <span class="number">0x495D3C60</span>, <span class="number">0x53BD59A6</span>, <span class="number">0x4C5E6D91</span>, <span class="number">0x49D9318D</span>, <span class="number">0x103D5079</span>, <span class="number">0x61CE42E3</span>,</span><br><span class="line"><span class="number">0x7ED5121D</span>, <span class="number">0x14E160ED</span>, <span class="number">0x212D4EF2</span>, <span class="number">0x270133F0</span>, <span class="number">0x62435A96</span>, <span class="number">0x1FA75E8B</span>, <span class="number">0x6F092FBE</span>,</span><br><span class="line"><span class="number">0x4A000D49</span>, <span class="number">0x57AE1C70</span>, <span class="number">0x4E2477</span>, <span class="number">0x561E7E72</span>, <span class="number">0x468C0033</span>, <span class="number">0x5DCC2402</span>, <span class="number">0x78507AC6</span>,</span><br><span class="line"><span class="number">0x58AF24C7</span>, <span class="number">0x0DF62D34</span>, <span class="number">0x358A4708</span>, <span class="number">0x3CFB1E11</span>, <span class="number">0x2B71451C</span>, <span class="number">0x77A75295</span>, <span class="number">0x56890721</span>,</span><br><span class="line"><span class="number">0x0FEF75F3</span>, <span class="number">0x120F24F1</span>, <span class="number">0x1990AE7</span>, <span class="number">0x339C4452</span>, <span class="number">0x27A15B8E</span>, <span class="number">0x0BA7276D</span>, <span class="number">0x60DC1B7B</span>,</span><br><span class="line"><span class="number">0x4F4B7F82</span>, <span class="number">0x67DB7007</span>, <span class="number">0x4F4A57D9</span>, <span class="number">0x621252E8</span>, <span class="number">0x20532CFC</span>, <span class="number">0x6A390306</span>, <span class="number">0x18800423</span>,</span><br><span class="line"><span class="number">0x19F3778A</span>, <span class="number">0x462316F0</span>, <span class="number">0x56AE0937</span>, <span class="number">0x43C2675C</span>, <span class="number">0x65CA45FD</span>, <span class="number">0x0D604FF2</span>, <span class="number">0x0BFD22CB</span>,</span><br><span class="line"><span class="number">0x3AFE643B</span>, <span class="number">0x3BF67FA6</span>, <span class="number">0x44623579</span>, <span class="number">0x184031F8</span>, <span class="number">0x32174F97</span>, <span class="number">0x4C6A092A</span>, <span class="number">0x5FB50261</span>,</span><br><span class="line"><span class="number">0x1650174</span>, <span class="number">0x33634AF1</span>, <span class="number">0x712D18F4</span>, <span class="number">0x6E997169</span>, <span class="number">0x5DAB7AFE</span>, <span class="number">0x7C2B2EE8</span>, <span class="number">0x6EDB75B4</span>,</span><br><span class="line"><span class="number">0x5F836FB6</span>, <span class="number">0x3C2A6DD6</span>, <span class="number">0x292D05C2</span>, <span class="number">0x52244DB</span>, <span class="number">0x149A5F4F</span>, <span class="number">0x5D486540</span>, <span class="number">0x331D15EA</span>,</span><br><span class="line"><span class="number">0x4F456920</span>, <span class="number">0x483A699F</span>, <span class="number">0x3B450F05</span>, <span class="number">0x3B207C6C</span>, <span class="number">0x749D70FE</span>, <span class="number">0x417461F6</span>, <span class="number">0x62B031F1</span>,</span><br><span class="line"><span class="number">0x2750577B</span>, <span class="number">0x29131533</span>, <span class="number">0x588C3808</span>, <span class="number">0x1AEF3456</span>, <span class="number">0x0F3C00EC</span>, <span class="number">0x7DA74742</span>, <span class="number">0x4B797A6C</span>,</span><br><span class="line"><span class="number">0x5EBB3287</span>, <span class="number">0x786558B8</span>, <span class="number">0x0ED4FF2</span>, <span class="number">0x6269691E</span>, <span class="number">0x24A2255F</span>, <span class="number">0x62C11F7E</span>, <span class="number">0x2F8A7DCD</span>,</span><br><span class="line"><span class="number">0x643B17FE</span>, <span class="number">0x778318B8</span>, <span class="number">0x253B60FE</span>, <span class="number">0x34BB63A3</span>, <span class="number">0x5B03214F</span>, <span class="number">0x5F1571F4</span>, <span class="number">0x1A316E9F</span>,</span><br><span class="line"><span class="number">0x7ACF2704</span>, <span class="number">0x28896838</span>, <span class="number">0x18614677</span>, <span class="number">0x1BF569EB</span>, <span class="number">0x0BA85EC9</span>, <span class="number">0x6ACA6B46</span>, <span class="number">0x1E43422A</span>,</span><br><span class="line"><span class="number">0x514D5F0E</span>, <span class="number">0x413E018C</span>, <span class="number">0x307626E9</span>, <span class="number">0x1ED1DFA</span>, <span class="number">0x49F46F5A</span>, <span class="number">0x461B642B</span>, <span class="number">0x7D7007F2</span>,</span><br><span class="line"><span class="number">0x13652657</span>, <span class="number">0x6B160BC5</span>, <span class="number">0x65E04849</span>, <span class="number">0x1F526E1C</span>, <span class="number">0x5A0251B6</span>, <span class="number">0x2BD73F69</span>, <span class="number">0x2DBF7ACD</span>,</span><br><span class="line"><span class="number">0x51E63E80</span>, <span class="number">0x5CF2670F</span>, <span class="number">0x21CD0A03</span>, <span class="number">0x5CFF0261</span>, <span class="number">0x33AE061E</span>, <span class="number">0x3BB6345F</span>, <span class="number">0x5D814A75</span>,</span><br><span class="line"><span class="number">0x257B5DF4</span>, <span class="number">0x0A5C2C5B</span>, <span class="number">0x16A45527</span>, <span class="number">0x16F23945</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(name)):</span><br><span class="line">    v13=<span class="built_in">ord</span>(name[i].upper())</span><br><span class="line">    v14=box[v12%<span class="number">256</span>]</span><br><span class="line">    v15=(v5+box[v13])%(<span class="number">1</span>&lt;&lt;<span class="number">32</span>)</span><br><span class="line">    v16=box[v10%<span class="number">256</span>]</span><br><span class="line"></span><br><span class="line">    v17=box[(v13+<span class="number">13</span>)%<span class="number">256</span>]</span><br><span class="line">    v18=(v13+<span class="number">47</span>)%<span class="number">256</span></span><br><span class="line">    v19=v9</span><br><span class="line"></span><br><span class="line">    v12+=<span class="number">9</span></span><br><span class="line">    v10+=<span class="number">13</span></span><br><span class="line">    v9+=<span class="number">19</span></span><br><span class="line">    v11+=<span class="number">7</span></span><br><span class="line">    v12,v10,v9,v11=v12%<span class="number">256</span>,v10%<span class="number">256</span>,v9%<span class="number">256</span>,v11%<span class="number">256</span></span><br><span class="line">    v5=(v16+v14+box[v19]+box[v18]*(v15^v17))%(<span class="number">1</span>&lt;&lt;<span class="number">32</span>)</span><br><span class="line">s = <span class="built_in">hex</span>(v5)[<span class="number">2</span>:].zfill(<span class="number">8</span>)</span><br><span class="line"><span class="built_in">print</span>(s[<span class="number">6</span>:]+s[<span class="number">4</span>:<span class="number">6</span>]+s[<span class="number">2</span>:<span class="number">4</span>]+s[<span class="number">0</span>:<span class="number">2</span>])</span><br><span class="line">a5,a6,a7,a8 = <span class="built_in">int</span>(s[<span class="number">6</span>:],<span class="number">16</span>),<span class="built_in">int</span>(s[<span class="number">4</span>:<span class="number">6</span>],<span class="number">16</span>),<span class="built_in">int</span>(s[<span class="number">2</span>:<span class="number">4</span>],<span class="number">16</span>),<span class="built_in">int</span>(s[<span class="number">0</span>:<span class="number">2</span>],<span class="number">16</span>)</span><br><span class="line"><span class="comment"># active_code=a1a2-a3a4-a5a6-a7a8-a9a10</span></span><br><span class="line"><span class="comment"># a6^a3 + (a8^a2)&lt;&lt;8</span></span><br><span class="line"><span class="comment"># need: func(a1)&lt;=0x3E8</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func1</span>(<span class="params">a1</span>):</span></span><br><span class="line">    v1 = (((a1 ^ <span class="number">0x7892</span>) + <span class="number">0x4D30</span>) ^ <span class="number">0x3421</span>) % (<span class="number">1</span>&lt;&lt;<span class="number">16</span>)</span><br><span class="line">    <span class="keyword">if</span> v1 % <span class="number">0xB</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">int</span>(v1/<span class="number">0xB</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">    a3=random.randint(<span class="number">1</span>,<span class="number">0xff</span>)</span><br><span class="line">    a2=random.randint(<span class="number">1</span>,<span class="number">0xff</span>)</span><br><span class="line">    A = a6^a3 + ((a8^a2)&lt;&lt;<span class="number">8</span>)</span><br><span class="line">    <span class="keyword">if</span> func1(A)&lt;=<span class="number">0x3E8</span> <span class="keyword">and</span> func1(A)&amp;<span class="number">0xff</span>==NUM2:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(a2),<span class="built_in">hex</span>(a3))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(func1(A)))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func2</span>(<span class="params">a1,a2</span>):</span></span><br><span class="line">    v2 = (((a2 ^ a1 ^ <span class="number">0x22C078</span>) - <span class="number">180597</span>) ^ <span class="number">0xFFE53167</span>) &amp; <span class="number">0xFFFFFF</span></span><br><span class="line">    result = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> ( v2 == <span class="number">17</span> * (v2 / <span class="number">0x11</span>) ):</span><br><span class="line">        result = v2 / <span class="number">0x11</span></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">    a1=random.randint(<span class="number">1</span>,<span class="number">0xff</span>)</span><br><span class="line">    a10=random.randint(<span class="number">1</span>,<span class="number">0xff</span>)</span><br><span class="line">    a9=random.randint(<span class="number">1</span>,<span class="number">0xff</span>)</span><br><span class="line">    v22 = func2((a7^a1) + ((a6^a10)&lt;&lt;<span class="number">16</span>) + ((a9^a5)&lt;&lt;<span class="number">8</span>),<span class="number">0x5B8C27</span>)</span><br><span class="line">    <span class="keyword">if</span> v22%<span class="number">256</span>==NUM1 <span class="keyword">and</span> v22 &gt;<span class="number">0x4c71</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(a1),<span class="built_in">hex</span>(a9),<span class="built_in">hex</span>(a10))</span><br><span class="line">a4=<span class="number">0xac</span></span><br><span class="line"><span class="comment"># 36e9-38ac-50b6-947f-433e</span></span><br><span class="line"><span class="comment"># (a7^a1) + ((a6^a10)&lt;&lt;16) + ((a9^a5)&lt;&lt;8)</span></span><br><span class="line"></span><br><span class="line">CODE = <span class="built_in">hex</span>(a1)[<span class="number">2</span>:].zfill(<span class="number">2</span>)+<span class="built_in">hex</span>(a2)[<span class="number">2</span>:].zfill(<span class="number">2</span>)+<span class="built_in">hex</span>(a3)[<span class="number">2</span>:].zfill(<span class="number">2</span>)\</span><br><span class="line">    +<span class="built_in">hex</span>(a4)[<span class="number">2</span>:].zfill(<span class="number">2</span>)+<span class="built_in">hex</span>(a5)[<span class="number">2</span>:].zfill(<span class="number">2</span>)+<span class="built_in">hex</span>(a6)[<span class="number">2</span>:].zfill(<span class="number">2</span>)\</span><br><span class="line">        +<span class="built_in">hex</span>(a7)[<span class="number">2</span>:].zfill(<span class="number">2</span>)+<span class="built_in">hex</span>(a8)[<span class="number">2</span>:].zfill(<span class="number">2</span>)+<span class="built_in">hex</span>(a9)[<span class="number">2</span>:].zfill(<span class="number">2</span>)+<span class="built_in">hex</span>(a10)[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(CODE)</span><br></pre></td></tr></table></figure>
<p><strong>参考资料</strong></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://bbs.kanxue.com/thread-270316.htm">[原创]010Editor破解(0xac版key注册算法分析)-软件逆向-看雪-安全社区|安全招聘|kanxue.com</a></li>
</ul>
</div><div class="index-category-tag">  <hr></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2024-02-07  <a class="commentCountImg" href="/2024/02/07/L3HCTF%202024/#comment-container"><span class="display-none-class">d41d8cd98f00b204e9800998ecf8427e</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="d41d8cd98f00b204e9800998ecf8427e">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>43 m  <i class="fas fa-pencil-alt"> </i>6.4 k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/02/07/L3HCTF%202024/"> </a></h1><div class="content"><h1 id="L3HCTF-2024"><a href="#L3HCTF-2024" class="headerlink" title="L3HCTF 2024"></a>L3HCTF 2024</h1><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="can-you-guess-me"><a href="#can-you-guess-me" class="headerlink" title="can_you_guess_me"></a>can_you_guess_me</h3><p>题目描述</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from random import *</span><br><span class="line">from secret import flag</span><br><span class="line"></span><br><span class="line">q = getPrime(128)</span><br><span class="line"></span><br><span class="line">n = 5</span><br><span class="line">T = 2**48</span><br><span class="line">E = 2**32</span><br><span class="line"></span><br><span class="line">t = [randint(1,T) for i in range(n)]</span><br><span class="line">e = [randint(1,E) for i in range(n)]</span><br><span class="line">a = [(t[i] * flag - e[i]) % q for i in range(n)]</span><br><span class="line"></span><br><span class="line">print(&#x27;q =&#x27;, q)</span><br><span class="line">print(&#x27;a =&#x27;, a)</span><br><span class="line"></span><br><span class="line">flag = &quot;L3HSEC&#123;&quot; + hex(flag)[2:] + &quot;&#125;&quot;</span><br><span class="line"></span><br><span class="line">print(&#x27;flag =&#x27;, flag)</span><br><span class="line"></span><br><span class="line"># q = 313199526393254794805899275326380083313</span><br><span class="line"># a = [258948702106389340127909287396807150259, 130878573261697415793888397911168583971, 287085364108707601156242002650192970665, 172240654236516299340495055728541554805, 206056586779420225992168537876290239524]</span><br></pre></td></tr></table></figure>
<p>一个AGCD的问题</p>
<p>正常用类似用形如以下的格可解</p>
<img src="/2024/02/07/L3HCTF%202024/image-20240211160622900.png" class title="image-20240211160622900">
<p>但界不够，再仔细观察，发现从中可至多提取10组式子，从而可以求解出t，然后再用一次LLL即可把e求出</p>
<p>贴出dl的解</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">q = 313199526393254794805899275326380083313</span><br><span class="line">a = [258948702106389340127909287396807150259, 130878573261697415793888397911168583971, 287085364108707601156242002650192970665, 172240654236516299340495055728541554805, 206056586779420225992168537876290239524]</span><br><span class="line"></span><br><span class="line">m = matrix([[a[1],a[2],a[3],a[4],   0,0,0,                 2^32,0,0,0,0],</span><br><span class="line">            [a[0],0,0,0,            -a[2],-a[3],-a[4],     0,2^32,0,0,0],</span><br><span class="line">            [0,a[0],0,0,            a[1],0,0,              0,0,2^32,0,0],</span><br><span class="line">            [0,0,a[0],0,            0,a[1],0,              0,0,0,2^32,0],</span><br><span class="line">            [0,0,0,a[0],            0,0,a[1],              0,0,0,0,2^32],</span><br><span class="line">            [q,0,0,0,               0,0,0,                 0,0,0,0,0],</span><br><span class="line">            [0,q,0,0,               0,0,0,                 0,0,0,0,0],</span><br><span class="line">            [0,0,q,0,               0,0,0,                 0,0,0,0,0],</span><br><span class="line">            [0,0,0,q,               0,0,0,                 0,0,0,0,0],</span><br><span class="line">            [0,0,0,0,               q,0,0,                 0,0,0,0,0],</span><br><span class="line">            [0,0,0,0,               0,q,0,                 0,0,0,0,0],</span><br><span class="line">            [0,0,0,0,               0,0,q,                 0,0,0,0,0]])</span><br><span class="line"></span><br><span class="line">t = [abs(i/2^32) for i in (m.BKZ()[0][-5:])]</span><br><span class="line">print(t)</span><br><span class="line"></span><br><span class="line">m = matrix(7,6)</span><br><span class="line">for i in range(5):</span><br><span class="line">    m[0,i] = t[i]</span><br><span class="line">    m[1,i] = a[i]</span><br><span class="line">    m[i+2,i] = q</span><br><span class="line">m[1,-1] = 1</span><br><span class="line">print(m.LLL())</span><br><span class="line"></span><br><span class="line">e1 = 1207385170</span><br><span class="line">print(hex(((a[0]+e1)/t[0])%q))</span><br></pre></td></tr></table></figure>
<h3 id="babySPN"><a href="#babySPN" class="headerlink" title="babySPN"></a>babySPN</h3><p>题目里面直接给key了，打印哈希值就好</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">K = [0, 0, 1, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 1]</span><br><span class="line"></span><br><span class="line">assert len(K) == 32</span><br><span class="line">for i in K:</span><br><span class="line">    assert i == 0 or i == 1</span><br><span class="line"></span><br><span class="line">hash_value = sha256(long_to_bytes(list_to_int(K))).hexdigest()</span><br></pre></td></tr></table></figure>
<h3 id="babySPN-revenge4"><a href="#babySPN-revenge4" class="headerlink" title="babySPN revenge4"></a>babySPN revenge4</h3><p>题目描述</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">import random</span><br><span class="line">import time</span><br><span class="line">from secret import flag, K</span><br><span class="line">from hashlib import sha256</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">def bin_to_list(r, bit_len):</span><br><span class="line">    list = [r &gt;&gt; d &amp; 1 for d in range(bit_len)][::-1]</span><br><span class="line">    return list</span><br><span class="line"></span><br><span class="line">def list_to_int(list):</span><br><span class="line">    return int(&quot;&quot;.join(str(i) for i in list), 2)</span><br><span class="line"></span><br><span class="line">Pbox=[1, 5, 9, 13, 2, 6, 10, 14, 3, 7, 11, 15, 4, 8, 12, 16]</span><br><span class="line">Sbox=[14, 13, 11, 0, 2, 1, 4, 15, 7, 10, 8, 5, 9, 12, 3, 6]</span><br><span class="line"></span><br><span class="line">def round_func(X,r,K):</span><br><span class="line">    kstart=4*r - 4</span><br><span class="line">    XX = [0] * 16</span><br><span class="line">    for i in range(16):</span><br><span class="line">        XX[i] = X[i] ^ K[kstart+i]</span><br><span class="line">    for i in range(4):</span><br><span class="line">        value = list_to_int(XX[4*i:4*i+4])</span><br><span class="line">        s_value = Sbox[value]</span><br><span class="line">        s_list = bin_to_list(s_value, 4)</span><br><span class="line">        XX[4*i],XX[4*i+1],XX[4*i+2],XX[4*i+3] = s_list[0],s_list[1],s_list[2],s_list[3]</span><br><span class="line"></span><br><span class="line">    Y=[0] * 16</span><br><span class="line">    for i in range(16):</span><br><span class="line">        Y[Pbox[i]-1]=XX[i]</span><br><span class="line">    return Y</span><br><span class="line"></span><br><span class="line">def enc(X,K):</span><br><span class="line">    Y = round_func(X,1,K)</span><br><span class="line">    Y = round_func(Y,2,K)</span><br><span class="line">    Y = round_func(Y,3,K)</span><br><span class="line">    Y = round_func(Y,4,K)</span><br><span class="line"></span><br><span class="line">    kstart=4*5 - 4</span><br><span class="line">    for i in range(16):</span><br><span class="line">        Y[i] ^= K[kstart+i]</span><br><span class="line">    return Y</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">assert len(K) == 32</span><br><span class="line">for i in K:</span><br><span class="line">    assert i == 0 or i == 1</span><br><span class="line"></span><br><span class="line">hash_value = sha256(long_to_bytes(list_to_int(K))).hexdigest()</span><br><span class="line">print(hash_value)</span><br><span class="line">assert flag[7:-1] == hash_value</span><br><span class="line"></span><br><span class="line">XX = [0]*16</span><br><span class="line">for i in range(4):</span><br><span class="line">    XX[i*4] = 1</span><br><span class="line">    print(enc(XX,K))</span><br><span class="line">    XX[i*4] = 0</span><br><span class="line"></span><br><span class="line"># [0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1]</span><br><span class="line"># [0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0]</span><br><span class="line"># [0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 1]</span><br><span class="line"># [0, 1, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 1, 1, 1]</span><br></pre></td></tr></table></figure>
<p>非预期解：</p>
<p>密钥长度较短，只有32位，直接选择爆破密钥</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;windef.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;wincrypt.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> Pbox[<span class="number">16</span>] = &#123; <span class="number">1</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">13</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">16</span> &#125;;</span><br><span class="line"><span class="keyword">char</span> Sbox[<span class="number">16</span>] = &#123; <span class="number">14</span>, <span class="number">13</span>, <span class="number">11</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">15</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">3</span>, <span class="number">6</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">round_func</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> X, <span class="keyword">unsigned</span> <span class="keyword">int</span> r, <span class="keyword">unsigned</span> <span class="keyword">int</span> K)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> kstart,XX,X1,X2,X3,X4;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> Y[<span class="number">16</span>];</span><br><span class="line">    kstart = <span class="number">4</span> * r - <span class="number">4</span>;</span><br><span class="line">    XX = X ^ ((K &gt;&gt; (<span class="number">16</span>-kstart)) &amp; <span class="number">0xffff</span>);</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">        X1 = Sbox[XX &gt;&gt; <span class="number">12</span>];</span><br><span class="line">        X2 = Sbox[(XX &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xF</span>];</span><br><span class="line">        X3 = Sbox[(XX &gt;&gt; <span class="number">4</span>) &amp; <span class="number">0xF</span>];</span><br><span class="line">        X4 = Sbox[(XX) &amp; <span class="number">0xF</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    XX = (X1 &lt;&lt; <span class="number">12</span>) | (X2 &lt;&lt; <span class="number">8</span>) | (X3 &lt;&lt; <span class="number">4</span>) | X4;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> tmp[<span class="number">16</span>];</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">15</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        tmp[i] = XX &amp; <span class="number">1</span>;</span><br><span class="line">        XX &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) &#123;</span><br><span class="line">        Y[Pbox[i] - <span class="number">1</span>] = tmp[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) &#123;</span><br><span class="line">        res &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">        res += Y[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">enc</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> X, <span class="keyword">unsigned</span> <span class="keyword">int</span> K)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> Y;</span><br><span class="line">    Y = round_func(X, <span class="number">1</span>, K);</span><br><span class="line">    Y = round_func(Y, <span class="number">2</span>, K);</span><br><span class="line">    Y = round_func(Y, <span class="number">3</span>, K);</span><br><span class="line">    Y = round_func(Y, <span class="number">4</span>, K);</span><br><span class="line">    Y ^= K &amp; <span class="number">0xffff</span>;</span><br><span class="line">    <span class="keyword">return</span> Y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> XX[<span class="number">4</span>] = &#123;<span class="number">32768</span>,<span class="number">2048</span>,<span class="number">128</span>,<span class="number">8</span>&#125;, K, target[<span class="number">4</span>]=&#123;<span class="number">8577</span>,<span class="number">29174</span>,<span class="number">29121</span>,<span class="number">31367</span>&#125;, tmp[<span class="number">16</span>];</span><br><span class="line">    <span class="keyword">char</span> flag = <span class="number">1</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (K = <span class="number">0</span>; K &lt; <span class="number">4294967295</span>; K++) &#123;</span><br><span class="line">        flag = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">            tmp[i] = enc(XX[i], K);</span><br><span class="line">            <span class="keyword">if</span> (tmp[i] != target[i]) &#123;</span><br><span class="line">                flag = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (flag==<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;find: %d\n&quot;</span>, K);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> t;</span><br><span class="line">    t = enc(XX[<span class="number">3</span>], <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">15</span>; i &gt; <span class="number">-1</span>; i--) &#123;</span><br><span class="line">        tmp[i] = t &amp; <span class="number">1</span>;</span><br><span class="line">        t &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, tmp[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其他dl的解法：</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/JustGo12/p/18009944">L3HCTF 2024 -Cry部分 - JustG0 - 博客园 (cnblogs.com)</a></p>
<p>中间相遇攻击，正向跑两轮，需要key的前20bit,再逆向跑两轮，需要key的后24bit</p>
<h3 id="baddriwe"><a href="#baddriwe" class="headerlink" title="baddriwe"></a>baddriwe</h3><p>题目描述</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from random import *</span><br><span class="line">import random</span><br><span class="line">import numpy as np</span><br><span class="line">from secret import flag, sk</span><br><span class="line"></span><br><span class="line">assert len(flag[7:-1]) &lt;= 64</span><br><span class="line">data = [ord(i) for i in list(flag[7:-1])]</span><br><span class="line"></span><br><span class="line">for i in range(len(sk)):</span><br><span class="line">    assert data[i] == sk[i] </span><br><span class="line"></span><br><span class="line">q = 1219077173</span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(q), &#x27;x&#x27;)</span><br><span class="line">N = 1024</span><br><span class="line"></span><br><span class="line">f = x^N - 1</span><br><span class="line"></span><br><span class="line">a = [0] * N</span><br><span class="line">for i in range(N):</span><br><span class="line">    a[i] = randint(0, q)</span><br><span class="line"></span><br><span class="line">s = sk</span><br><span class="line"></span><br><span class="line">e = [0] * N</span><br><span class="line">for i in range(N):</span><br><span class="line">    val = np.random.normal(loc=0.0, scale=2.1, size=None)</span><br><span class="line">    e[i] = int(val)</span><br><span class="line"></span><br><span class="line">a = R(a)</span><br><span class="line">s = R(s)</span><br><span class="line">e = R(e)</span><br><span class="line">b = (a*s + e)%f</span><br><span class="line"></span><br><span class="line">print(a)</span><br><span class="line">print(b)</span><br><span class="line">print(q)</span><br><span class="line"></span><br><span class="line"># 1219077173</span><br><span class="line"># 216047404*x^1023 + 1008199117*x^1022 + 39562072*x^1021 + 189992355*x^1020 + 1087671639*x^1019 + 541371337*x^1018 + 1146044200*x^1017 + 212969175*x^1016 + 1114159572*x^1015 + 1112032860*x^1014 + 1204883609*x^1013 + 1181544913*x^1012 + 851496082*x^1011 + 222877006*x^1010 + 163176236*x^1009 + 268697504*x^1008 + 613151090*x^1007 + 1185245256*x^1006 + 215725010*x^1005 + 789898500*x^1004 + 1156619111*x^1003 + 610859911*x^1002 + 959814483*x^1001 + 684353251*x^1000 + 290850651*x^999 + 675880502*x^998 + 836239751*x^997 + 487296407*x^996 + 778816128*x^995 + 1013639221*x^994 + 189137575*x^993 + 172217836*x^992 + 572872008*x^991 + 865759581*x^990 + 399805736*x^989 + 394587004*x^988 + 633085719*x^987 + 15142893*x^986 + 461176831*x^985 + 1078060208*x^984 + 787396508*x^983 + 877420202*x^982 + 1121486845*x^981 + 146921816*x^980 + 670134387*x^979 + 574407635*x^978 + 1148395437*x^977 + 748514947*x^976 + 970442995*x^975 + 280085063*x^974 + 420670822*x^973 + 20159574*x^972 + 219680665*x^971 + 401202858*x^970 + 328444623*x^969 + 623312316*x^968 + 917712264*x^967 + 588061576*x^966 + 625482841*x^965 + 220929234*x^964 + 778461001*x^963 + 498203565*x^962 + 1055981771*x^961 + 70562147*x^960 + 931081750*x^959 + 93569863*x^958 + 314876311*x^957 + 932364613*x^956 + 1132016772*x^955 + 371703330*x^954 + 189301560*x^953 + 739232608*x^952 + 916695967*x^951 + 399818344*x^950 + 558604923*x^949 + 1092603913*x^948 + 987195616*x^947 + 665679589*x^946 + 1142632478*x^945 + 198797278*x^944 + 110832477*x^943 + 775688737*x^942 + 275416086*x^941 + 435656120*x^940 + 754150483*x^939 + 1024583186*x^938 + 972075461*x^937 + 1071060217*x^936 + 710789980*x^935 + 691361770*x^934 + 1097024307*x^933 + 862356288*x^932 + 354500195*x^931 + 158151296*x^930 + 733475281*x^929 + 215008492*x^928 + 151139272*x^927 + 1000425669*x^926 + 590964357*x^925 + 373950911*x^924 + 43038800*x^923 + 338044906*x^922 + 293954870*x^921 + 393479*x^920 + 555095359*x^919 + 418829106*x^918 + 95391760*x^917 + 897658305*x^916 + 1040609125*x^915 + 239948276*x^914 + 1190720461*x^913 + 160498737*x^912 + 394967890*x^911 + 104302686*x^910 + 48021969*x^909 + 761000569*x^908 + 356140410*x^907 + 225246587*x^906 + 79172445*x^905 + 975365689*x^904 + 1077396491*x^903 + 728717352*x^902 + 964273647*x^901 + 258781036*x^900 + 746930481*x^899 + 793742220*x^898 + 542128050*x^897 + 562413014*x^896 + 701216258*x^895 + 928704966*x^894 + 98656502*x^893 + 1016152774*x^892 + 140544845*x^891 + 226416702*x^890 + 309310359*x^889 + 519065123*x^888 + 346740110*x^887 + 116615122*x^886 + 990804519*x^885 + 208648062*x^884 + 605381435*x^883 + 821163414*x^882 + 864698754*x^881 + 424773230*x^880 + 1184139330*x^879 + 437390254*x^878 + 41435781*x^877 + 824197241*x^876 + 1181823353*x^875 + 354135255*x^874 + 921600154*x^873 + 972782404*x^872 + 304175744*x^871 + 976950586*x^870 + 561195955*x^869 + 840601911*x^868 + 848362310*x^867 + 698380233*x^866 + 703722831*x^865 + 527081934*x^864 + 996708932*x^863 + 926257884*x^862 + 113808466*x^861 + 111022399*x^860 + 336240881*x^859 + 281602555*x^858 + 456022351*x^857 + 303940681*x^856 + 1152960332*x^855 + 762827305*x^854 + 1097893502*x^853 + 1159492861*x^852 + 791288185*x^851 + 552596428*x^850 + 1160303133*x^849 + 855459983*x^848 + 870046128*x^847 + 412042730*x^846 + 527317697*x^845 + 118258027*x^844 + 1156090191*x^843 + 1184418516*x^842 + 736914609*x^841 + 1042440949*x^840 + 1118336201*x^839 + 692314475*x^838 + 888141647*x^837 + 611975215*x^836 + 112482309*x^835 + 774541929*x^834 + 877613260*x^833 + 218484596*x^832 + 744043072*x^831 + 1149426359*x^830 + 1086732941*x^829 + 218727414*x^828 + 111004493*x^827 + 48035668*x^826 + 1129753198*x^825 + 410088959*x^824 + 1186919074*x^823 + 291266088*x^822 + 622780685*x^821 + 908030149*x^820 + 152548456*x^819 + 970996704*x^818 + 643233117*x^817 + 97648457*x^816 + 167039372*x^815 + 451159004*x^814 + 21522258*x^813 + 446568222*x^812 + 97236135*x^811 + 601480363*x^810 + 896523050*x^809 + 635312918*x^808 + 771155729*x^807 + 727217487*x^806 + 1103325662*x^805 + 1145702253*x^804 + 111451279*x^803 + 709647761*x^802 + 155865734*x^801 + 788861657*x^800 + 25328658*x^799 + 387592047*x^798 + 631380316*x^797 + 195654331*x^796 + 379901017*x^795 + 110746571*x^794 + 821639667*x^793 + 1196705497*x^792 + 926725497*x^791 + 752090468*x^790 + 565928514*x^789 + 107924077*x^788 + 1035444397*x^787 + 389590222*x^786 + 746022468*x^785 + 1152494936*x^784 + 1047183126*x^783 + 935173423*x^782 + 237022259*x^781 + 68211471*x^780 + 682392084*x^779 + 900610142*x^778 + 659697118*x^777 + 381789469*x^776 + 895479393*x^775 + 342674862*x^774 + 1034152415*x^773 + 736863278*x^772 + 233824501*x^771 + 511543257*x^770 + 43539547*x^769 + 871109943*x^768 + 234226499*x^767 + 958639125*x^766 + 913885377*x^765 + 757234386*x^764 + 330354514*x^763 + 693659124*x^762 + 46757147*x^761 + 24910108*x^760 + 263754046*x^759 + 1007999117*x^758 + 569158879*x^757 + 781185896*x^756 + 328234792*x^755 + 1166796778*x^754 + 1023882729*x^753 + 1126014838*x^752 + 412948341*x^751 + 745762031*x^750 + 184601330*x^749 + 1195686854*x^748 + 226180761*x^747 + 813440273*x^746 + 198496604*x^745 + 646284299*x^744 + 775658802*x^743 + 1051631440*x^742 + 382010443*x^741 + 884529292*x^740 + 1171509241*x^739 + 148470016*x^738 + 545551560*x^737 + 895321797*x^736 + 990533556*x^735 + 1006826878*x^734 + 444425261*x^733 + 538658289*x^732 + 1201448839*x^731 + 813543244*x^730 + 866138640*x^729 + 992484781*x^728 + 797592952*x^727 + 5350520*x^726 + 1088776239*x^725 + 1011384293*x^724 + 202279961*x^723 + 580990742*x^722 + 608736084*x^721 + 592191483*x^720 + 603821965*x^719 + 686032966*x^718 + 309449994*x^717 + 997796743*x^716 + 323694959*x^715 + 404631321*x^714 + 684041814*x^713 + 954922509*x^712 + 17334061*x^711 + 1038027065*x^710 + 189030167*x^709 + 238786122*x^708 + 854157242*x^707 + 857322405*x^706 + 847505723*x^705 + 531600098*x^704 + 413144959*x^703 + 150862275*x^702 + 176120020*x^701 + 147651128*x^700 + 20961937*x^699 + 924892688*x^698 + 207889399*x^697 + 506289209*x^696 + 201657090*x^695 + 866897606*x^694 + 282950189*x^693 + 484625027*x^692 + 720969770*x^691 + 557487808*x^690 + 664292309*x^689 + 667236796*x^688 + 505039446*x^687 + 636507041*x^686 + 717904854*x^685 + 742491214*x^684 + 235380401*x^683 + 885103138*x^682 + 227708439*x^681 + 195450351*x^680 + 914408549*x^679 + 890140153*x^678 + 959662247*x^677 + 655663410*x^676 + 682768547*x^675 + 1063757282*x^674 + 776284911*x^673 + 1114588219*x^672 + 689022198*x^671 + 1160585767*x^670 + 784564493*x^669 + 599804982*x^668 + 954265199*x^667 + 1160092910*x^666 + 1178991310*x^665 + 610146522*x^664 + 589028938*x^663 + 972903553*x^662 + 933544074*x^661 + 910101746*x^660 + 1199479046*x^659 + 129564572*x^658 + 16630574*x^657 + 604268174*x^656 + 905616984*x^655 + 229755095*x^654 + 543777663*x^653 + 880642044*x^652 + 750742780*x^651 + 801027824*x^650 + 59869899*x^649 + 178293151*x^648 + 413473523*x^647 + 790966353*x^646 + 36947608*x^645 + 215402931*x^644 + 198271237*x^643 + 394503398*x^642 + 933396244*x^641 + 764498758*x^640 + 960831635*x^639 + 710558646*x^638 + 160491214*x^637 + 161213508*x^636 + 932611994*x^635 + 226519192*x^634 + 554464756*x^633 + 82595536*x^632 + 1144714763*x^631 + 361090580*x^630 + 747809061*x^629 + 114293244*x^628 + 253349999*x^627 + 1051279816*x^626 + 1079507344*x^625 + 864605458*x^624 + 1100098300*x^623 + 323233106*x^622 + 1070769430*x^621 + 1048471132*x^620 + 23281664*x^619 + 1099148878*x^618 + 812556000*x^617 + 452606567*x^616 + 892217880*x^615 + 741556204*x^614 + 37168552*x^613 + 286980867*x^612 + 1125383508*x^611 + 782814488*x^610 + 1214851511*x^609 + 270577673*x^608 + 364433480*x^607 + 825553809*x^606 + 589475297*x^605 + 293114041*x^604 + 1115978872*x^603 + 21831218*x^602 + 856821602*x^601 + 213782489*x^600 + 287159884*x^599 + 1015101950*x^598 + 494211644*x^597 + 38143731*x^596 + 882805771*x^595 + 721674528*x^594 + 120092153*x^593 + 636819567*x^592 + 365557574*x^591 + 619653423*x^590 + 1207892829*x^589 + 971282528*x^588 + 379459809*x^587 + 507124241*x^586 + 1050378769*x^585 + 113715629*x^584 + 841835564*x^583 + 1055649818*x^582 + 904319486*x^581 + 83232231*x^580 + 282044435*x^579 + 11563226*x^578 + 283283452*x^577 + 515932154*x^576 + 415242679*x^575 + 686396058*x^574 + 414011723*x^573 + 22692318*x^572 + 593039855*x^571 + 42054428*x^570 + 242713788*x^569 + 756543053*x^568 + 297264974*x^567 + 656668981*x^566 + 103185189*x^565 + 279211827*x^564 + 66472175*x^563 + 221289056*x^562 + 418547255*x^561 + 587378319*x^560 + 781217899*x^559 + 828907515*x^558 + 1026785730*x^557 + 936576598*x^556 + 914519864*x^555 + 458326840*x^554 + 846364356*x^553 + 1048948157*x^552 + 276890468*x^551 + 211463242*x^550 + 611009955*x^549 + 41350370*x^548 + 1120260432*x^547 + 1217213406*x^546 + 1096884636*x^545 + 107298827*x^544 + 556646889*x^543 + 514714957*x^542 + 592531623*x^541 + 1185635127*x^540 + 866796164*x^539 + 1199009440*x^538 + 760543377*x^537 + 135043128*x^536 + 1184521976*x^535 + 53368352*x^534 + 614063947*x^533 + 117184488*x^532 + 1090625549*x^531 + 928160285*x^530 + 1065640157*x^529 + 307397590*x^528 + 383318068*x^527 + 890835908*x^526 + 416986540*x^525 + 222852700*x^524 + 965323537*x^523 + 151764017*x^522 + 193722745*x^521 + 439803983*x^520 + 942882901*x^519 + 56286764*x^518 + 824204572*x^517 + 478793274*x^516 + 183238303*x^515 + 922253103*x^514 + 5444136*x^513 + 402856270*x^512 + 508652113*x^511 + 898341402*x^510 + 56743140*x^509 + 179078829*x^508 + 360574641*x^507 + 691533190*x^506 + 982373838*x^505 + 719429684*x^504 + 962339948*x^503 + 1097706834*x^502 + 682588935*x^501 + 1193566532*x^500 + 1140505780*x^499 + 1167874911*x^498 + 669408623*x^497 + 15348570*x^496 + 896129486*x^495 + 100671957*x^494 + 1015786650*x^493 + 605094306*x^492 + 704959137*x^491 + 503877361*x^490 + 546763047*x^489 + 281625173*x^488 + 874599768*x^487 + 187483443*x^486 + 791213383*x^485 + 670376251*x^484 + 484751013*x^483 + 519454749*x^482 + 898655062*x^481 + 1088862155*x^480 + 843442957*x^479 + 429341712*x^478 + 869408179*x^477 + 921648096*x^476 + 526019939*x^475 + 856290375*x^474 + 531710459*x^473 + 1135323038*x^472 + 222776023*x^471 + 223826994*x^470 + 782612384*x^469 + 208579370*x^468 + 809908930*x^467 + 802818642*x^466 + 1182584545*x^465 + 245518705*x^464 + 114792460*x^463 + 646248449*x^462 + 63969962*x^461 + 761908644*x^460 + 523665668*x^459 + 1131060959*x^458 + 507746193*x^457 + 215968166*x^456 + 186113215*x^455 + 1117740378*x^454 + 649175082*x^453 + 396834257*x^452 + 274002774*x^451 + 626055138*x^450 + 924423066*x^449 + 81357715*x^448 + 1042994674*x^447 + 380053163*x^446 + 687766657*x^445 + 414805559*x^444 + 1118153385*x^443 + 1196507975*x^442 + 223759358*x^441 + 808836890*x^440 + 558230978*x^439 + 470920831*x^438 + 313868031*x^437 + 696317665*x^436 + 38725962*x^435 + 722983488*x^434 + 982704221*x^433 + 931470025*x^432 + 658261117*x^431 + 1043739465*x^430 + 422603501*x^429 + 879856656*x^428 + 977082068*x^427 + 593021461*x^426 + 955543544*x^425 + 194004912*x^424 + 1057355064*x^423 + 1153279801*x^422 + 1104874965*x^421 + 1157109085*x^420 + 54358054*x^419 + 802241073*x^418 + 489376522*x^417 + 250441773*x^416 + 740903923*x^415 + 81493461*x^414 + 966046559*x^413 + 295086523*x^412 + 1192114766*x^411 + 1186654005*x^410 + 768853461*x^409 + 302013033*x^408 + 1127093874*x^407 + 401944628*x^406 + 463364841*x^405 + 277324527*x^404 + 357826211*x^403 + 302642912*x^402 + 785232813*x^401 + 1155455395*x^400 + 240939622*x^399 + 1090741169*x^398 + 941697407*x^397 + 1108935255*x^396 + 63027943*x^395 + 415750779*x^394 + 36046273*x^393 + 172429619*x^392 + 563533800*x^391 + 961503349*x^390 + 356454474*x^389 + 586712431*x^388 + 572728001*x^387 + 670855384*x^386 + 268877633*x^385 + 51139525*x^384 + 806328542*x^383 + 790061093*x^382 + 140256246*x^381 + 430118720*x^380 + 924612224*x^379 + 923573107*x^378 + 1124645882*x^377 + 1044890409*x^376 + 509180566*x^375 + 371227114*x^374 + 161843486*x^373 + 296514161*x^372 + 454272518*x^371 + 755779732*x^370 + 295567281*x^369 + 1063635155*x^368 + 46603670*x^367 + 112353112*x^366 + 571920305*x^365 + 484055586*x^364 + 148075787*x^363 + 700140701*x^362 + 922814151*x^361 + 198283677*x^360 + 806078101*x^359 + 1218701262*x^358 + 679274064*x^357 + 408382456*x^356 + 284971608*x^355 + 1072737570*x^354 + 999420946*x^353 + 704897365*x^352 + 1147239838*x^351 + 1148707218*x^350 + 119677974*x^349 + 139766009*x^348 + 289899118*x^347 + 3099746*x^346 + 478334394*x^345 + 671867092*x^344 + 1123276962*x^343 + 1053910974*x^342 + 776016929*x^341 + 408840884*x^340 + 702734268*x^339 + 101137143*x^338 + 157330682*x^337 + 608473559*x^336 + 355406102*x^335 + 1189624142*x^334 + 87874850*x^333 + 1097033743*x^332 + 984835279*x^331 + 133446104*x^330 + 990221835*x^329 + 34152703*x^328 + 902602955*x^327 + 564227604*x^326 + 378045277*x^325 + 330935315*x^324 + 300442927*x^323 + 504016276*x^322 + 592727454*x^321 + 1075766200*x^320 + 718996149*x^319 + 823573424*x^318 + 834215705*x^317 + 430497892*x^316 + 879722938*x^315 + 968236501*x^314 + 262764692*x^313 + 37503817*x^312 + 607855810*x^311 + 1173289902*x^310 + 906609932*x^309 + 11948749*x^308 + 948969610*x^307 + 1130417155*x^306 + 892108695*x^305 + 1040897188*x^304 + 174698274*x^303 + 85414336*x^302 + 758730292*x^301 + 615781943*x^300 + 1215130735*x^299 + 1168693743*x^298 + 1070287857*x^297 + 501559848*x^296 + 485147924*x^295 + 1218893131*x^294 + 923876087*x^293 + 565056561*x^292 + 282754375*x^291 + 794028720*x^290 + 288419549*x^289 + 688387454*x^288 + 40339086*x^287 + 659115548*x^286 + 614342861*x^285 + 391568544*x^284 + 464738754*x^283 + 28669498*x^282 + 1115640335*x^281 + 870635325*x^280 + 126237247*x^279 + 1111165998*x^278 + 205027579*x^277 + 911218811*x^276 + 208748481*x^275 + 725176545*x^274 + 765151044*x^273 + 939495648*x^272 + 550038893*x^271 + 905707993*x^270 + 267107699*x^269 + 477779883*x^268 + 251985659*x^267 + 754082836*x^266 + 159569451*x^265 + 781616103*x^264 + 1098961576*x^263 + 1139687026*x^262 + 473401848*x^261 + 623689501*x^260 + 1012676202*x^259 + 76777202*x^258 + 170602576*x^257 + 266093330*x^256 + 732274753*x^255 + 193219366*x^254 + 610602682*x^253 + 749761392*x^252 + 536911921*x^251 + 1052883954*x^250 + 1139729422*x^249 + 617278363*x^248 + 603450863*x^247 + 877968049*x^246 + 1078543204*x^245 + 441578327*x^244 + 821469144*x^243 + 1083268726*x^242 + 592074734*x^241 + 431251183*x^240 + 1151073027*x^239 + 596034003*x^238 + 507176703*x^237 + 638155464*x^236 + 820097610*x^235 + 69713965*x^234 + 111089281*x^233 + 403306683*x^232 + 417322569*x^231 + 510992488*x^230 + 406068742*x^229 + 487323397*x^228 + 1105866147*x^227 + 126043214*x^226 + 565379393*x^225 + 774566507*x^224 + 94477834*x^223 + 301787901*x^222 + 891557978*x^221 + 246179873*x^220 + 76065360*x^219 + 632831219*x^218 + 967852970*x^217 + 982932236*x^216 + 457056482*x^215 + 611696056*x^214 + 187879254*x^213 + 919970751*x^212 + 726626422*x^211 + 744906999*x^210 + 514152204*x^209 + 400846913*x^208 + 1057213516*x^207 + 458393393*x^206 + 39867352*x^205 + 482474421*x^204 + 1017159775*x^203 + 1127386440*x^202 + 186890818*x^201 + 297371952*x^200 + 827010510*x^199 + 457757189*x^198 + 120047360*x^197 + 403406161*x^196 + 561776540*x^195 + 269984973*x^194 + 1105865523*x^193 + 356682370*x^192 + 521018201*x^191 + 714326305*x^190 + 230112489*x^189 + 468954949*x^188 + 428412182*x^187 + 418097923*x^186 + 648421330*x^185 + 119412602*x^184 + 1029175202*x^183 + 961854350*x^182 + 359274957*x^181 + 918516748*x^180 + 393392054*x^179 + 998769881*x^178 + 713880369*x^177 + 23918875*x^176 + 19140072*x^175 + 296443203*x^174 + 1036511543*x^173 + 208417465*x^172 + 856221174*x^171 + 724608949*x^170 + 1148614286*x^169 + 605394185*x^168 + 1037184954*x^167 + 1149508482*x^166 + 748219008*x^165 + 762595570*x^164 + 240812860*x^163 + 221590855*x^162 + 921277317*x^161 + 666749995*x^160 + 270085731*x^159 + 719780654*x^158 + 1023109552*x^157 + 948736441*x^156 + 942460534*x^155 + 1190076672*x^154 + 298412436*x^153 + 146236637*x^152 + 136974417*x^151 + 247369427*x^150 + 1164600849*x^149 + 80725190*x^148 + 563971590*x^147 + 838975230*x^146 + 605884308*x^145 + 695738052*x^144 + 457993644*x^143 + 608089160*x^142 + 279768415*x^141 + 167776427*x^140 + 99830319*x^139 + 724761513*x^138 + 838344856*x^137 + 349705095*x^136 + 700591961*x^135 + 495192008*x^134 + 166834844*x^133 + 829383641*x^132 + 689577635*x^131 + 1063098370*x^130 + 1217658142*x^129 + 210005674*x^128 + 709445493*x^127 + 890260692*x^126 + 11818873*x^125 + 356866298*x^124 + 657354178*x^123 + 1083325742*x^122 + 256937537*x^121 + 832141251*x^120 + 738779202*x^119 + 531375449*x^118 + 570407521*x^117 + 253499493*x^116 + 936295735*x^115 + 840539077*x^114 + 1108243632*x^113 + 518037787*x^112 + 512681158*x^111 + 659791034*x^110 + 615039004*x^109 + 6475754*x^108 + 112655504*x^107 + 135513268*x^106 + 814830817*x^105 + 312451349*x^104 + 459204360*x^103 + 536270797*x^102 + 487599107*x^101 + 995873996*x^100 + 947176358*x^99 + 161110841*x^98 + 1215850742*x^97 + 828031021*x^96 + 393857015*x^95 + 483165571*x^94 + 1169422374*x^93 + 185485308*x^92 + 1113820447*x^91 + 1217012548*x^90 + 591690262*x^89 + 230984245*x^88 + 1183186281*x^87 + 984746087*x^86 + 321334226*x^85 + 356396152*x^84 + 812358214*x^83 + 652862462*x^82 + 1159946831*x^81 + 1185692555*x^80 + 1101691161*x^79 + 1162783803*x^78 + 592033894*x^77 + 545367197*x^76 + 441688164*x^75 + 169491076*x^74 + 181297517*x^73 + 590332818*x^72 + 814337101*x^71 + 1148316386*x^70 + 700258144*x^69 + 719201877*x^68 + 1160695934*x^67 + 1186868159*x^66 + 508542038*x^65 + 1113702100*x^64 + 921032142*x^63 + 758636144*x^62 + 890540800*x^61 + 136808203*x^60 + 74886413*x^59 + 156077420*x^58 + 925473910*x^57 + 111404286*x^56 + 355116767*x^55 + 468038980*x^54 + 89708844*x^53 + 878616521*x^52 + 1154657871*x^51 + 677831135*x^50 + 903468800*x^49 + 890557208*x^48 + 1035114476*x^47 + 198189399*x^46 + 864375452*x^45 + 1164916963*x^44 + 929627324*x^43 + 418711325*x^42 + 97430691*x^41 + 1172413774*x^40 + 760600756*x^39 + 943281805*x^38 + 53033182*x^37 + 123566782*x^36 + 665472336*x^35 + 521103310*x^34 + 892876972*x^33 + 169828417*x^32 + 315862403*x^31 + 973295601*x^30 + 1036868940*x^29 + 469235131*x^28 + 1097609240*x^27 + 446027303*x^26 + 356219098*x^25 + 480790123*x^24 + 94742566*x^23 + 691728720*x^22 + 922852954*x^21 + 21648854*x^20 + 903452116*x^19 + 1043050543*x^18 + 867501915*x^17 + 402312961*x^16 + 772349320*x^15 + 806410607*x^14 + 573402289*x^13 + 103888540*x^12 + 147927873*x^11 + 1005161156*x^10 + 988774771*x^9 + 682875980*x^8 + 54946232*x^7 + 717143945*x^6 + 323577100*x^5 + 803064428*x^4 + 598462622*x^3 + 1110253556*x^2 + 764371182*x + 634648371</span><br><span class="line"># 735531500*x^1023 + 684755229*x^1022 + 978579144*x^1021 + 560225565*x^1020 + 758090578*x^1019 + 367477932*x^1018 + 326779415*x^1017 + 26800946*x^1016 + 199017905*x^1015 + 1156874439*x^1014 + 673969262*x^1013 + 617169647*x^1012 + 462256026*x^1011 + 303059784*x^1010 + 663728970*x^1009 + 376865711*x^1008 + 830705685*x^1007 + 573964358*x^1006 + 1210202059*x^1005 + 269197755*x^1004 + 586236496*x^1003 + 621987820*x^1002 + 485567868*x^1001 + 305700227*x^1000 + 1052698462*x^999 + 86861550*x^998 + 44767901*x^997 + 410897986*x^996 + 212344404*x^995 + 336381747*x^994 + 398182335*x^993 + 660275371*x^992 + 52728322*x^991 + 1193103469*x^990 + 684295535*x^989 + 1029981794*x^988 + 1051866415*x^987 + 418681909*x^986 + 976794520*x^985 + 1180496804*x^984 + 438513041*x^983 + 822843942*x^982 + 1119264881*x^981 + 790873853*x^980 + 1146506838*x^979 + 27016797*x^978 + 1149126201*x^977 + 967895459*x^976 + 1201841165*x^975 + 264216641*x^974 + 751855165*x^973 + 277480010*x^972 + 955969328*x^971 + 784721168*x^970 + 696371212*x^969 + 401164998*x^968 + 654719011*x^967 + 785183205*x^966 + 79070435*x^965 + 1140562925*x^964 + 1025154340*x^963 + 1044315421*x^962 + 392734282*x^961 + 234286141*x^960 + 962551866*x^959 + 133742245*x^958 + 998056106*x^957 + 781318236*x^956 + 23528574*x^955 + 1214036424*x^954 + 296666931*x^953 + 1211729921*x^952 + 561550286*x^951 + 634392845*x^950 + 422332555*x^949 + 765556851*x^948 + 1151849524*x^947 + 305981530*x^946 + 246290056*x^945 + 24304550*x^944 + 477073522*x^943 + 416104453*x^942 + 898162013*x^941 + 611609496*x^940 + 445765799*x^939 + 430180169*x^938 + 1151421310*x^937 + 439515367*x^936 + 795257572*x^935 + 578106992*x^934 + 929259980*x^933 + 550407102*x^932 + 1219047347*x^931 + 15972593*x^930 + 515513177*x^929 + 679675449*x^928 + 914537835*x^927 + 156230965*x^926 + 385558312*x^925 + 1036365654*x^924 + 1098274877*x^923 + 348628203*x^922 + 1093802915*x^921 + 1162728002*x^920 + 200502246*x^919 + 551049082*x^918 + 969116717*x^917 + 1127382445*x^916 + 968172543*x^915 + 346881523*x^914 + 41744706*x^913 + 335042561*x^912 + 593895276*x^911 + 15888292*x^910 + 324866127*x^909 + 937351605*x^908 + 347255852*x^907 + 1120419679*x^906 + 249832197*x^905 + 896923860*x^904 + 129801128*x^903 + 207849052*x^902 + 386825059*x^901 + 823406098*x^900 + 977635408*x^899 + 108813100*x^898 + 561865827*x^897 + 718000532*x^896 + 48090035*x^895 + 832337939*x^894 + 1084389292*x^893 + 793335438*x^892 + 1095245016*x^891 + 1080787282*x^890 + 122666287*x^889 + 937313249*x^888 + 62818846*x^887 + 1170462486*x^886 + 182439366*x^885 + 792906343*x^884 + 1205386767*x^883 + 310389549*x^882 + 603676058*x^881 + 671251954*x^880 + 640345010*x^879 + 1087374504*x^878 + 119769446*x^877 + 135989573*x^876 + 880703983*x^875 + 613578242*x^874 + 1207874966*x^873 + 972002390*x^872 + 644470053*x^871 + 335762119*x^870 + 1079917808*x^869 + 1023711373*x^868 + 861485470*x^867 + 230979333*x^866 + 683284149*x^865 + 645804102*x^864 + 577971621*x^863 + 33779989*x^862 + 915467237*x^861 + 834966216*x^860 + 445758874*x^859 + 685228217*x^858 + 979609284*x^857 + 842509205*x^856 + 221373358*x^855 + 150166201*x^854 + 927937340*x^853 + 995054125*x^852 + 704623324*x^851 + 1112892592*x^850 + 782816865*x^849 + 878518510*x^848 + 391872241*x^847 + 30062686*x^846 + 108900016*x^845 + 1034780269*x^844 + 1190084541*x^843 + 441686497*x^842 + 117953957*x^841 + 840802549*x^840 + 903238790*x^839 + 551715093*x^838 + 539420097*x^837 + 1007110444*x^836 + 673864283*x^835 + 756402005*x^834 + 197892310*x^833 + 981720851*x^832 + 798897509*x^831 + 1127242378*x^830 + 666754217*x^829 + 685248618*x^828 + 327773092*x^827 + 390697118*x^826 + 912223373*x^825 + 482947333*x^824 + 1110169857*x^823 + 780612147*x^822 + 194698743*x^821 + 716386043*x^820 + 424946693*x^819 + 22701975*x^818 + 293011366*x^817 + 947695756*x^816 + 1188483932*x^815 + 1002073886*x^814 + 1078210750*x^813 + 1127684166*x^812 + 719332394*x^811 + 1072532713*x^810 + 550629553*x^809 + 188195613*x^808 + 614412704*x^807 + 649960359*x^806 + 1010011298*x^805 + 824975518*x^804 + 311757403*x^803 + 93674481*x^802 + 380323800*x^801 + 1086623904*x^800 + 240170088*x^799 + 956396081*x^798 + 939969890*x^797 + 131843464*x^796 + 1045744996*x^795 + 424359277*x^794 + 550616456*x^793 + 1061637035*x^792 + 444548551*x^791 + 677546521*x^790 + 149605032*x^789 + 829567560*x^788 + 516053142*x^787 + 1191529914*x^786 + 294270928*x^785 + 142024389*x^784 + 584911191*x^783 + 307856659*x^782 + 81514660*x^781 + 543784156*x^780 + 108008163*x^779 + 13154295*x^778 + 155266054*x^777 + 663702892*x^776 + 782494602*x^775 + 747547833*x^774 + 242456376*x^773 + 669844220*x^772 + 552894098*x^771 + 1036366706*x^770 + 1074841665*x^769 + 720745418*x^768 + 1137936670*x^767 + 840875363*x^766 + 476498840*x^765 + 1088669461*x^764 + 1249649*x^763 + 882277578*x^762 + 37842126*x^761 + 398977801*x^760 + 328296234*x^759 + 536342859*x^758 + 608139240*x^757 + 897424944*x^756 + 76562916*x^755 + 428081420*x^754 + 627420927*x^753 + 265131678*x^752 + 1034443577*x^751 + 177902661*x^750 + 490977141*x^749 + 1084536775*x^748 + 1189221123*x^747 + 854191429*x^746 + 952038058*x^745 + 891288300*x^744 + 929356576*x^743 + 223874272*x^742 + 220297702*x^741 + 1099283305*x^740 + 1008574448*x^739 + 619949004*x^738 + 747199791*x^737 + 760703880*x^736 + 7682727*x^735 + 88566484*x^734 + 733742620*x^733 + 381443925*x^732 + 799269923*x^731 + 233342676*x^730 + 1205696983*x^729 + 765306727*x^728 + 29342855*x^727 + 287728251*x^726 + 214358216*x^725 + 355991367*x^724 + 344973841*x^723 + 436344093*x^722 + 547944829*x^721 + 1041405031*x^720 + 368771692*x^719 + 37426577*x^718 + 502936636*x^717 + 732825913*x^716 + 518778589*x^715 + 561797784*x^714 + 773068766*x^713 + 75615306*x^712 + 668933267*x^711 + 628975723*x^710 + 1140697439*x^709 + 108807342*x^708 + 283945737*x^707 + 701674528*x^706 + 1120373548*x^705 + 421627231*x^704 + 260846853*x^703 + 292537012*x^702 + 583513440*x^701 + 609720259*x^700 + 831373721*x^699 + 1126099385*x^698 + 431095431*x^697 + 296863241*x^696 + 371013827*x^695 + 549980853*x^694 + 550174635*x^693 + 620963563*x^692 + 952040422*x^691 + 1150044500*x^690 + 893175261*x^689 + 1139857784*x^688 + 972717568*x^687 + 735672517*x^686 + 1177501026*x^685 + 765934764*x^684 + 710762091*x^683 + 871268519*x^682 + 969318271*x^681 + 286261161*x^680 + 65128931*x^679 + 1100922672*x^678 + 47619662*x^677 + 981578224*x^676 + 67232154*x^675 + 1928142*x^674 + 817643007*x^673 + 675713298*x^672 + 185236805*x^671 + 331446457*x^670 + 129023118*x^669 + 431426370*x^668 + 1154277684*x^667 + 723182950*x^666 + 1144823093*x^665 + 822001162*x^664 + 356099532*x^663 + 705989193*x^662 + 878712048*x^661 + 1095044481*x^660 + 332193401*x^659 + 613329359*x^658 + 673744151*x^657 + 808080280*x^656 + 225562949*x^655 + 185686220*x^654 + 742469973*x^653 + 986152315*x^652 + 13611550*x^651 + 535747170*x^650 + 233786507*x^649 + 27955348*x^648 + 1004446959*x^647 + 1071164149*x^646 + 265258708*x^645 + 63221383*x^644 + 682228580*x^643 + 867131152*x^642 + 997600620*x^641 + 993922001*x^640 + 693252545*x^639 + 865655581*x^638 + 518295141*x^637 + 902072633*x^636 + 704953646*x^635 + 587251157*x^634 + 99168972*x^633 + 1105480730*x^632 + 1040404159*x^631 + 436113220*x^630 + 152714904*x^629 + 697469981*x^628 + 1185372838*x^627 + 216027999*x^626 + 616083931*x^625 + 399419685*x^624 + 23193568*x^623 + 1174129641*x^622 + 75724376*x^621 + 570399858*x^620 + 754947446*x^619 + 1037864447*x^618 + 794730343*x^617 + 60369472*x^616 + 750769016*x^615 + 61444481*x^614 + 333194445*x^613 + 1109236037*x^612 + 513379869*x^611 + 706807998*x^610 + 999669914*x^609 + 1198194959*x^608 + 336044172*x^607 + 402719207*x^606 + 1050007981*x^605 + 429464593*x^604 + 679293134*x^603 + 734513317*x^602 + 838385265*x^601 + 990800608*x^600 + 1162093896*x^599 + 173467508*x^598 + 123947890*x^597 + 325712596*x^596 + 1049522320*x^595 + 1072653958*x^594 + 565759817*x^593 + 549918485*x^592 + 574268523*x^591 + 1052593520*x^590 + 474323970*x^589 + 262787725*x^588 + 1091470590*x^587 + 782664905*x^586 + 1201833996*x^585 + 808712564*x^584 + 619522329*x^583 + 233329446*x^582 + 730502283*x^581 + 1017501853*x^580 + 306080194*x^579 + 283641594*x^578 + 195324593*x^577 + 1116741123*x^576 + 289439631*x^575 + 206064600*x^574 + 280021778*x^573 + 425409216*x^572 + 1107952582*x^571 + 131800177*x^570 + 106903346*x^569 + 72306234*x^568 + 934072451*x^567 + 242740893*x^566 + 106611451*x^565 + 429378634*x^564 + 127624569*x^563 + 587315789*x^562 + 932709753*x^561 + 523886142*x^560 + 110330665*x^559 + 963244036*x^558 + 227339325*x^557 + 185882207*x^556 + 987833442*x^555 + 981380006*x^554 + 1140813804*x^553 + 538704418*x^552 + 842520362*x^551 + 597627400*x^550 + 165232274*x^549 + 900076209*x^548 + 311342603*x^547 + 477271753*x^546 + 1072907066*x^545 + 1066126181*x^544 + 791702251*x^543 + 623246063*x^542 + 1082681410*x^541 + 759396967*x^540 + 878108937*x^539 + 724607060*x^538 + 79223685*x^537 + 307312027*x^536 + 234246571*x^535 + 330319932*x^534 + 274254378*x^533 + 1082820468*x^532 + 68920838*x^531 + 1195376541*x^530 + 170971307*x^529 + 399525324*x^528 + 238798853*x^527 + 664426862*x^526 + 269949285*x^525 + 698202786*x^524 + 88964561*x^523 + 635539315*x^522 + 1016514687*x^521 + 122364467*x^520 + 1095096646*x^519 + 513834099*x^518 + 672478524*x^517 + 47526709*x^516 + 48782616*x^515 + 166225959*x^514 + 810099682*x^513 + 168540411*x^512 + 30055377*x^511 + 817325819*x^510 + 202717189*x^509 + 739906349*x^508 + 186072589*x^507 + 451966755*x^506 + 684027658*x^505 + 251331059*x^504 + 591972494*x^503 + 289197098*x^502 + 829928406*x^501 + 160528626*x^500 + 90951219*x^499 + 496118642*x^498 + 117818178*x^497 + 215417436*x^496 + 937904122*x^495 + 962080493*x^494 + 423647737*x^493 + 1094089608*x^492 + 97559711*x^491 + 412409151*x^490 + 1039695658*x^489 + 461079746*x^488 + 564664118*x^487 + 2231630*x^486 + 667569567*x^485 + 471400483*x^484 + 691739455*x^483 + 146641223*x^482 + 445509678*x^481 + 788647561*x^480 + 100316571*x^479 + 927803124*x^478 + 225739054*x^477 + 339283562*x^476 + 741552554*x^475 + 674303545*x^474 + 610706793*x^473 + 1045437706*x^472 + 758427998*x^471 + 518677374*x^470 + 1020530386*x^469 + 81672436*x^468 + 684553666*x^467 + 36416557*x^466 + 1083076029*x^465 + 63903696*x^464 + 655765095*x^463 + 464055997*x^462 + 874368360*x^461 + 909538282*x^460 + 1084815716*x^459 + 971305398*x^458 + 504958756*x^457 + 941782746*x^456 + 410981017*x^455 + 44463213*x^454 + 57796260*x^453 + 633624768*x^452 + 902476625*x^451 + 1190884714*x^450 + 30960289*x^449 + 698111360*x^448 + 507015564*x^447 + 595305556*x^446 + 1170147546*x^445 + 595449153*x^444 + 1132050715*x^443 + 566093951*x^442 + 1125890381*x^441 + 864044563*x^440 + 608408253*x^439 + 128031905*x^438 + 951152598*x^437 + 41054884*x^436 + 1012755213*x^435 + 1091670374*x^434 + 481898210*x^433 + 1007980179*x^432 + 43301236*x^431 + 6478999*x^430 + 1175215424*x^429 + 597862715*x^428 + 441537430*x^427 + 339705054*x^426 + 289227345*x^425 + 795113772*x^424 + 404870950*x^423 + 997272819*x^422 + 634256255*x^421 + 453060086*x^420 + 821493547*x^419 + 842289852*x^418 + 223251279*x^417 + 929721613*x^416 + 63980045*x^415 + 298369623*x^414 + 1026287144*x^413 + 979092254*x^412 + 1182904024*x^411 + 298048453*x^410 + 653297794*x^409 + 365769179*x^408 + 45373617*x^407 + 7228243*x^406 + 1086374067*x^405 + 389455721*x^404 + 992518297*x^403 + 433929335*x^402 + 1149626197*x^401 + 90006250*x^400 + 1011632630*x^399 + 940906615*x^398 + 564772117*x^397 + 692974220*x^396 + 561321375*x^395 + 1095715303*x^394 + 1006114558*x^393 + 95516055*x^392 + 640816811*x^391 + 869737844*x^390 + 248741996*x^389 + 101754352*x^388 + 253268107*x^387 + 593472036*x^386 + 627778298*x^385 + 801877646*x^384 + 286581226*x^383 + 645931883*x^382 + 373119745*x^381 + 461109006*x^380 + 594214135*x^379 + 751634451*x^378 + 706229440*x^377 + 247985412*x^376 + 993987710*x^375 + 618989435*x^374 + 600506682*x^373 + 179955505*x^372 + 956234357*x^371 + 1049030902*x^370 + 727597507*x^369 + 1196607714*x^368 + 610634244*x^367 + 619865634*x^366 + 849131167*x^365 + 1094185730*x^364 + 685353152*x^363 + 299082549*x^362 + 1076769237*x^361 + 792938001*x^360 + 885082721*x^359 + 1198739364*x^358 + 273154602*x^357 + 597517874*x^356 + 351418158*x^355 + 621945565*x^354 + 949756104*x^353 + 1020290901*x^352 + 315372660*x^351 + 291246927*x^350 + 1016861207*x^349 + 171467993*x^348 + 1074074496*x^347 + 660775696*x^346 + 562891589*x^345 + 258618000*x^344 + 521058831*x^343 + 152819838*x^342 + 1141330990*x^341 + 383408903*x^340 + 677850803*x^339 + 165908062*x^338 + 66975904*x^337 + 510786934*x^336 + 32306220*x^335 + 708115806*x^334 + 474352780*x^333 + 963188335*x^332 + 151844162*x^331 + 907339624*x^330 + 456166118*x^329 + 111742252*x^328 + 318018829*x^327 + 624012970*x^326 + 255354390*x^325 + 1218329311*x^324 + 375000855*x^323 + 54956044*x^322 + 13543809*x^321 + 671163260*x^320 + 226676913*x^319 + 1193470867*x^318 + 477161216*x^317 + 519506783*x^316 + 748987057*x^315 + 768531367*x^314 + 327816599*x^313 + 59056092*x^312 + 520958252*x^311 + 243337260*x^310 + 608632530*x^309 + 65258636*x^308 + 1012579720*x^307 + 400176357*x^306 + 104583966*x^305 + 1114827176*x^304 + 70705682*x^303 + 5320656*x^302 + 1207465008*x^301 + 1211372826*x^300 + 886104873*x^299 + 747144635*x^298 + 227753814*x^297 + 427912588*x^296 + 425232985*x^295 + 135219277*x^294 + 541439233*x^293 + 82586191*x^292 + 1024575564*x^291 + 408418547*x^290 + 1076407665*x^289 + 184646604*x^288 + 894569780*x^287 + 730742386*x^286 + 473643018*x^285 + 561906151*x^284 + 582231889*x^283 + 928617667*x^282 + 460594931*x^281 + 946340582*x^280 + 881007408*x^279 + 655553538*x^278 + 107738502*x^277 + 958107338*x^276 + 874269820*x^275 + 689734430*x^274 + 1025286771*x^273 + 809509338*x^272 + 126580761*x^271 + 425724981*x^270 + 91398446*x^269 + 915486182*x^268 + 750598785*x^267 + 331692120*x^266 + 266239686*x^265 + 41813860*x^264 + 1003196915*x^263 + 1006275694*x^262 + 958171508*x^261 + 387655573*x^260 + 529686749*x^259 + 2533683*x^258 + 851532040*x^257 + 515865631*x^256 + 331149910*x^255 + 1058283457*x^254 + 478391568*x^253 + 1020601120*x^252 + 193954604*x^251 + 125558467*x^250 + 916367669*x^249 + 965664721*x^248 + 737411958*x^247 + 145954639*x^246 + 787702411*x^245 + 256023548*x^244 + 831752864*x^243 + 637799028*x^242 + 202325459*x^241 + 189858829*x^240 + 221236168*x^239 + 276967229*x^238 + 732958371*x^237 + 31622618*x^236 + 558911372*x^235 + 257580689*x^234 + 490167674*x^233 + 1164269554*x^232 + 765931664*x^231 + 89716985*x^230 + 639008878*x^229 + 716033538*x^228 + 186948569*x^227 + 870251868*x^226 + 383121640*x^225 + 604362204*x^224 + 405526662*x^223 + 127371887*x^222 + 543669202*x^221 + 823112915*x^220 + 523517382*x^219 + 791437322*x^218 + 1069279817*x^217 + 960628355*x^216 + 1012582276*x^215 + 1200088601*x^214 + 927011022*x^213 + 830570829*x^212 + 700668365*x^211 + 1205573850*x^210 + 276778781*x^209 + 786305215*x^208 + 928215922*x^207 + 154393796*x^206 + 169298902*x^205 + 177646296*x^204 + 173339370*x^203 + 287217637*x^202 + 1077403939*x^201 + 1004965535*x^200 + 677352462*x^199 + 545192340*x^198 + 464170452*x^197 + 381853900*x^196 + 205643848*x^195 + 973330672*x^194 + 1148733662*x^193 + 458436519*x^192 + 68604889*x^191 + 193530886*x^190 + 141661386*x^189 + 1117183144*x^188 + 153035244*x^187 + 830892599*x^186 + 795500906*x^185 + 67041425*x^184 + 617209634*x^183 + 180547177*x^182 + 1183445159*x^181 + 303603618*x^180 + 842724764*x^179 + 784982658*x^178 + 1199356684*x^177 + 321497016*x^176 + 513738925*x^175 + 465949450*x^174 + 981246204*x^173 + 814398377*x^172 + 950247970*x^171 + 720838080*x^170 + 399493165*x^169 + 735365971*x^168 + 109745845*x^167 + 897998838*x^166 + 547497972*x^165 + 174675208*x^164 + 716115074*x^163 + 237209800*x^162 + 186394653*x^161 + 876995839*x^160 + 1187252196*x^159 + 819282320*x^158 + 44596523*x^157 + 679033559*x^156 + 736746236*x^155 + 1184916922*x^154 + 451294643*x^153 + 443590366*x^152 + 304384335*x^151 + 1064695584*x^150 + 602535518*x^149 + 684486124*x^148 + 863476315*x^147 + 496170722*x^146 + 737062216*x^145 + 285799611*x^144 + 1085153158*x^143 + 247783563*x^142 + 1208043659*x^141 + 208776666*x^140 + 117730360*x^139 + 279620264*x^138 + 273045622*x^137 + 893971194*x^136 + 240743423*x^135 + 1143029271*x^134 + 326725356*x^133 + 294174585*x^132 + 672819095*x^131 + 138843366*x^130 + 1176670148*x^129 + 573825049*x^128 + 835249905*x^127 + 778468469*x^126 + 300257393*x^125 + 409352854*x^124 + 953527813*x^123 + 653640743*x^122 + 1210615840*x^121 + 596684403*x^120 + 46012813*x^119 + 510765516*x^118 + 1213476223*x^117 + 1132779740*x^116 + 769195645*x^115 + 963749389*x^114 + 843804183*x^113 + 109759209*x^112 + 493130294*x^111 + 1122857844*x^110 + 1130618881*x^109 + 648465049*x^108 + 364595574*x^107 + 410134064*x^106 + 597836905*x^105 + 831243271*x^104 + 226275998*x^103 + 686704033*x^102 + 662011231*x^101 + 112226051*x^100 + 623946037*x^99 + 469742204*x^98 + 369854172*x^97 + 731154062*x^96 + 352916654*x^95 + 45991298*x^94 + 614913911*x^93 + 632337602*x^92 + 327529986*x^91 + 111251878*x^90 + 657089210*x^89 + 499853920*x^88 + 966818975*x^87 + 454584975*x^86 + 116582431*x^85 + 619242494*x^84 + 455382561*x^83 + 246350547*x^82 + 495191129*x^81 + 900852972*x^80 + 264825752*x^79 + 426813960*x^78 + 478124215*x^77 + 1080567657*x^76 + 858353771*x^75 + 215115660*x^74 + 963682245*x^73 + 964445096*x^72 + 73603206*x^71 + 734630202*x^70 + 199652522*x^69 + 520021635*x^68 + 763256200*x^67 + 861482624*x^66 + 890485659*x^65 + 523362913*x^64 + 785087110*x^63 + 381314881*x^62 + 843850504*x^61 + 61951613*x^60 + 119100925*x^59 + 531827488*x^58 + 199818669*x^57 + 592207491*x^56 + 354682041*x^55 + 1015447358*x^54 + 328324806*x^53 + 24880841*x^52 + 516663598*x^51 + 716706066*x^50 + 1042483154*x^49 + 331433641*x^48 + 929901382*x^47 + 502140671*x^46 + 48123362*x^45 + 1112586174*x^44 + 14618102*x^43 + 764832169*x^42 + 446768463*x^41 + 920421919*x^40 + 491851586*x^39 + 24718814*x^38 + 83091454*x^37 + 155770396*x^36 + 12824441*x^35 + 954371888*x^34 + 318592841*x^33 + 788251579*x^32 + 246435934*x^31 + 387083299*x^30 + 395226231*x^29 + 646811732*x^28 + 1131418388*x^27 + 1135116504*x^26 + 986902782*x^25 + 323457413*x^24 + 521885110*x^23 + 234655676*x^22 + 965166497*x^21 + 755967054*x^20 + 574743395*x^19 + 1175664410*x^18 + 117322371*x^17 + 794664856*x^16 + 570463*x^15 + 1148572518*x^14 + 439320220*x^13 + 815953366*x^12 + 389050726*x^11 + 1167287391*x^10 + 397052468*x^9 + 275572458*x^8 + 548665509*x^7 + 1202175986*x^6 + 518662014*x^5 + 1084425257*x^4 + 7854568*x^3 + 274607457*x^2 + 162444786*x + 410560230</span><br></pre></td></tr></table></figure>
<p>一个RLWE问题，环为$x^{1024}-1$，计算</p>
<script type="math/tex; mode=display">
b=as+e</script><p>给出了$a,b$</p>
<p>若是用正常的RLWE解法，格的大小将来到$2*1024+1$，这是难以接受的，但考虑flag的长度小于64，可采用分块矩阵的解法来降维</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">q = 1219077173</span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(q), &#x27;x&#x27;)</span><br><span class="line">N = 1024</span><br><span class="line"></span><br><span class="line">f = x^N - 1</span><br><span class="line">a= 216047404*x^1023 + 1008199117*x^1022 + 39562072*x^1021 + 189992355*x^1020 + 1087671639*x^1019 + 541371337*x^1018 + 1146044200*x^1017 + 212969175*x^1016 + 1114159572*x^1015 + 1112032860*x^1014 + 1204883609*x^1013 + 1181544913*x^1012 + 851496082*x^1011 + 222877006*x^1010 + 163176236*x^1009 + 268697504*x^1008 + 613151090*x^1007 + 1185245256*x^1006 + 215725010*x^1005 + 789898500*x^1004 + 1156619111*x^1003 + 610859911*x^1002 + 959814483*x^1001 + 684353251*x^1000 + 290850651*x^999 + 675880502*x^998 + 836239751*x^997 + 487296407*x^996 + 778816128*x^995 + 1013639221*x^994 + 189137575*x^993 + 172217836*x^992 + 572872008*x^991 + 865759581*x^990 + 399805736*x^989 + 394587004*x^988 + 633085719*x^987 + 15142893*x^986 + 461176831*x^985 + 1078060208*x^984 + 787396508*x^983 + 877420202*x^982 + 1121486845*x^981 + 146921816*x^980 + 670134387*x^979 + 574407635*x^978 + 1148395437*x^977 + 748514947*x^976 + 970442995*x^975 + 280085063*x^974 + 420670822*x^973 + 20159574*x^972 + 219680665*x^971 + 401202858*x^970 + 328444623*x^969 + 623312316*x^968 + 917712264*x^967 + 588061576*x^966 + 625482841*x^965 + 220929234*x^964 + 778461001*x^963 + 498203565*x^962 + 1055981771*x^961 + 70562147*x^960 + 931081750*x^959 + 93569863*x^958 + 314876311*x^957 + 932364613*x^956 + 1132016772*x^955 + 371703330*x^954 + 189301560*x^953 + 739232608*x^952 + 916695967*x^951 + 399818344*x^950 + 558604923*x^949 + 1092603913*x^948 + 987195616*x^947 + 665679589*x^946 + 1142632478*x^945 + 198797278*x^944 + 110832477*x^943 + 775688737*x^942 + 275416086*x^941 + 435656120*x^940 + 754150483*x^939 + 1024583186*x^938 + 972075461*x^937 + 1071060217*x^936 + 710789980*x^935 + 691361770*x^934 + 1097024307*x^933 + 862356288*x^932 + 354500195*x^931 + 158151296*x^930 + 733475281*x^929 + 215008492*x^928 + 151139272*x^927 + 1000425669*x^926 + 590964357*x^925 + 373950911*x^924 + 43038800*x^923 + 338044906*x^922 + 293954870*x^921 + 393479*x^920 + 555095359*x^919 + 418829106*x^918 + 95391760*x^917 + 897658305*x^916 + 1040609125*x^915 + 239948276*x^914 + 1190720461*x^913 + 160498737*x^912 + 394967890*x^911 + 104302686*x^910 + 48021969*x^909 + 761000569*x^908 + 356140410*x^907 + 225246587*x^906 + 79172445*x^905 + 975365689*x^904 + 1077396491*x^903 + 728717352*x^902 + 964273647*x^901 + 258781036*x^900 + 746930481*x^899 + 793742220*x^898 + 542128050*x^897 + 562413014*x^896 + 701216258*x^895 + 928704966*x^894 + 98656502*x^893 + 1016152774*x^892 + 140544845*x^891 + 226416702*x^890 + 309310359*x^889 + 519065123*x^888 + 346740110*x^887 + 116615122*x^886 + 990804519*x^885 + 208648062*x^884 + 605381435*x^883 + 821163414*x^882 + 864698754*x^881 + 424773230*x^880 + 1184139330*x^879 + 437390254*x^878 + 41435781*x^877 + 824197241*x^876 + 1181823353*x^875 + 354135255*x^874 + 921600154*x^873 + 972782404*x^872 + 304175744*x^871 + 976950586*x^870 + 561195955*x^869 + 840601911*x^868 + 848362310*x^867 + 698380233*x^866 + 703722831*x^865 + 527081934*x^864 + 996708932*x^863 + 926257884*x^862 + 113808466*x^861 + 111022399*x^860 + 336240881*x^859 + 281602555*x^858 + 456022351*x^857 + 303940681*x^856 + 1152960332*x^855 + 762827305*x^854 + 1097893502*x^853 + 1159492861*x^852 + 791288185*x^851 + 552596428*x^850 + 1160303133*x^849 + 855459983*x^848 + 870046128*x^847 + 412042730*x^846 + 527317697*x^845 + 118258027*x^844 + 1156090191*x^843 + 1184418516*x^842 + 736914609*x^841 + 1042440949*x^840 + 1118336201*x^839 + 692314475*x^838 + 888141647*x^837 + 611975215*x^836 + 112482309*x^835 + 774541929*x^834 + 877613260*x^833 + 218484596*x^832 + 744043072*x^831 + 1149426359*x^830 + 1086732941*x^829 + 218727414*x^828 + 111004493*x^827 + 48035668*x^826 + 1129753198*x^825 + 410088959*x^824 + 1186919074*x^823 + 291266088*x^822 + 622780685*x^821 + 908030149*x^820 + 152548456*x^819 + 970996704*x^818 + 643233117*x^817 + 97648457*x^816 + 167039372*x^815 + 451159004*x^814 + 21522258*x^813 + 446568222*x^812 + 97236135*x^811 + 601480363*x^810 + 896523050*x^809 + 635312918*x^808 + 771155729*x^807 + 727217487*x^806 + 1103325662*x^805 + 1145702253*x^804 + 111451279*x^803 + 709647761*x^802 + 155865734*x^801 + 788861657*x^800 + 25328658*x^799 + 387592047*x^798 + 631380316*x^797 + 195654331*x^796 + 379901017*x^795 + 110746571*x^794 + 821639667*x^793 + 1196705497*x^792 + 926725497*x^791 + 752090468*x^790 + 565928514*x^789 + 107924077*x^788 + 1035444397*x^787 + 389590222*x^786 + 746022468*x^785 + 1152494936*x^784 + 1047183126*x^783 + 935173423*x^782 + 237022259*x^781 + 68211471*x^780 + 682392084*x^779 + 900610142*x^778 + 659697118*x^777 + 381789469*x^776 + 895479393*x^775 + 342674862*x^774 + 1034152415*x^773 + 736863278*x^772 + 233824501*x^771 + 511543257*x^770 + 43539547*x^769 + 871109943*x^768 + 234226499*x^767 + 958639125*x^766 + 913885377*x^765 + 757234386*x^764 + 330354514*x^763 + 693659124*x^762 + 46757147*x^761 + 24910108*x^760 + 263754046*x^759 + 1007999117*x^758 + 569158879*x^757 + 781185896*x^756 + 328234792*x^755 + 1166796778*x^754 + 1023882729*x^753 + 1126014838*x^752 + 412948341*x^751 + 745762031*x^750 + 184601330*x^749 + 1195686854*x^748 + 226180761*x^747 + 813440273*x^746 + 198496604*x^745 + 646284299*x^744 + 775658802*x^743 + 1051631440*x^742 + 382010443*x^741 + 884529292*x^740 + 1171509241*x^739 + 148470016*x^738 + 545551560*x^737 + 895321797*x^736 + 990533556*x^735 + 1006826878*x^734 + 444425261*x^733 + 538658289*x^732 + 1201448839*x^731 + 813543244*x^730 + 866138640*x^729 + 992484781*x^728 + 797592952*x^727 + 5350520*x^726 + 1088776239*x^725 + 1011384293*x^724 + 202279961*x^723 + 580990742*x^722 + 608736084*x^721 + 592191483*x^720 + 603821965*x^719 + 686032966*x^718 + 309449994*x^717 + 997796743*x^716 + 323694959*x^715 + 404631321*x^714 + 684041814*x^713 + 954922509*x^712 + 17334061*x^711 + 1038027065*x^710 + 189030167*x^709 + 238786122*x^708 + 854157242*x^707 + 857322405*x^706 + 847505723*x^705 + 531600098*x^704 + 413144959*x^703 + 150862275*x^702 + 176120020*x^701 + 147651128*x^700 + 20961937*x^699 + 924892688*x^698 + 207889399*x^697 + 506289209*x^696 + 201657090*x^695 + 866897606*x^694 + 282950189*x^693 + 484625027*x^692 + 720969770*x^691 + 557487808*x^690 + 664292309*x^689 + 667236796*x^688 + 505039446*x^687 + 636507041*x^686 + 717904854*x^685 + 742491214*x^684 + 235380401*x^683 + 885103138*x^682 + 227708439*x^681 + 195450351*x^680 + 914408549*x^679 + 890140153*x^678 + 959662247*x^677 + 655663410*x^676 + 682768547*x^675 + 1063757282*x^674 + 776284911*x^673 + 1114588219*x^672 + 689022198*x^671 + 1160585767*x^670 + 784564493*x^669 + 599804982*x^668 + 954265199*x^667 + 1160092910*x^666 + 1178991310*x^665 + 610146522*x^664 + 589028938*x^663 + 972903553*x^662 + 933544074*x^661 + 910101746*x^660 + 1199479046*x^659 + 129564572*x^658 + 16630574*x^657 + 604268174*x^656 + 905616984*x^655 + 229755095*x^654 + 543777663*x^653 + 880642044*x^652 + 750742780*x^651 + 801027824*x^650 + 59869899*x^649 + 178293151*x^648 + 413473523*x^647 + 790966353*x^646 + 36947608*x^645 + 215402931*x^644 + 198271237*x^643 + 394503398*x^642 + 933396244*x^641 + 764498758*x^640 + 960831635*x^639 + 710558646*x^638 + 160491214*x^637 + 161213508*x^636 + 932611994*x^635 + 226519192*x^634 + 554464756*x^633 + 82595536*x^632 + 1144714763*x^631 + 361090580*x^630 + 747809061*x^629 + 114293244*x^628 + 253349999*x^627 + 1051279816*x^626 + 1079507344*x^625 + 864605458*x^624 + 1100098300*x^623 + 323233106*x^622 + 1070769430*x^621 + 1048471132*x^620 + 23281664*x^619 + 1099148878*x^618 + 812556000*x^617 + 452606567*x^616 + 892217880*x^615 + 741556204*x^614 + 37168552*x^613 + 286980867*x^612 + 1125383508*x^611 + 782814488*x^610 + 1214851511*x^609 + 270577673*x^608 + 364433480*x^607 + 825553809*x^606 + 589475297*x^605 + 293114041*x^604 + 1115978872*x^603 + 21831218*x^602 + 856821602*x^601 + 213782489*x^600 + 287159884*x^599 + 1015101950*x^598 + 494211644*x^597 + 38143731*x^596 + 882805771*x^595 + 721674528*x^594 + 120092153*x^593 + 636819567*x^592 + 365557574*x^591 + 619653423*x^590 + 1207892829*x^589 + 971282528*x^588 + 379459809*x^587 + 507124241*x^586 + 1050378769*x^585 + 113715629*x^584 + 841835564*x^583 + 1055649818*x^582 + 904319486*x^581 + 83232231*x^580 + 282044435*x^579 + 11563226*x^578 + 283283452*x^577 + 515932154*x^576 + 415242679*x^575 + 686396058*x^574 + 414011723*x^573 + 22692318*x^572 + 593039855*x^571 + 42054428*x^570 + 242713788*x^569 + 756543053*x^568 + 297264974*x^567 + 656668981*x^566 + 103185189*x^565 + 279211827*x^564 + 66472175*x^563 + 221289056*x^562 + 418547255*x^561 + 587378319*x^560 + 781217899*x^559 + 828907515*x^558 + 1026785730*x^557 + 936576598*x^556 + 914519864*x^555 + 458326840*x^554 + 846364356*x^553 + 1048948157*x^552 + 276890468*x^551 + 211463242*x^550 + 611009955*x^549 + 41350370*x^548 + 1120260432*x^547 + 1217213406*x^546 + 1096884636*x^545 + 107298827*x^544 + 556646889*x^543 + 514714957*x^542 + 592531623*x^541 + 1185635127*x^540 + 866796164*x^539 + 1199009440*x^538 + 760543377*x^537 + 135043128*x^536 + 1184521976*x^535 + 53368352*x^534 + 614063947*x^533 + 117184488*x^532 + 1090625549*x^531 + 928160285*x^530 + 1065640157*x^529 + 307397590*x^528 + 383318068*x^527 + 890835908*x^526 + 416986540*x^525 + 222852700*x^524 + 965323537*x^523 + 151764017*x^522 + 193722745*x^521 + 439803983*x^520 + 942882901*x^519 + 56286764*x^518 + 824204572*x^517 + 478793274*x^516 + 183238303*x^515 + 922253103*x^514 + 5444136*x^513 + 402856270*x^512 + 508652113*x^511 + 898341402*x^510 + 56743140*x^509 + 179078829*x^508 + 360574641*x^507 + 691533190*x^506 + 982373838*x^505 + 719429684*x^504 + 962339948*x^503 + 1097706834*x^502 + 682588935*x^501 + 1193566532*x^500 + 1140505780*x^499 + 1167874911*x^498 + 669408623*x^497 + 15348570*x^496 + 896129486*x^495 + 100671957*x^494 + 1015786650*x^493 + 605094306*x^492 + 704959137*x^491 + 503877361*x^490 + 546763047*x^489 + 281625173*x^488 + 874599768*x^487 + 187483443*x^486 + 791213383*x^485 + 670376251*x^484 + 484751013*x^483 + 519454749*x^482 + 898655062*x^481 + 1088862155*x^480 + 843442957*x^479 + 429341712*x^478 + 869408179*x^477 + 921648096*x^476 + 526019939*x^475 + 856290375*x^474 + 531710459*x^473 + 1135323038*x^472 + 222776023*x^471 + 223826994*x^470 + 782612384*x^469 + 208579370*x^468 + 809908930*x^467 + 802818642*x^466 + 1182584545*x^465 + 245518705*x^464 + 114792460*x^463 + 646248449*x^462 + 63969962*x^461 + 761908644*x^460 + 523665668*x^459 + 1131060959*x^458 + 507746193*x^457 + 215968166*x^456 + 186113215*x^455 + 1117740378*x^454 + 649175082*x^453 + 396834257*x^452 + 274002774*x^451 + 626055138*x^450 + 924423066*x^449 + 81357715*x^448 + 1042994674*x^447 + 380053163*x^446 + 687766657*x^445 + 414805559*x^444 + 1118153385*x^443 + 1196507975*x^442 + 223759358*x^441 + 808836890*x^440 + 558230978*x^439 + 470920831*x^438 + 313868031*x^437 + 696317665*x^436 + 38725962*x^435 + 722983488*x^434 + 982704221*x^433 + 931470025*x^432 + 658261117*x^431 + 1043739465*x^430 + 422603501*x^429 + 879856656*x^428 + 977082068*x^427 + 593021461*x^426 + 955543544*x^425 + 194004912*x^424 + 1057355064*x^423 + 1153279801*x^422 + 1104874965*x^421 + 1157109085*x^420 + 54358054*x^419 + 802241073*x^418 + 489376522*x^417 + 250441773*x^416 + 740903923*x^415 + 81493461*x^414 + 966046559*x^413 + 295086523*x^412 + 1192114766*x^411 + 1186654005*x^410 + 768853461*x^409 + 302013033*x^408 + 1127093874*x^407 + 401944628*x^406 + 463364841*x^405 + 277324527*x^404 + 357826211*x^403 + 302642912*x^402 + 785232813*x^401 + 1155455395*x^400 + 240939622*x^399 + 1090741169*x^398 + 941697407*x^397 + 1108935255*x^396 + 63027943*x^395 + 415750779*x^394 + 36046273*x^393 + 172429619*x^392 + 563533800*x^391 + 961503349*x^390 + 356454474*x^389 + 586712431*x^388 + 572728001*x^387 + 670855384*x^386 + 268877633*x^385 + 51139525*x^384 + 806328542*x^383 + 790061093*x^382 + 140256246*x^381 + 430118720*x^380 + 924612224*x^379 + 923573107*x^378 + 1124645882*x^377 + 1044890409*x^376 + 509180566*x^375 + 371227114*x^374 + 161843486*x^373 + 296514161*x^372 + 454272518*x^371 + 755779732*x^370 + 295567281*x^369 + 1063635155*x^368 + 46603670*x^367 + 112353112*x^366 + 571920305*x^365 + 484055586*x^364 + 148075787*x^363 + 700140701*x^362 + 922814151*x^361 + 198283677*x^360 + 806078101*x^359 + 1218701262*x^358 + 679274064*x^357 + 408382456*x^356 + 284971608*x^355 + 1072737570*x^354 + 999420946*x^353 + 704897365*x^352 + 1147239838*x^351 + 1148707218*x^350 + 119677974*x^349 + 139766009*x^348 + 289899118*x^347 + 3099746*x^346 + 478334394*x^345 + 671867092*x^344 + 1123276962*x^343 + 1053910974*x^342 + 776016929*x^341 + 408840884*x^340 + 702734268*x^339 + 101137143*x^338 + 157330682*x^337 + 608473559*x^336 + 355406102*x^335 + 1189624142*x^334 + 87874850*x^333 + 1097033743*x^332 + 984835279*x^331 + 133446104*x^330 + 990221835*x^329 + 34152703*x^328 + 902602955*x^327 + 564227604*x^326 + 378045277*x^325 + 330935315*x^324 + 300442927*x^323 + 504016276*x^322 + 592727454*x^321 + 1075766200*x^320 + 718996149*x^319 + 823573424*x^318 + 834215705*x^317 + 430497892*x^316 + 879722938*x^315 + 968236501*x^314 + 262764692*x^313 + 37503817*x^312 + 607855810*x^311 + 1173289902*x^310 + 906609932*x^309 + 11948749*x^308 + 948969610*x^307 + 1130417155*x^306 + 892108695*x^305 + 1040897188*x^304 + 174698274*x^303 + 85414336*x^302 + 758730292*x^301 + 615781943*x^300 + 1215130735*x^299 + 1168693743*x^298 + 1070287857*x^297 + 501559848*x^296 + 485147924*x^295 + 1218893131*x^294 + 923876087*x^293 + 565056561*x^292 + 282754375*x^291 + 794028720*x^290 + 288419549*x^289 + 688387454*x^288 + 40339086*x^287 + 659115548*x^286 + 614342861*x^285 + 391568544*x^284 + 464738754*x^283 + 28669498*x^282 + 1115640335*x^281 + 870635325*x^280 + 126237247*x^279 + 1111165998*x^278 + 205027579*x^277 + 911218811*x^276 + 208748481*x^275 + 725176545*x^274 + 765151044*x^273 + 939495648*x^272 + 550038893*x^271 + 905707993*x^270 + 267107699*x^269 + 477779883*x^268 + 251985659*x^267 + 754082836*x^266 + 159569451*x^265 + 781616103*x^264 + 1098961576*x^263 + 1139687026*x^262 + 473401848*x^261 + 623689501*x^260 + 1012676202*x^259 + 76777202*x^258 + 170602576*x^257 + 266093330*x^256 + 732274753*x^255 + 193219366*x^254 + 610602682*x^253 + 749761392*x^252 + 536911921*x^251 + 1052883954*x^250 + 1139729422*x^249 + 617278363*x^248 + 603450863*x^247 + 877968049*x^246 + 1078543204*x^245 + 441578327*x^244 + 821469144*x^243 + 1083268726*x^242 + 592074734*x^241 + 431251183*x^240 + 1151073027*x^239 + 596034003*x^238 + 507176703*x^237 + 638155464*x^236 + 820097610*x^235 + 69713965*x^234 + 111089281*x^233 + 403306683*x^232 + 417322569*x^231 + 510992488*x^230 + 406068742*x^229 + 487323397*x^228 + 1105866147*x^227 + 126043214*x^226 + 565379393*x^225 + 774566507*x^224 + 94477834*x^223 + 301787901*x^222 + 891557978*x^221 + 246179873*x^220 + 76065360*x^219 + 632831219*x^218 + 967852970*x^217 + 982932236*x^216 + 457056482*x^215 + 611696056*x^214 + 187879254*x^213 + 919970751*x^212 + 726626422*x^211 + 744906999*x^210 + 514152204*x^209 + 400846913*x^208 + 1057213516*x^207 + 458393393*x^206 + 39867352*x^205 + 482474421*x^204 + 1017159775*x^203 + 1127386440*x^202 + 186890818*x^201 + 297371952*x^200 + 827010510*x^199 + 457757189*x^198 + 120047360*x^197 + 403406161*x^196 + 561776540*x^195 + 269984973*x^194 + 1105865523*x^193 + 356682370*x^192 + 521018201*x^191 + 714326305*x^190 + 230112489*x^189 + 468954949*x^188 + 428412182*x^187 + 418097923*x^186 + 648421330*x^185 + 119412602*x^184 + 1029175202*x^183 + 961854350*x^182 + 359274957*x^181 + 918516748*x^180 + 393392054*x^179 + 998769881*x^178 + 713880369*x^177 + 23918875*x^176 + 19140072*x^175 + 296443203*x^174 + 1036511543*x^173 + 208417465*x^172 + 856221174*x^171 + 724608949*x^170 + 1148614286*x^169 + 605394185*x^168 + 1037184954*x^167 + 1149508482*x^166 + 748219008*x^165 + 762595570*x^164 + 240812860*x^163 + 221590855*x^162 + 921277317*x^161 + 666749995*x^160 + 270085731*x^159 + 719780654*x^158 + 1023109552*x^157 + 948736441*x^156 + 942460534*x^155 + 1190076672*x^154 + 298412436*x^153 + 146236637*x^152 + 136974417*x^151 + 247369427*x^150 + 1164600849*x^149 + 80725190*x^148 + 563971590*x^147 + 838975230*x^146 + 605884308*x^145 + 695738052*x^144 + 457993644*x^143 + 608089160*x^142 + 279768415*x^141 + 167776427*x^140 + 99830319*x^139 + 724761513*x^138 + 838344856*x^137 + 349705095*x^136 + 700591961*x^135 + 495192008*x^134 + 166834844*x^133 + 829383641*x^132 + 689577635*x^131 + 1063098370*x^130 + 1217658142*x^129 + 210005674*x^128 + 709445493*x^127 + 890260692*x^126 + 11818873*x^125 + 356866298*x^124 + 657354178*x^123 + 1083325742*x^122 + 256937537*x^121 + 832141251*x^120 + 738779202*x^119 + 531375449*x^118 + 570407521*x^117 + 253499493*x^116 + 936295735*x^115 + 840539077*x^114 + 1108243632*x^113 + 518037787*x^112 + 512681158*x^111 + 659791034*x^110 + 615039004*x^109 + 6475754*x^108 + 112655504*x^107 + 135513268*x^106 + 814830817*x^105 + 312451349*x^104 + 459204360*x^103 + 536270797*x^102 + 487599107*x^101 + 995873996*x^100 + 947176358*x^99 + 161110841*x^98 + 1215850742*x^97 + 828031021*x^96 + 393857015*x^95 + 483165571*x^94 + 1169422374*x^93 + 185485308*x^92 + 1113820447*x^91 + 1217012548*x^90 + 591690262*x^89 + 230984245*x^88 + 1183186281*x^87 + 984746087*x^86 + 321334226*x^85 + 356396152*x^84 + 812358214*x^83 + 652862462*x^82 + 1159946831*x^81 + 1185692555*x^80 + 1101691161*x^79 + 1162783803*x^78 + 592033894*x^77 + 545367197*x^76 + 441688164*x^75 + 169491076*x^74 + 181297517*x^73 + 590332818*x^72 + 814337101*x^71 + 1148316386*x^70 + 700258144*x^69 + 719201877*x^68 + 1160695934*x^67 + 1186868159*x^66 + 508542038*x^65 + 1113702100*x^64 + 921032142*x^63 + 758636144*x^62 + 890540800*x^61 + 136808203*x^60 + 74886413*x^59 + 156077420*x^58 + 925473910*x^57 + 111404286*x^56 + 355116767*x^55 + 468038980*x^54 + 89708844*x^53 + 878616521*x^52 + 1154657871*x^51 + 677831135*x^50 + 903468800*x^49 + 890557208*x^48 + 1035114476*x^47 + 198189399*x^46 + 864375452*x^45 + 1164916963*x^44 + 929627324*x^43 + 418711325*x^42 + 97430691*x^41 + 1172413774*x^40 + 760600756*x^39 + 943281805*x^38 + 53033182*x^37 + 123566782*x^36 + 665472336*x^35 + 521103310*x^34 + 892876972*x^33 + 169828417*x^32 + 315862403*x^31 + 973295601*x^30 + 1036868940*x^29 + 469235131*x^28 + 1097609240*x^27 + 446027303*x^26 + 356219098*x^25 + 480790123*x^24 + 94742566*x^23 + 691728720*x^22 + 922852954*x^21 + 21648854*x^20 + 903452116*x^19 + 1043050543*x^18 + 867501915*x^17 + 402312961*x^16 + 772349320*x^15 + 806410607*x^14 + 573402289*x^13 + 103888540*x^12 + 147927873*x^11 + 1005161156*x^10 + 988774771*x^9 + 682875980*x^8 + 54946232*x^7 + 717143945*x^6 + 323577100*x^5 + 803064428*x^4 + 598462622*x^3 + 1110253556*x^2 + 764371182*x + 634648371</span><br><span class="line">b= 735531500*x^1023 + 684755229*x^1022 + 978579144*x^1021 + 560225565*x^1020 + 758090578*x^1019 + 367477932*x^1018 + 326779415*x^1017 + 26800946*x^1016 + 199017905*x^1015 + 1156874439*x^1014 + 673969262*x^1013 + 617169647*x^1012 + 462256026*x^1011 + 303059784*x^1010 + 663728970*x^1009 + 376865711*x^1008 + 830705685*x^1007 + 573964358*x^1006 + 1210202059*x^1005 + 269197755*x^1004 + 586236496*x^1003 + 621987820*x^1002 + 485567868*x^1001 + 305700227*x^1000 + 1052698462*x^999 + 86861550*x^998 + 44767901*x^997 + 410897986*x^996 + 212344404*x^995 + 336381747*x^994 + 398182335*x^993 + 660275371*x^992 + 52728322*x^991 + 1193103469*x^990 + 684295535*x^989 + 1029981794*x^988 + 1051866415*x^987 + 418681909*x^986 + 976794520*x^985 + 1180496804*x^984 + 438513041*x^983 + 822843942*x^982 + 1119264881*x^981 + 790873853*x^980 + 1146506838*x^979 + 27016797*x^978 + 1149126201*x^977 + 967895459*x^976 + 1201841165*x^975 + 264216641*x^974 + 751855165*x^973 + 277480010*x^972 + 955969328*x^971 + 784721168*x^970 + 696371212*x^969 + 401164998*x^968 + 654719011*x^967 + 785183205*x^966 + 79070435*x^965 + 1140562925*x^964 + 1025154340*x^963 + 1044315421*x^962 + 392734282*x^961 + 234286141*x^960 + 962551866*x^959 + 133742245*x^958 + 998056106*x^957 + 781318236*x^956 + 23528574*x^955 + 1214036424*x^954 + 296666931*x^953 + 1211729921*x^952 + 561550286*x^951 + 634392845*x^950 + 422332555*x^949 + 765556851*x^948 + 1151849524*x^947 + 305981530*x^946 + 246290056*x^945 + 24304550*x^944 + 477073522*x^943 + 416104453*x^942 + 898162013*x^941 + 611609496*x^940 + 445765799*x^939 + 430180169*x^938 + 1151421310*x^937 + 439515367*x^936 + 795257572*x^935 + 578106992*x^934 + 929259980*x^933 + 550407102*x^932 + 1219047347*x^931 + 15972593*x^930 + 515513177*x^929 + 679675449*x^928 + 914537835*x^927 + 156230965*x^926 + 385558312*x^925 + 1036365654*x^924 + 1098274877*x^923 + 348628203*x^922 + 1093802915*x^921 + 1162728002*x^920 + 200502246*x^919 + 551049082*x^918 + 969116717*x^917 + 1127382445*x^916 + 968172543*x^915 + 346881523*x^914 + 41744706*x^913 + 335042561*x^912 + 593895276*x^911 + 15888292*x^910 + 324866127*x^909 + 937351605*x^908 + 347255852*x^907 + 1120419679*x^906 + 249832197*x^905 + 896923860*x^904 + 129801128*x^903 + 207849052*x^902 + 386825059*x^901 + 823406098*x^900 + 977635408*x^899 + 108813100*x^898 + 561865827*x^897 + 718000532*x^896 + 48090035*x^895 + 832337939*x^894 + 1084389292*x^893 + 793335438*x^892 + 1095245016*x^891 + 1080787282*x^890 + 122666287*x^889 + 937313249*x^888 + 62818846*x^887 + 1170462486*x^886 + 182439366*x^885 + 792906343*x^884 + 1205386767*x^883 + 310389549*x^882 + 603676058*x^881 + 671251954*x^880 + 640345010*x^879 + 1087374504*x^878 + 119769446*x^877 + 135989573*x^876 + 880703983*x^875 + 613578242*x^874 + 1207874966*x^873 + 972002390*x^872 + 644470053*x^871 + 335762119*x^870 + 1079917808*x^869 + 1023711373*x^868 + 861485470*x^867 + 230979333*x^866 + 683284149*x^865 + 645804102*x^864 + 577971621*x^863 + 33779989*x^862 + 915467237*x^861 + 834966216*x^860 + 445758874*x^859 + 685228217*x^858 + 979609284*x^857 + 842509205*x^856 + 221373358*x^855 + 150166201*x^854 + 927937340*x^853 + 995054125*x^852 + 704623324*x^851 + 1112892592*x^850 + 782816865*x^849 + 878518510*x^848 + 391872241*x^847 + 30062686*x^846 + 108900016*x^845 + 1034780269*x^844 + 1190084541*x^843 + 441686497*x^842 + 117953957*x^841 + 840802549*x^840 + 903238790*x^839 + 551715093*x^838 + 539420097*x^837 + 1007110444*x^836 + 673864283*x^835 + 756402005*x^834 + 197892310*x^833 + 981720851*x^832 + 798897509*x^831 + 1127242378*x^830 + 666754217*x^829 + 685248618*x^828 + 327773092*x^827 + 390697118*x^826 + 912223373*x^825 + 482947333*x^824 + 1110169857*x^823 + 780612147*x^822 + 194698743*x^821 + 716386043*x^820 + 424946693*x^819 + 22701975*x^818 + 293011366*x^817 + 947695756*x^816 + 1188483932*x^815 + 1002073886*x^814 + 1078210750*x^813 + 1127684166*x^812 + 719332394*x^811 + 1072532713*x^810 + 550629553*x^809 + 188195613*x^808 + 614412704*x^807 + 649960359*x^806 + 1010011298*x^805 + 824975518*x^804 + 311757403*x^803 + 93674481*x^802 + 380323800*x^801 + 1086623904*x^800 + 240170088*x^799 + 956396081*x^798 + 939969890*x^797 + 131843464*x^796 + 1045744996*x^795 + 424359277*x^794 + 550616456*x^793 + 1061637035*x^792 + 444548551*x^791 + 677546521*x^790 + 149605032*x^789 + 829567560*x^788 + 516053142*x^787 + 1191529914*x^786 + 294270928*x^785 + 142024389*x^784 + 584911191*x^783 + 307856659*x^782 + 81514660*x^781 + 543784156*x^780 + 108008163*x^779 + 13154295*x^778 + 155266054*x^777 + 663702892*x^776 + 782494602*x^775 + 747547833*x^774 + 242456376*x^773 + 669844220*x^772 + 552894098*x^771 + 1036366706*x^770 + 1074841665*x^769 + 720745418*x^768 + 1137936670*x^767 + 840875363*x^766 + 476498840*x^765 + 1088669461*x^764 + 1249649*x^763 + 882277578*x^762 + 37842126*x^761 + 398977801*x^760 + 328296234*x^759 + 536342859*x^758 + 608139240*x^757 + 897424944*x^756 + 76562916*x^755 + 428081420*x^754 + 627420927*x^753 + 265131678*x^752 + 1034443577*x^751 + 177902661*x^750 + 490977141*x^749 + 1084536775*x^748 + 1189221123*x^747 + 854191429*x^746 + 952038058*x^745 + 891288300*x^744 + 929356576*x^743 + 223874272*x^742 + 220297702*x^741 + 1099283305*x^740 + 1008574448*x^739 + 619949004*x^738 + 747199791*x^737 + 760703880*x^736 + 7682727*x^735 + 88566484*x^734 + 733742620*x^733 + 381443925*x^732 + 799269923*x^731 + 233342676*x^730 + 1205696983*x^729 + 765306727*x^728 + 29342855*x^727 + 287728251*x^726 + 214358216*x^725 + 355991367*x^724 + 344973841*x^723 + 436344093*x^722 + 547944829*x^721 + 1041405031*x^720 + 368771692*x^719 + 37426577*x^718 + 502936636*x^717 + 732825913*x^716 + 518778589*x^715 + 561797784*x^714 + 773068766*x^713 + 75615306*x^712 + 668933267*x^711 + 628975723*x^710 + 1140697439*x^709 + 108807342*x^708 + 283945737*x^707 + 701674528*x^706 + 1120373548*x^705 + 421627231*x^704 + 260846853*x^703 + 292537012*x^702 + 583513440*x^701 + 609720259*x^700 + 831373721*x^699 + 1126099385*x^698 + 431095431*x^697 + 296863241*x^696 + 371013827*x^695 + 549980853*x^694 + 550174635*x^693 + 620963563*x^692 + 952040422*x^691 + 1150044500*x^690 + 893175261*x^689 + 1139857784*x^688 + 972717568*x^687 + 735672517*x^686 + 1177501026*x^685 + 765934764*x^684 + 710762091*x^683 + 871268519*x^682 + 969318271*x^681 + 286261161*x^680 + 65128931*x^679 + 1100922672*x^678 + 47619662*x^677 + 981578224*x^676 + 67232154*x^675 + 1928142*x^674 + 817643007*x^673 + 675713298*x^672 + 185236805*x^671 + 331446457*x^670 + 129023118*x^669 + 431426370*x^668 + 1154277684*x^667 + 723182950*x^666 + 1144823093*x^665 + 822001162*x^664 + 356099532*x^663 + 705989193*x^662 + 878712048*x^661 + 1095044481*x^660 + 332193401*x^659 + 613329359*x^658 + 673744151*x^657 + 808080280*x^656 + 225562949*x^655 + 185686220*x^654 + 742469973*x^653 + 986152315*x^652 + 13611550*x^651 + 535747170*x^650 + 233786507*x^649 + 27955348*x^648 + 1004446959*x^647 + 1071164149*x^646 + 265258708*x^645 + 63221383*x^644 + 682228580*x^643 + 867131152*x^642 + 997600620*x^641 + 993922001*x^640 + 693252545*x^639 + 865655581*x^638 + 518295141*x^637 + 902072633*x^636 + 704953646*x^635 + 587251157*x^634 + 99168972*x^633 + 1105480730*x^632 + 1040404159*x^631 + 436113220*x^630 + 152714904*x^629 + 697469981*x^628 + 1185372838*x^627 + 216027999*x^626 + 616083931*x^625 + 399419685*x^624 + 23193568*x^623 + 1174129641*x^622 + 75724376*x^621 + 570399858*x^620 + 754947446*x^619 + 1037864447*x^618 + 794730343*x^617 + 60369472*x^616 + 750769016*x^615 + 61444481*x^614 + 333194445*x^613 + 1109236037*x^612 + 513379869*x^611 + 706807998*x^610 + 999669914*x^609 + 1198194959*x^608 + 336044172*x^607 + 402719207*x^606 + 1050007981*x^605 + 429464593*x^604 + 679293134*x^603 + 734513317*x^602 + 838385265*x^601 + 990800608*x^600 + 1162093896*x^599 + 173467508*x^598 + 123947890*x^597 + 325712596*x^596 + 1049522320*x^595 + 1072653958*x^594 + 565759817*x^593 + 549918485*x^592 + 574268523*x^591 + 1052593520*x^590 + 474323970*x^589 + 262787725*x^588 + 1091470590*x^587 + 782664905*x^586 + 1201833996*x^585 + 808712564*x^584 + 619522329*x^583 + 233329446*x^582 + 730502283*x^581 + 1017501853*x^580 + 306080194*x^579 + 283641594*x^578 + 195324593*x^577 + 1116741123*x^576 + 289439631*x^575 + 206064600*x^574 + 280021778*x^573 + 425409216*x^572 + 1107952582*x^571 + 131800177*x^570 + 106903346*x^569 + 72306234*x^568 + 934072451*x^567 + 242740893*x^566 + 106611451*x^565 + 429378634*x^564 + 127624569*x^563 + 587315789*x^562 + 932709753*x^561 + 523886142*x^560 + 110330665*x^559 + 963244036*x^558 + 227339325*x^557 + 185882207*x^556 + 987833442*x^555 + 981380006*x^554 + 1140813804*x^553 + 538704418*x^552 + 842520362*x^551 + 597627400*x^550 + 165232274*x^549 + 900076209*x^548 + 311342603*x^547 + 477271753*x^546 + 1072907066*x^545 + 1066126181*x^544 + 791702251*x^543 + 623246063*x^542 + 1082681410*x^541 + 759396967*x^540 + 878108937*x^539 + 724607060*x^538 + 79223685*x^537 + 307312027*x^536 + 234246571*x^535 + 330319932*x^534 + 274254378*x^533 + 1082820468*x^532 + 68920838*x^531 + 1195376541*x^530 + 170971307*x^529 + 399525324*x^528 + 238798853*x^527 + 664426862*x^526 + 269949285*x^525 + 698202786*x^524 + 88964561*x^523 + 635539315*x^522 + 1016514687*x^521 + 122364467*x^520 + 1095096646*x^519 + 513834099*x^518 + 672478524*x^517 + 47526709*x^516 + 48782616*x^515 + 166225959*x^514 + 810099682*x^513 + 168540411*x^512 + 30055377*x^511 + 817325819*x^510 + 202717189*x^509 + 739906349*x^508 + 186072589*x^507 + 451966755*x^506 + 684027658*x^505 + 251331059*x^504 + 591972494*x^503 + 289197098*x^502 + 829928406*x^501 + 160528626*x^500 + 90951219*x^499 + 496118642*x^498 + 117818178*x^497 + 215417436*x^496 + 937904122*x^495 + 962080493*x^494 + 423647737*x^493 + 1094089608*x^492 + 97559711*x^491 + 412409151*x^490 + 1039695658*x^489 + 461079746*x^488 + 564664118*x^487 + 2231630*x^486 + 667569567*x^485 + 471400483*x^484 + 691739455*x^483 + 146641223*x^482 + 445509678*x^481 + 788647561*x^480 + 100316571*x^479 + 927803124*x^478 + 225739054*x^477 + 339283562*x^476 + 741552554*x^475 + 674303545*x^474 + 610706793*x^473 + 1045437706*x^472 + 758427998*x^471 + 518677374*x^470 + 1020530386*x^469 + 81672436*x^468 + 684553666*x^467 + 36416557*x^466 + 1083076029*x^465 + 63903696*x^464 + 655765095*x^463 + 464055997*x^462 + 874368360*x^461 + 909538282*x^460 + 1084815716*x^459 + 971305398*x^458 + 504958756*x^457 + 941782746*x^456 + 410981017*x^455 + 44463213*x^454 + 57796260*x^453 + 633624768*x^452 + 902476625*x^451 + 1190884714*x^450 + 30960289*x^449 + 698111360*x^448 + 507015564*x^447 + 595305556*x^446 + 1170147546*x^445 + 595449153*x^444 + 1132050715*x^443 + 566093951*x^442 + 1125890381*x^441 + 864044563*x^440 + 608408253*x^439 + 128031905*x^438 + 951152598*x^437 + 41054884*x^436 + 1012755213*x^435 + 1091670374*x^434 + 481898210*x^433 + 1007980179*x^432 + 43301236*x^431 + 6478999*x^430 + 1175215424*x^429 + 597862715*x^428 + 441537430*x^427 + 339705054*x^426 + 289227345*x^425 + 795113772*x^424 + 404870950*x^423 + 997272819*x^422 + 634256255*x^421 + 453060086*x^420 + 821493547*x^419 + 842289852*x^418 + 223251279*x^417 + 929721613*x^416 + 63980045*x^415 + 298369623*x^414 + 1026287144*x^413 + 979092254*x^412 + 1182904024*x^411 + 298048453*x^410 + 653297794*x^409 + 365769179*x^408 + 45373617*x^407 + 7228243*x^406 + 1086374067*x^405 + 389455721*x^404 + 992518297*x^403 + 433929335*x^402 + 1149626197*x^401 + 90006250*x^400 + 1011632630*x^399 + 940906615*x^398 + 564772117*x^397 + 692974220*x^396 + 561321375*x^395 + 1095715303*x^394 + 1006114558*x^393 + 95516055*x^392 + 640816811*x^391 + 869737844*x^390 + 248741996*x^389 + 101754352*x^388 + 253268107*x^387 + 593472036*x^386 + 627778298*x^385 + 801877646*x^384 + 286581226*x^383 + 645931883*x^382 + 373119745*x^381 + 461109006*x^380 + 594214135*x^379 + 751634451*x^378 + 706229440*x^377 + 247985412*x^376 + 993987710*x^375 + 618989435*x^374 + 600506682*x^373 + 179955505*x^372 + 956234357*x^371 + 1049030902*x^370 + 727597507*x^369 + 1196607714*x^368 + 610634244*x^367 + 619865634*x^366 + 849131167*x^365 + 1094185730*x^364 + 685353152*x^363 + 299082549*x^362 + 1076769237*x^361 + 792938001*x^360 + 885082721*x^359 + 1198739364*x^358 + 273154602*x^357 + 597517874*x^356 + 351418158*x^355 + 621945565*x^354 + 949756104*x^353 + 1020290901*x^352 + 315372660*x^351 + 291246927*x^350 + 1016861207*x^349 + 171467993*x^348 + 1074074496*x^347 + 660775696*x^346 + 562891589*x^345 + 258618000*x^344 + 521058831*x^343 + 152819838*x^342 + 1141330990*x^341 + 383408903*x^340 + 677850803*x^339 + 165908062*x^338 + 66975904*x^337 + 510786934*x^336 + 32306220*x^335 + 708115806*x^334 + 474352780*x^333 + 963188335*x^332 + 151844162*x^331 + 907339624*x^330 + 456166118*x^329 + 111742252*x^328 + 318018829*x^327 + 624012970*x^326 + 255354390*x^325 + 1218329311*x^324 + 375000855*x^323 + 54956044*x^322 + 13543809*x^321 + 671163260*x^320 + 226676913*x^319 + 1193470867*x^318 + 477161216*x^317 + 519506783*x^316 + 748987057*x^315 + 768531367*x^314 + 327816599*x^313 + 59056092*x^312 + 520958252*x^311 + 243337260*x^310 + 608632530*x^309 + 65258636*x^308 + 1012579720*x^307 + 400176357*x^306 + 104583966*x^305 + 1114827176*x^304 + 70705682*x^303 + 5320656*x^302 + 1207465008*x^301 + 1211372826*x^300 + 886104873*x^299 + 747144635*x^298 + 227753814*x^297 + 427912588*x^296 + 425232985*x^295 + 135219277*x^294 + 541439233*x^293 + 82586191*x^292 + 1024575564*x^291 + 408418547*x^290 + 1076407665*x^289 + 184646604*x^288 + 894569780*x^287 + 730742386*x^286 + 473643018*x^285 + 561906151*x^284 + 582231889*x^283 + 928617667*x^282 + 460594931*x^281 + 946340582*x^280 + 881007408*x^279 + 655553538*x^278 + 107738502*x^277 + 958107338*x^276 + 874269820*x^275 + 689734430*x^274 + 1025286771*x^273 + 809509338*x^272 + 126580761*x^271 + 425724981*x^270 + 91398446*x^269 + 915486182*x^268 + 750598785*x^267 + 331692120*x^266 + 266239686*x^265 + 41813860*x^264 + 1003196915*x^263 + 1006275694*x^262 + 958171508*x^261 + 387655573*x^260 + 529686749*x^259 + 2533683*x^258 + 851532040*x^257 + 515865631*x^256 + 331149910*x^255 + 1058283457*x^254 + 478391568*x^253 + 1020601120*x^252 + 193954604*x^251 + 125558467*x^250 + 916367669*x^249 + 965664721*x^248 + 737411958*x^247 + 145954639*x^246 + 787702411*x^245 + 256023548*x^244 + 831752864*x^243 + 637799028*x^242 + 202325459*x^241 + 189858829*x^240 + 221236168*x^239 + 276967229*x^238 + 732958371*x^237 + 31622618*x^236 + 558911372*x^235 + 257580689*x^234 + 490167674*x^233 + 1164269554*x^232 + 765931664*x^231 + 89716985*x^230 + 639008878*x^229 + 716033538*x^228 + 186948569*x^227 + 870251868*x^226 + 383121640*x^225 + 604362204*x^224 + 405526662*x^223 + 127371887*x^222 + 543669202*x^221 + 823112915*x^220 + 523517382*x^219 + 791437322*x^218 + 1069279817*x^217 + 960628355*x^216 + 1012582276*x^215 + 1200088601*x^214 + 927011022*x^213 + 830570829*x^212 + 700668365*x^211 + 1205573850*x^210 + 276778781*x^209 + 786305215*x^208 + 928215922*x^207 + 154393796*x^206 + 169298902*x^205 + 177646296*x^204 + 173339370*x^203 + 287217637*x^202 + 1077403939*x^201 + 1004965535*x^200 + 677352462*x^199 + 545192340*x^198 + 464170452*x^197 + 381853900*x^196 + 205643848*x^195 + 973330672*x^194 + 1148733662*x^193 + 458436519*x^192 + 68604889*x^191 + 193530886*x^190 + 141661386*x^189 + 1117183144*x^188 + 153035244*x^187 + 830892599*x^186 + 795500906*x^185 + 67041425*x^184 + 617209634*x^183 + 180547177*x^182 + 1183445159*x^181 + 303603618*x^180 + 842724764*x^179 + 784982658*x^178 + 1199356684*x^177 + 321497016*x^176 + 513738925*x^175 + 465949450*x^174 + 981246204*x^173 + 814398377*x^172 + 950247970*x^171 + 720838080*x^170 + 399493165*x^169 + 735365971*x^168 + 109745845*x^167 + 897998838*x^166 + 547497972*x^165 + 174675208*x^164 + 716115074*x^163 + 237209800*x^162 + 186394653*x^161 + 876995839*x^160 + 1187252196*x^159 + 819282320*x^158 + 44596523*x^157 + 679033559*x^156 + 736746236*x^155 + 1184916922*x^154 + 451294643*x^153 + 443590366*x^152 + 304384335*x^151 + 1064695584*x^150 + 602535518*x^149 + 684486124*x^148 + 863476315*x^147 + 496170722*x^146 + 737062216*x^145 + 285799611*x^144 + 1085153158*x^143 + 247783563*x^142 + 1208043659*x^141 + 208776666*x^140 + 117730360*x^139 + 279620264*x^138 + 273045622*x^137 + 893971194*x^136 + 240743423*x^135 + 1143029271*x^134 + 326725356*x^133 + 294174585*x^132 + 672819095*x^131 + 138843366*x^130 + 1176670148*x^129 + 573825049*x^128 + 835249905*x^127 + 778468469*x^126 + 300257393*x^125 + 409352854*x^124 + 953527813*x^123 + 653640743*x^122 + 1210615840*x^121 + 596684403*x^120 + 46012813*x^119 + 510765516*x^118 + 1213476223*x^117 + 1132779740*x^116 + 769195645*x^115 + 963749389*x^114 + 843804183*x^113 + 109759209*x^112 + 493130294*x^111 + 1122857844*x^110 + 1130618881*x^109 + 648465049*x^108 + 364595574*x^107 + 410134064*x^106 + 597836905*x^105 + 831243271*x^104 + 226275998*x^103 + 686704033*x^102 + 662011231*x^101 + 112226051*x^100 + 623946037*x^99 + 469742204*x^98 + 369854172*x^97 + 731154062*x^96 + 352916654*x^95 + 45991298*x^94 + 614913911*x^93 + 632337602*x^92 + 327529986*x^91 + 111251878*x^90 + 657089210*x^89 + 499853920*x^88 + 966818975*x^87 + 454584975*x^86 + 116582431*x^85 + 619242494*x^84 + 455382561*x^83 + 246350547*x^82 + 495191129*x^81 + 900852972*x^80 + 264825752*x^79 + 426813960*x^78 + 478124215*x^77 + 1080567657*x^76 + 858353771*x^75 + 215115660*x^74 + 963682245*x^73 + 964445096*x^72 + 73603206*x^71 + 734630202*x^70 + 199652522*x^69 + 520021635*x^68 + 763256200*x^67 + 861482624*x^66 + 890485659*x^65 + 523362913*x^64 + 785087110*x^63 + 381314881*x^62 + 843850504*x^61 + 61951613*x^60 + 119100925*x^59 + 531827488*x^58 + 199818669*x^57 + 592207491*x^56 + 354682041*x^55 + 1015447358*x^54 + 328324806*x^53 + 24880841*x^52 + 516663598*x^51 + 716706066*x^50 + 1042483154*x^49 + 331433641*x^48 + 929901382*x^47 + 502140671*x^46 + 48123362*x^45 + 1112586174*x^44 + 14618102*x^43 + 764832169*x^42 + 446768463*x^41 + 920421919*x^40 + 491851586*x^39 + 24718814*x^38 + 83091454*x^37 + 155770396*x^36 + 12824441*x^35 + 954371888*x^34 + 318592841*x^33 + 788251579*x^32 + 246435934*x^31 + 387083299*x^30 + 395226231*x^29 + 646811732*x^28 + 1131418388*x^27 + 1135116504*x^26 + 986902782*x^25 + 323457413*x^24 + 521885110*x^23 + 234655676*x^22 + 965166497*x^21 + 755967054*x^20 + 574743395*x^19 + 1175664410*x^18 + 117322371*x^17 + 794664856*x^16 + 570463*x^15 + 1148572518*x^14 + 439320220*x^13 + 815953366*x^12 + 389050726*x^11 + 1167287391*x^10 + 397052468*x^9 + 275572458*x^8 + 548665509*x^7 + 1202175986*x^6 + 518662014*x^5 + 1084425257*x^4 + 7854568*x^3 + 274607457*x^2 + 162444786*x + 410560230</span><br><span class="line">a = R(a)</span><br><span class="line">b = R(b)</span><br><span class="line">print(a[0])</span><br><span class="line">dim = 64</span><br><span class="line">M=matrix(ZZ,dim*2+1,dim*2+1)</span><br><span class="line">for i in range(dim):</span><br><span class="line">    for j in range(dim):</span><br><span class="line">        M[i,j]=a[(j-i)%1024]</span><br><span class="line">for i in range(64,128):</span><br><span class="line">    M[i,i-64]=q</span><br><span class="line">    M[i,i]=1</span><br><span class="line">for i in range(64):</span><br><span class="line">    M[-1,i]=b[i]</span><br><span class="line">M[-1,-1]=1</span><br><span class="line">w=M.BKZ()[0]</span><br><span class="line">v=w*M^(-1)</span><br><span class="line">print(v)</span><br><span class="line"></span><br><span class="line"># sk = [abs(x) for x in v[:64]]</span><br><span class="line"># sk = &#x27;&#x27;.join([chr(x) for x in sk])</span><br><span class="line"># print(sk)</span><br></pre></td></tr></table></figure>
<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="babycom"><a href="#babycom" class="headerlink" title="babycom"></a>babycom</h3><p>程序运行的时候会在本地的Local/temp路径下释放一个babycom.dll文件并加载</p>
<p>追踪到在此位置会调用babaycom.dll的加密函数</p>
<img src="/2024/02/07/L3HCTF%202024/image-20240209124239572.png" class title="image-20240209124239572">
<p>跟踪进行获取相关加密算法如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall encrypt(__int64 a1, const WCHAR *plaintext, BSTR *cipher)</span><br><span class="line">&#123;</span><br><span class="line">  void (__fastcall *v4)(int *, BYTE *); // r13</span><br><span class="line">  HMODULE v5; // rsi</span><br><span class="line">  __int64 v6; // rdi</span><br><span class="line">  _DWORD *v7; // r14</span><br><span class="line">  char *v8; // r12</span><br><span class="line">  const char *v9; // rbx</span><br><span class="line">  size_t v10; // rax</span><br><span class="line">  size_t v11; // rcx</span><br><span class="line">  int v12; // er9</span><br><span class="line">  int v13; // er8</span><br><span class="line">  __int64 v14; // r11</span><br><span class="line">  unsigned int v15; // er8</span><br><span class="line">  unsigned int v16; // er10</span><br><span class="line">  unsigned int v17; // er9</span><br><span class="line">  char v18; // dl</span><br><span class="line">  __int64 v19; // rbx</span><br><span class="line">  unsigned int v20; // eax</span><br><span class="line">  unsigned int v21; // er10</span><br><span class="line">  unsigned int v22; // er8</span><br><span class="line">  unsigned int v23; // er9</span><br><span class="line">  int v24; // ecx</span><br><span class="line">  unsigned int v25; // er8</span><br><span class="line">  unsigned int v26; // er9</span><br><span class="line">  int v27; // ecx</span><br><span class="line">  unsigned int v28; // er8</span><br><span class="line">  unsigned int v29; // er9</span><br><span class="line">  unsigned int v30; // eax</span><br><span class="line">  unsigned int v31; // er8</span><br><span class="line">  unsigned int v32; // er9</span><br><span class="line">  int v33; // ecx</span><br><span class="line">  unsigned int v34; // er8</span><br><span class="line">  unsigned int v35; // er9</span><br><span class="line">  int v36; // ecx</span><br><span class="line">  unsigned int v37; // er8</span><br><span class="line">  unsigned int v38; // er9</span><br><span class="line">  unsigned int v39; // eax</span><br><span class="line">  unsigned int v40; // er8</span><br><span class="line">  unsigned int v41; // er9</span><br><span class="line">  int v42; // ecx</span><br><span class="line">  unsigned int v43; // er8</span><br><span class="line">  unsigned int v44; // er9</span><br><span class="line">  int v45; // ecx</span><br><span class="line">  unsigned int v46; // er8</span><br><span class="line">  unsigned int v47; // er9</span><br><span class="line">  int v48; // ecx</span><br><span class="line">  unsigned int v49; // er8</span><br><span class="line">  unsigned int v50; // er9</span><br><span class="line">  int v51; // ecx</span><br><span class="line">  unsigned int v52; // er8</span><br><span class="line">  unsigned int v53; // er9</span><br><span class="line">  int v54; // ecx</span><br><span class="line">  unsigned int v55; // er8</span><br><span class="line">  unsigned int v56; // er9</span><br><span class="line">  unsigned int v57; // er8</span><br><span class="line">  unsigned int v58; // er9</span><br><span class="line">  int v59; // ecx</span><br><span class="line">  unsigned int v60; // er8</span><br><span class="line">  unsigned int v61; // er9</span><br><span class="line">  int v62; // ecx</span><br><span class="line">  unsigned int v63; // er8</span><br><span class="line">  unsigned int v64; // er9</span><br><span class="line">  int v65; // ecx</span><br><span class="line">  char *v67; // [rsp+48h] [rbp-81h]</span><br><span class="line">  char *v68; // [rsp+50h] [rbp-79h]</span><br><span class="line">  BYTE pbData[4]; // [rsp+60h] [rbp-69h] BYREF</span><br><span class="line">  HCRYPTHASH phHash; // [rsp+70h] [rbp-59h] BYREF</span><br><span class="line">  HCRYPTPROV phProv; // [rsp+78h] [rbp-51h] BYREF</span><br><span class="line">  DWORD pdwDataLen; // [rsp+80h] [rbp-49h] BYREF</span><br><span class="line">  HCRYPTKEY phKey; // [rsp+88h] [rbp-41h] BYREF</span><br><span class="line">  CHAR LibFileName[4]; // [rsp+90h] [rbp-39h] BYREF</span><br><span class="line">  int v76; // [rsp+94h] [rbp-35h]</span><br><span class="line">  int v77; // [rsp+98h] [rbp-31h]</span><br><span class="line">  int v78[4]; // [rsp+A0h] [rbp-29h] BYREF</span><br><span class="line">  __int16 v79; // [rsp+B0h] [rbp-19h]</span><br><span class="line">  CHAR MultiByteStr[4]; // [rsp+B8h] [rbp-11h] BYREF</span><br><span class="line">  _DWORD v81[7]; // [rsp+BCh] [rbp-Dh]</span><br><span class="line">  char v82; // [rsp+D8h] [rbp+Fh]</span><br><span class="line"></span><br><span class="line">  v79 = 136;</span><br><span class="line">  *(_DWORD *)LibFileName = 0xEAE5E7EB;</span><br><span class="line">  v76 = 2800614377;</span><br><span class="line">  v77 = 2296702188;</span><br><span class="line">  v78[0] = 15270122;</span><br><span class="line">  v78[1] = 15794410;</span><br><span class="line">  v78[2] = 15401126;</span><br><span class="line">  v78[3] = 15007975;</span><br><span class="line">  sub_1800066A0((__int64)v78);</span><br><span class="line">  sub_1800066F0((__int64)LibFileName);</span><br><span class="line">  v4 = 0i64;</span><br><span class="line">  v5 = LoadLibraryA(LibFileName);               // combase.dll</span><br><span class="line">  v6 = 0i64;</span><br><span class="line">  v7 = (_DWORD *)((char *)v5 + *(unsigned int *)((char *)v5 + *((int *)v5 + 15) + 136));</span><br><span class="line">  v68 = (char *)v5 + (unsigned int)v7[7];</span><br><span class="line">  v8 = (char *)v5 + (unsigned int)v7[8];</span><br><span class="line">  v67 = (char *)v5 + (unsigned int)v7[9];</span><br><span class="line">  if ( v7[5] )</span><br><span class="line">  &#123;</span><br><span class="line">    while ( 1 )</span><br><span class="line">    &#123;</span><br><span class="line">      v9 = (char *)v5 + *(unsigned int *)&amp;v8[4 * v6];</span><br><span class="line">      if ( v9 )</span><br><span class="line">      &#123;</span><br><span class="line">        v10 = strnlen(v9, 0x32ui64);</span><br><span class="line">        v11 = 0i64;</span><br><span class="line">        v12 = 53;</span><br><span class="line">        if ( v10 )</span><br><span class="line">        &#123;</span><br><span class="line">          do</span><br><span class="line">          &#123;</span><br><span class="line">            v13 = v9[v11++];</span><br><span class="line">            v12 += (1131796 * v12 + v13) &amp; 0xFFFFFF;</span><br><span class="line">          &#125;</span><br><span class="line">          while ( v11 &lt; v10 );</span><br><span class="line">          if ( v12 == 137055457 )</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      v6 = (unsigned int)(v6 + 1);</span><br><span class="line">      if ( (unsigned int)v6 &gt;= v7[5] )</span><br><span class="line">        goto LABEL_9;</span><br><span class="line">    &#125;</span><br><span class="line">    v4 = (void (__fastcall *)(int *, BYTE *))((char *)v5 + *(unsigned int *)&amp;v68[4 * *(unsigned __int16 *)&amp;v67[2 * v6]]);</span><br><span class="line">  &#125;</span><br><span class="line">LABEL_9:</span><br><span class="line">  v4(v78, pbData);</span><br><span class="line">  WideCharToMultiByte(0, 0, plaintext, 32, MultiByteStr, 32, 0i64, 0i64);</span><br><span class="line">  v14 = 0i64;</span><br><span class="line">  v82 = 0;</span><br><span class="line">  do</span><br><span class="line">  &#123;</span><br><span class="line">    v15 = *(_DWORD *)&amp;MultiByteStr[8 * v14];</span><br><span class="line">    v16 = 0;</span><br><span class="line">    v17 = v81[2 * v14];</span><br><span class="line">    v18 = 0;</span><br><span class="line">    v19 = 2i64;</span><br><span class="line">    do</span><br><span class="line">    &#123;</span><br><span class="line">      v20 = v16 + *(_DWORD *)&amp;pbData[4 * (v18 &amp; 3)];</span><br><span class="line">      v21 = v16 + 1131796;</span><br><span class="line">      v22 = (v20 ^ (v17 + ((16 * v17) ^ (v17 &gt;&gt; 5)))) + v15;</span><br><span class="line">      v23 = ((v21 + *(_DWORD *)&amp;pbData[4 * ((v21 &gt;&gt; 11) &amp; 3)]) ^ (v22 + ((16 * v22) ^ (v22 &gt;&gt; 5)))) + v17;</span><br><span class="line">      v24 = (v21 + *(_DWORD *)&amp;pbData[4 * (v21 &amp; 3)]) ^ (v23 + ((16 * v23) ^ (v23 &gt;&gt; 5)));</span><br><span class="line">      v21 += 1131796;</span><br><span class="line">      v25 = v24 + v22;</span><br><span class="line">      v26 = ((v21 + *(_DWORD *)&amp;pbData[4 * ((v21 &gt;&gt; 11) &amp; 3)]) ^ (v25 + ((16 * v25) ^ (v25 &gt;&gt; 5)))) + v23;</span><br><span class="line">      v27 = (v21 + *(_DWORD *)&amp;pbData[4 * (v21 &amp; 3)]) ^ (v26 + ((16 * v26) ^ (v26 &gt;&gt; 5)));</span><br><span class="line">      v21 += 1131796;</span><br><span class="line">      v28 = v27 + v25;</span><br><span class="line">      v29 = ((v21 + *(_DWORD *)&amp;pbData[4 * ((v21 &gt;&gt; 11) &amp; 3)]) ^ (v28 + ((16 * v28) ^ (v28 &gt;&gt; 5)))) + v26;</span><br><span class="line">      v30 = v21 + *(_DWORD *)&amp;pbData[4 * (v21 &amp; 3)];</span><br><span class="line">      v21 += 1131796;</span><br><span class="line">      v31 = (v30 ^ (v29 + ((16 * v29) ^ (v29 &gt;&gt; 5)))) + v28;</span><br><span class="line">      v32 = ((v21 + *(_DWORD *)&amp;pbData[4 * ((v21 &gt;&gt; 11) &amp; 3)]) ^ (v31 + ((16 * v31) ^ (v31 &gt;&gt; 5)))) + v29;</span><br><span class="line">      v33 = (v21 + *(_DWORD *)&amp;pbData[4 * (v21 &amp; 3)]) ^ (v32 + ((16 * v32) ^ (v32 &gt;&gt; 5)));</span><br><span class="line">      v21 += 1131796;</span><br><span class="line">      v34 = v33 + v31;</span><br><span class="line">      v35 = ((v21 + *(_DWORD *)&amp;pbData[4 * ((v21 &gt;&gt; 11) &amp; 3)]) ^ (v34 + ((16 * v34) ^ (v34 &gt;&gt; 5)))) + v32;</span><br><span class="line">      v36 = (v21 + *(_DWORD *)&amp;pbData[4 * (v21 &amp; 3)]) ^ (v35 + ((16 * v35) ^ (v35 &gt;&gt; 5)));</span><br><span class="line">      v21 += 1131796;</span><br><span class="line">      v37 = v36 + v34;</span><br><span class="line">      v38 = ((v21 + *(_DWORD *)&amp;pbData[4 * ((v21 &gt;&gt; 11) &amp; 3)]) ^ (v37 + ((16 * v37) ^ (v37 &gt;&gt; 5)))) + v35;</span><br><span class="line">      v39 = v21 + *(_DWORD *)&amp;pbData[4 * (v21 &amp; 3)];</span><br><span class="line">      v21 += 1131796;</span><br><span class="line">      v40 = (v39 ^ (v38 + ((16 * v38) ^ (v38 &gt;&gt; 5)))) + v37;</span><br><span class="line">      v41 = ((v21 + *(_DWORD *)&amp;pbData[4 * ((v21 &gt;&gt; 11) &amp; 3)]) ^ (v40 + ((16 * v40) ^ (v40 &gt;&gt; 5)))) + v38;</span><br><span class="line">      v42 = (v21 + *(_DWORD *)&amp;pbData[4 * (v21 &amp; 3)]) ^ (v41 + ((16 * v41) ^ (v41 &gt;&gt; 5)));</span><br><span class="line">      v21 += 1131796;</span><br><span class="line">      v43 = v42 + v40;</span><br><span class="line">      v44 = ((v21 + *(_DWORD *)&amp;pbData[4 * ((v21 &gt;&gt; 11) &amp; 3)]) ^ (v43 + ((16 * v43) ^ (v43 &gt;&gt; 5)))) + v41;</span><br><span class="line">      v45 = (v21 + *(_DWORD *)&amp;pbData[4 * (v21 &amp; 3)]) ^ (v44 + ((16 * v44) ^ (v44 &gt;&gt; 5)));</span><br><span class="line">      v21 += 1131796;</span><br><span class="line">      v46 = v45 + v43;</span><br><span class="line">      v47 = ((v21 + *(_DWORD *)&amp;pbData[4 * ((v21 &gt;&gt; 11) &amp; 3)]) ^ (v46 + ((16 * v46) ^ (v46 &gt;&gt; 5)))) + v44;</span><br><span class="line">      v48 = (v21 + *(_DWORD *)&amp;pbData[4 * (v21 &amp; 3)]) ^ (v47 + ((16 * v47) ^ (v47 &gt;&gt; 5)));</span><br><span class="line">      v21 += 1131796;</span><br><span class="line">      v49 = v48 + v46;</span><br><span class="line">      v50 = ((v21 + *(_DWORD *)&amp;pbData[4 * ((v21 &gt;&gt; 11) &amp; 3)]) ^ (v49 + ((16 * v49) ^ (v49 &gt;&gt; 5)))) + v47;</span><br><span class="line">      v51 = (v21 + *(_DWORD *)&amp;pbData[4 * (v21 &amp; 3)]) ^ (v50 + ((16 * v50) ^ (v50 &gt;&gt; 5)));</span><br><span class="line">      v21 += 1131796;</span><br><span class="line">      v52 = v51 + v49;</span><br><span class="line">      v53 = ((v21 + *(_DWORD *)&amp;pbData[4 * ((v21 &gt;&gt; 11) &amp; 3)]) ^ (v52 + ((16 * v52) ^ (v52 &gt;&gt; 5)))) + v50;</span><br><span class="line">      v54 = (v21 + *(_DWORD *)&amp;pbData[4 * (v21 &amp; 3)]) ^ (v53 + ((16 * v53) ^ (v53 &gt;&gt; 5)));</span><br><span class="line">      v21 += 1131796;</span><br><span class="line">      v55 = v54 + v52;</span><br><span class="line">      v56 = ((v21 + *(_DWORD *)&amp;pbData[4 * ((v21 &gt;&gt; 11) &amp; 3)]) ^ (v55 + ((16 * v55) ^ (v55 &gt;&gt; 5)))) + v53;</span><br><span class="line">      v57 = ((v21 + *(_DWORD *)&amp;pbData[4 * (v21 &amp; 3)]) ^ (v56 + ((16 * v56) ^ (v56 &gt;&gt; 5)))) + v55;</span><br><span class="line">      v21 += 1131796;</span><br><span class="line">      v58 = ((v21 + *(_DWORD *)&amp;pbData[4 * ((v21 &gt;&gt; 11) &amp; 3)]) ^ (v57 + ((16 * v57) ^ (v57 &gt;&gt; 5)))) + v56;</span><br><span class="line">      v59 = (v21 + *(_DWORD *)&amp;pbData[4 * (v21 &amp; 3)]) ^ (v58 + ((16 * v58) ^ (v58 &gt;&gt; 5)));</span><br><span class="line">      v21 += 1131796;</span><br><span class="line">      v60 = v59 + v57;</span><br><span class="line">      v61 = ((v21 + *(_DWORD *)&amp;pbData[4 * ((v21 &gt;&gt; 11) &amp; 3)]) ^ (v60 + ((16 * v60) ^ (v60 &gt;&gt; 5)))) + v58;</span><br><span class="line">      v62 = (v21 + *(_DWORD *)&amp;pbData[4 * (v21 &amp; 3)]) ^ (v61 + ((16 * v61) ^ (v61 &gt;&gt; 5)));</span><br><span class="line">      v21 += 1131796;</span><br><span class="line">      v63 = v62 + v60;</span><br><span class="line">      v64 = ((v21 + *(_DWORD *)&amp;pbData[4 * ((v21 &gt;&gt; 11) &amp; 3)]) ^ (v63 + ((16 * v63) ^ (v63 &gt;&gt; 5)))) + v61;</span><br><span class="line">      v65 = (v21 + *(_DWORD *)&amp;pbData[4 * (v21 &amp; 3)]) ^ (v64 + ((16 * v64) ^ (v64 &gt;&gt; 5)));</span><br><span class="line">      v16 = v21 + 1131796;</span><br><span class="line">      v15 = v65 + v63;</span><br><span class="line">      v18 = v16;</span><br><span class="line">      v17 = ((v16 + *(_DWORD *)&amp;pbData[4 * ((v16 &gt;&gt; 11) &amp; 3)]) ^ (v15 + ((16 * v15) ^ (v15 &gt;&gt; 5)))) + v64;</span><br><span class="line">      --v19;</span><br><span class="line">    &#125;</span><br><span class="line">    while ( v19 );</span><br><span class="line">    *(_DWORD *)&amp;MultiByteStr[8 * v14] = v15;</span><br><span class="line">    v81[2 * v14++] = v17;</span><br><span class="line">  &#125;</span><br><span class="line">  while ( v14 &lt; 4 );</span><br><span class="line">  pdwDataLen = 32;</span><br><span class="line">  phProv = 0i64;</span><br><span class="line">  phHash = 0i64;</span><br><span class="line">  phKey = 0i64;</span><br><span class="line">  if ( CryptAcquireContextA(&amp;phProv, 0i64, 0i64, 0x18u, 0xF0000000)</span><br><span class="line">    &amp;&amp; CryptCreateHash(phProv, 0x8003u, 0i64, 0, &amp;phHash)</span><br><span class="line">    &amp;&amp; CryptHashData(phHash, pbData, 0x10u, 0)</span><br><span class="line">    &amp;&amp; CryptDeriveKey(phProv, 0x660Eu, phHash, 1u, &amp;phKey) )</span><br><span class="line">  &#123;</span><br><span class="line">    CryptEncrypt(phKey, 0i64, 0, 0, (BYTE *)MultiByteStr, &amp;pdwDataLen, 0x20u);</span><br><span class="line">  &#125;</span><br><span class="line">  if ( phKey )</span><br><span class="line">    CryptDestroyKey(phKey);</span><br><span class="line">  if ( phHash )</span><br><span class="line">    CryptDestroyHash(phHash);</span><br><span class="line">  if ( phProv )</span><br><span class="line">    CryptReleaseContext(phProv, 0);</span><br><span class="line">  *cipher = SysAllocStringByteLen(MultiByteStr, 0x21u);</span><br><span class="line">  return 0i64;</span><br><span class="line">&#125;</span><br><span class="line">/*</span><br><span class="line">pbdata =</span><br><span class="line">&#123;</span><br><span class="line">  0xEA, 0x3E, 0xD4, 0x1C, 0x70, 0xCB, 0xD7, 0x47, 0x98, 0x5E, </span><br><span class="line">  0xCA, 0xDB, 0x53, 0x0C, 0x39, 0x2B</span><br><span class="line">&#125;;</span><br><span class="line">*/</span><br></pre></td></tr></table></figure>
<p>可以看到是TEA+AES的加密，逆向解密即可获取flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;stdio.h&gt;</span><br><span class="line">#include&lt;stdlib.h&gt;</span><br><span class="line">#include&lt;time.h&gt;</span><br><span class="line">#include &lt;windows.h&gt;</span><br><span class="line">#include &lt;windef.h&gt;</span><br><span class="line">#include&lt;wincrypt.h&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DWORD decryptData(BYTE* encryptedData, DWORD dataSize, const BYTE* pbData) &#123;</span><br><span class="line">    HCRYPTPROV phProv = 0;</span><br><span class="line">    HCRYPTHASH phHash = 0;</span><br><span class="line">    HCRYPTKEY phKey = 0;</span><br><span class="line">    DWORD decryptedSize = 32;</span><br><span class="line"></span><br><span class="line">    // Acquire cryptographic context</span><br><span class="line">    if (CryptAcquireContextA(&amp;phProv, 0, 0, 0x18, 0xF0000000)) &#123;</span><br><span class="line">        // Create hash object</span><br><span class="line">        if (CryptCreateHash(phProv, 0x8003, 0, 0, &amp;phHash)) &#123;</span><br><span class="line">            // Hash the original data</span><br><span class="line">            if (CryptHashData(phHash, pbData, 0x10, 0)) &#123;</span><br><span class="line">                // Derive key from the hash</span><br><span class="line">                if (CryptDeriveKey(phProv, 0x660Eu, phHash, 1, &amp;phKey)) &#123;</span><br><span class="line">                    // Decrypt the data</span><br><span class="line">                    if (CryptDecrypt(phKey, 0, 0, 0, (BYTE*)encryptedData, &amp;decryptedSize)) &#123;</span><br><span class="line">                        // Clean up resources</span><br><span class="line">                        if (phKey)</span><br><span class="line">                            CryptDestroyKey(phKey);</span><br><span class="line">                        if (phHash)</span><br><span class="line">                            CryptDestroyHash(phHash);</span><br><span class="line">                        if (phProv)</span><br><span class="line">                            CryptReleaseContext(phProv, 0);</span><br><span class="line"></span><br><span class="line">                        return decryptedSize;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    // Error occurred, clean up resources</span><br><span class="line">    if (phKey)</span><br><span class="line">        CryptDestroyKey(phKey);</span><br><span class="line">    if (phHash)</span><br><span class="line">        CryptDestroyHash(phHash);</span><br><span class="line">    if (phProv)</span><br><span class="line">        CryptReleaseContext(phProv, 0);</span><br><span class="line"></span><br><span class="line">    return 0; // Decryption failed</span><br><span class="line">&#125;</span><br><span class="line">/*</span><br><span class="line">void encipher() &#123;</span><br><span class="line">v22 = (ini_sum + *(_DWORD *)&amp;pbData[4 * (ini_sum2 &amp; 3)]; ^ (next + ((16 * next) ^ (next &gt;&gt; 5)))) + prv;</span><br><span class="line">sum = ini_sum + 1131796;</span><br><span class="line">v23 = ((sum + *(_DWORD *)&amp;pbData[4 * ((sum &gt;&gt; 11) &amp; 3)]) ^ (v22 + ((16 * v22) ^ (v22 &gt;&gt; 5)))) + next;</span><br><span class="line">&#125;</span><br><span class="line">*/</span><br><span class="line">void decipher(unsigned int cipher[], unsigned int pbData[]) &#123;</span><br><span class="line">    int i, j;</span><br><span class="line">    unsigned int delta = 1131796, sum, v0, v1;</span><br><span class="line">    </span><br><span class="line">    for (i = 3; i &gt;=0 ; i--) &#123;</span><br><span class="line">        sum = delta * 32;</span><br><span class="line">        v0 = cipher[2*i];</span><br><span class="line">        v1 = cipher[2*i+1];</span><br><span class="line">        for (j = 31; j &gt;= 0; j--) &#123;</span><br><span class="line">            v1 -= ((sum + pbData[ ((sum &gt;&gt; 11) &amp; 3)]) ^ (v0 + ((16 * v0) ^ (v0 &gt;&gt; 5))));</span><br><span class="line">            sum -= delta;</span><br><span class="line">            v0 -= (sum + pbData[ (sum &amp; 3)] ^ (v1 + ((16 * v1) ^ (v1 &gt;&gt; 5))));</span><br><span class="line">        &#125;</span><br><span class="line">        cipher[2 * i + 1] = v1;</span><br><span class="line">        cipher[2 * i] = v0;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main() &#123;</span><br><span class="line">    int i;</span><br><span class="line">    //BYTE cipher[32] = &#123; 0xb,0xaf,0x51,0x21,0x9c,0x52,0x10,0x89,0x3f,0x2c,0x34,0x30,0x87,0x13,0xc1,0x4c,0xc1,0x7f,0x81,0x6e,0xba,0xbd,0xdf,0x43,0x1a,0xf0,0xd7,0xde,0x8e,0x66,0xb9,0x7c &#125;;</span><br><span class="line">    unsigned int cipher[8] = &#123; 0x2151AF0B , 0x8910529C , 0x30342C3F , 0x4CC11387 , 0x6E817FC1 , 0x43DFBDBA , 0xDED7F01A , 0x7CB9668E &#125;;</span><br><span class="line">    unsigned int pbdata[4] = &#123;0x1CD43EEA , 0x47D7CB70 , 0x0DBCA5E98 , 0x2B390C53&#125;;</span><br><span class="line">    /*const BYTE pbdata[16] =</span><br><span class="line">    &#123;</span><br><span class="line">      0xEA, 0x3E, 0xD4, 0x1C, 0x70, 0xCB, 0xD7, 0x47, 0x98, 0x5E,</span><br><span class="line">      0xCA, 0xDB, 0x53, 0x0C, 0x39, 0x2B</span><br><span class="line">    &#125;;*/</span><br><span class="line">    decryptData((BYTE*)cipher, 32, (BYTE*)pbdata);</span><br><span class="line">    for (i = 0; i &lt; 8; i++) &#123;</span><br><span class="line">        printf(&quot;%x &quot;, cipher[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    printf(&quot;\n&quot;);</span><br><span class="line">    decipher((unsigned int *)cipher, pbdata);</span><br><span class="line">    BYTE* cipher_ = (BYTE*)cipher;</span><br><span class="line">    for (i = 0; i &lt; 32; i++) &#123;</span><br><span class="line">        printf(&quot;%c&quot;, cipher_[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</div><div class="index-category-tag">  <hr></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2024-01-21  <a class="commentCountImg" href="/2024/01/21/%E9%99%87%E5%89%91%E6%9D%AF%202023%20Writeup/#comment-container"><span class="display-none-class">d41d8cd98f00b204e9800998ecf8427e</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="d41d8cd98f00b204e9800998ecf8427e">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>4 m  <i class="fas fa-pencil-alt"> </i>0.5 k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/01/21/%E9%99%87%E5%89%91%E6%9D%AF%202023%20Writeup/"> </a></h1><div class="content"><h1 id="陇剑杯-2023-Writeup"><a href="#陇剑杯-2023-Writeup" class="headerlink" title="陇剑杯 2023 Writeup"></a>陇剑杯 2023 Writeup</h1></div><div class="index-category-tag">  <hr></div><div class="level is-mobile is-flex"><div class="level-start"><div class="level-item"><a class="article-more button is-small size-small" href="/2024/01/21/%E9%99%87%E5%89%91%E6%9D%AF%202023%20Writeup/#more">Read more&gt;&gt;</a></div></div></div></article></div><!--!--><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2024-01-21  <a class="commentCountImg" href="/2024/01/21/%E6%A8%A1%E7%B3%8A%E6%B5%8B%E8%AF%95%E6%8A%80%E6%9C%AF%E7%BB%BC%E8%BF%B0/#comment-container"><span class="display-none-class">d41d8cd98f00b204e9800998ecf8427e</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="d41d8cd98f00b204e9800998ecf8427e">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>21 m  <i class="fas fa-pencil-alt"> </i>3.2 k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/01/21/%E6%A8%A1%E7%B3%8A%E6%B5%8B%E8%AF%95%E6%8A%80%E6%9C%AF%E7%BB%BC%E8%BF%B0/"> </a></h1><div class="content"><h1 id="模糊测试技术综述-仁泽众等"><a href="#模糊测试技术综述-仁泽众等" class="headerlink" title="模糊测试技术综述_仁泽众等"></a>模糊测试技术综述_仁泽众等</h1><p><strong>模糊测试技术</strong>是漏洞检测技术的一种，通过使用针对目标程序生成的随机字符流，队目标程序进行多次测试，以检测可能存在的漏洞</p></div><div class="index-category-tag">  <hr></div><div class="level is-mobile is-flex"><div class="level-start"><div class="level-item"><a class="article-more button is-small size-small" href="/2024/01/21/%E6%A8%A1%E7%B3%8A%E6%B5%8B%E8%AF%95%E6%8A%80%E6%9C%AF%E7%BB%BC%E8%BF%B0/#more">Read more&gt;&gt;</a></div></div></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2024-01-21  <a class="commentCountImg" href="/2024/01/21/Universal%20Fuzzing%20via%20Large%20Language%20Models/#comment-container"><span class="display-none-class">d41d8cd98f00b204e9800998ecf8427e</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="d41d8cd98f00b204e9800998ecf8427e">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>an hour  <i class="fas fa-pencil-alt"> </i>7.5 k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/01/21/Universal%20Fuzzing%20via%20Large%20Language%20Models/"> </a></h1><div class="content"><h1 id="Universal-Fuzzing-via-Large-Language-Models"><a href="#Universal-Fuzzing-via-Large-Language-Models" class="headerlink" title="Universal Fuzzing via Large Language Models"></a>Universal Fuzzing via Large Language Models</h1><p><a target="_blank" rel="noopener" href="https://fuzz4all.github.io/">Universal Fuzzing via Large Language Models (fuzz4all.github.io)</a></p>
<p><strong>Abstract: </strong>介绍Fuzz4ALL——通用模糊器，可以针对多种不同的输入语言和这些语言的多种不同特征进行测试，利用大型语言模型（LLM）作为输入生成和突变引擎。提出了一种新颖的自动提示技术，用于创建适合模糊测试的LLM提示，和一种由LLM驱动的模糊测试循环，用于迭代更新提示来创建新的模糊测试输入。</p></div><div class="index-category-tag">  <hr></div><div class="level is-mobile is-flex"><div class="level-start"><div class="level-item"><a class="article-more button is-small size-small" href="/2024/01/21/Universal%20Fuzzing%20via%20Large%20Language%20Models/#more">Read more&gt;&gt;</a></div></div></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2024-01-21  <a class="commentCountImg" href="/2024/01/21/Skyfire%20Data-Driven%20Seed%20Generation%20for%20Fuzzing/#comment-container"><span class="display-none-class">d41d8cd98f00b204e9800998ecf8427e</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="d41d8cd98f00b204e9800998ecf8427e">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>an hour  <i class="fas fa-pencil-alt"> </i>8.8 k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/01/21/Skyfire%20Data-Driven%20Seed%20Generation%20for%20Fuzzing/"> </a></h1><div class="content"><h1 id="Skyfire-Data-Driven-Seed-Generation-for-Fuzzing"><a href="#Skyfire-Data-Driven-Seed-Generation-for-Fuzzing" class="headerlink" title="Skyfire: Data-Driven Seed Generation for Fuzzing"></a>Skyfire: Data-Driven Seed Generation for Fuzzing</h1></div><div class="index-category-tag">  <hr></div><div class="level is-mobile is-flex"><div class="level-start"><div class="level-item"><a class="article-more button is-small size-small" href="/2024/01/21/Skyfire%20Data-Driven%20Seed%20Generation%20for%20Fuzzing/#more">Read more&gt;&gt;</a></div></div></div></article></div><!--!--><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2024-01-21  <a class="commentCountImg" href="/2024/01/21/Path%20sensitive%20fuzzing%20for%20Native%20Application/#comment-container"><span class="display-none-class">d41d8cd98f00b204e9800998ecf8427e</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="d41d8cd98f00b204e9800998ecf8427e">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>36 m  <i class="fas fa-pencil-alt"> </i>5.3 k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/01/21/Path%20sensitive%20fuzzing%20for%20Native%20Application/"> </a></h1><div class="content"><h1 id="Path-sensitive-fuzzing-for-Native-Application"><a href="#Path-sensitive-fuzzing-for-Native-Application" class="headerlink" title="Path sensitive fuzzing for Native Application"></a>Path sensitive fuzzing for Native Application</h1><h2 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1 Introduction"></a>1 Introduction</h2><p>代码覆盖率对于覆盖引导的模糊器至关重要</p>
<p>由于高额的开销使得跟踪路径覆盖不可行</p>
<h3 id="1-1-覆盖不精确如何影响漏洞发现"><a href="#1-1-覆盖不精确如何影响漏洞发现" class="headerlink" title="1.1 覆盖不精确如何影响漏洞发现"></a>1.1 覆盖不精确如何影响漏洞发现</h3><ol>
<li>覆盖不精确可能会导致测试器没有能够区分两条不同的路径。如果一个测试用例探索到了一条新路径，但他与之前已探索过的路径碰撞了，测试器则会认为这条新路径不那么重要</li>
<li>覆盖不精确会影响测试策略。它影响力测试器选择最优的种子进行测试</li>
</ol>
<h3 id="1-2-如何提高覆盖精确度并引导测试器"><a href="#1-2-如何提高覆盖精确度并引导测试器" class="headerlink" title="1.2 如何提高覆盖精确度并引导测试器"></a>1.2 如何提高覆盖精确度并引导测试器</h3><p>跟踪边缘和块覆盖是可能的</p>
<p>AFL的覆盖跟踪有着更低的时间开销</p>
<p>由于哈希冲突问题，AFL的边缘覆盖是不完美的。对该问题的解决措施是扩大AFL用于存储覆盖的比特图的大小</p>
<p>CollAFL解决了AFL的哈希碰撞问题并提高了覆盖精确度，还提出了三个新的测试策略，来驱动测试器发现未探索的道路，并提高发现漏洞的效率</p>
<p>CollAFL通过确认每条路径有一个特定的Hash，所以AFL能区分每一条路径</p>
<h3 id="1-3-如何将建议的解决方案应用于二进制应用程序？"><a href="#1-3-如何将建议的解决方案应用于二进制应用程序？" class="headerlink" title="1.3 如何将建议的解决方案应用于二进制应用程序？"></a>1.3 如何将建议的解决方案应用于二进制应用程序？</h3><p>使用静态二进制检查(static binary instrumentation(SBI))来将解决方案应用到二进制程序中。对于每一个二进制程序，fuzzer会反汇编该程序，恢复其控制流图，并使用建议的覆盖跟踪方案对应用程序进行检测</p>
<h3 id="1-4-覆盖敏感的测试器表现如何"><a href="#1-4-覆盖敏感的测试器表现如何" class="headerlink" title="1.4 覆盖敏感的测试器表现如何"></a>1.4 覆盖敏感的测试器表现如何</h3><img src="/2024/01/21/Path%20sensitive%20fuzzing%20for%20Native%20Application/image-20230105215701827.png" class title="image-20230105215701827">
<p>测试结果</p>
<ul>
<li>在真实应用中哈希碰撞问题很普遍，75%边界会与其他产生冲突</li>
<li>论文中所提出的碰撞减轻方案可以解决所有已知边界的哈希碰撞，并能够帮助测试器探索9.9%多的代码，250%多独特的冲突和140%多的安全漏洞</li>
<li>在碰撞减轻方案和未接触分支指向种子选择的联合作用下，探索多了20%的代码，320%多的冲突，260%多的安全漏洞</li>
</ul>
<p>总结：</p>
<ul>
<li>哈希碰撞问题严重影响了AFL的效率，覆盖不精确的问题降低了覆盖引导的fuzzer的效率</li>
<li>设计了一套算法来解决AFL中的哈希碰撞问题，低开销情况下提高了边覆盖精确度</li>
<li>提出了三个覆盖敏感的种子选择策略。经验表明基于精确的边覆盖信息来权衡种子选择能提高fuzzer的表现</li>
<li>提供了CollAFL的两个变种，能够在提供或不提供源码的情况下测试程序</li>
</ul>
<h2 id="2-Background-And-Related-Work"><a href="#2-Background-And-Related-Work" class="headerlink" title="2 Background And Related Work"></a>2 Background And Related Work</h2><h3 id="2-1Fuzzing"><a href="#2-1Fuzzing" class="headerlink" title="2.1Fuzzing"></a>2.1Fuzzing</h3><h3 id="2-2Coverage-Guided-Fuzzing"><a href="#2-2Coverage-Guided-Fuzzing" class="headerlink" title="2.2Coverage Guided Fuzzing"></a>2.2Coverage Guided Fuzzing</h3><p>进化算法</p>
<p>最先进的覆盖导向fuzzer：AFL、libFuzzer、VUzzer</p>
<img src="/2024/01/21/Path%20sensitive%20fuzzing%20for%20Native%20Application/image-20230109003758238.png" class title="image-20230109003758238">
<h3 id="2-3-Coverage-Tracking"><a href="#2-3-Coverage-Tracking" class="headerlink" title="2.3 Coverage Tracking"></a>2.3 Coverage Tracking</h3><p>覆盖导向的fuzzers跟踪不同层次的代码覆盖。</p>
<p>LibFuzzer和honggfuzz利用Clang编译器提供的SanitizerOverage检测方法来跟踪块覆盖</p>
<p>AFL使用静态/动态分析来跟踪边覆盖</p>
<p>Angora记录调用上下文并跟踪上下文敏感的边缘覆盖</p>
<p>块覆盖是最不敏感的<br>上下文敏感的边缘覆盖是最敏感的</p>
<p>给定边缘覆盖率，很容易去推导块覆盖率。然而几乎不可能从块覆盖率去推导边覆盖率</p>
<img src="/2024/01/21/Path%20sensitive%20fuzzing%20for%20Native%20Application/image-20230109011226897.png" class title="image-20230109011226897">
<p>图中无关键路径，P1和P2走了完全不同的路径，块覆盖一致而路径覆盖不一致</p>
<p>尽管上下文敏感的边缘覆盖可以帮助识别更多的路径，但带来了许多负面的效果</p>
<ul>
<li>由于不同的调用上下文，不同路径的相同边会分配不同的哈希，使边和位图之间的映射不确定。因此fuzzer很难获得每个边的全局覆盖状态，因此具有较低的控制流灵敏度。为了解决这个问题，Angora分配了额外的共享内存来记录边映射。</li>
<li>提供上下文敏感边缘覆盖的解决方案将为队列引入许多无用的路径，因此将浪费计算资源并削弱新边缘的发现</li>
</ul>
<h4 id="2-3-1哈希碰撞问题"><a href="#2-3-1哈希碰撞问题" class="headerlink" title="2.3.1哈希碰撞问题"></a>2.3.1哈希碰撞问题</h4><p>AFL使用位图（默认大小64KB）来跟踪应用的边覆盖。每一个位图的字节代表了特定边的统计数据。每个边的Hash作为位图的键值。因此可能会有哈希碰撞的问题，即两个两条边共享一个哈希值，使得fuzzer不能区分这些边，导致覆盖的不精确</p>
<p>AFL为目标程序的基本块分配随机键值，例如边A-&gt;B，AFL以如下方式计算器Hash</p>
<script type="math/tex; mode=display">
cur\oplus(prev>>1)</script><p>其中prev和cur是基本块A和B的键值。由于生日攻击，哈希碰撞的比例非常高</p>
<p>实验表明，由于哈希碰撞，在真实应用测试中高达75%的边对于AFL是不可见的</p>
<h3 id="2-4-种子选择策略"><a href="#2-4-种子选择策略" class="headerlink" title="2.4 种子选择策略"></a>2.4 种子选择策略</h3><p>AFL倾向于更小和执行速度更快的种子</p>
<p>VUzzer倾向于能探索更深路径的种子</p>
<p>AFLfast倾向于探索频率较低的和更少被选择的种子</p>
<p>考虑到代码覆盖信息并不精确，这会使得fuzzer在筛选种子时不能做出最优选择。例如冷热路径的选择</p>
<h3 id="2-5-论文的关注点"><a href="#2-5-论文的关注点" class="headerlink" title="2.5 论文的关注点"></a>2.5 论文的关注点</h3><p>提出了CollAFL，覆盖敏感的fuzz解决方案。它提高了代码覆盖跟踪的精度，并利用精确覆盖的信息来指引fuzzer。而且，我们评估了将此解决方案应用于闭源应用程序的可行性</p>
<h2 id="3-Imporve-Coverage-Accuracy"><a href="#3-Imporve-Coverage-Accuracy" class="headerlink" title="3 Imporve Coverage Accuracy"></a>3 Imporve Coverage Accuracy</h2><h3 id="3-1-覆盖粒度"><a href="#3-1-覆盖粒度" class="headerlink" title="3.1 覆盖粒度"></a>3.1 覆盖粒度</h3><p>三种覆盖粒度：块覆盖、边覆盖、路径覆盖</p>
<p>典型的块覆盖方案会跟踪测试中每个块的击中次数。然而它不跟踪块的顺序，导致了覆盖信息的损失</p>
<p>典型的边覆盖跟踪每条边的击中次数，然而它同样不跟踪边的次序，同样导致了信息的损失。</p>
<p>路径覆盖方案会跟踪边的顺序，提供最完整的代码覆盖信息。然而代码路径非常长，且数量庞大，时间与空间开销难以承受，实际上不可行。一种优化方法是上下文敏感的边覆盖，能够跟踪部分函数调用顺序。这种方法有较高的性能开销和低效率。</p>
<p>边覆盖方案达到了性能的平衡。然而存在哈希碰撞的问题。CollAFL采用边覆盖跟踪策略解决了这一问题。</p>
<h3 id="3-2-哈希冲突的简单解决方案"><a href="#3-2-哈希冲突的简单解决方案" class="headerlink" title="3.2 哈希冲突的简单解决方案"></a>3.2 哈希冲突的简单解决方案</h3><p>直接解决方案是扩大哈希空间，即AFL中的位图大小，然而当前默认的位图大小(64KB)已经是一种性能上的折中</p>
<p>这种方法会带来性能上的大量损失。要减少5%的哈希碰撞，需要将位图大小从4KB扩大到4MB，导致60%执行速度上的损失。</p>
<h3 id="3-3-CollAFL的解决方案"><a href="#3-3-CollAFL的解决方案" class="headerlink" title="3.3 CollAFL的解决方案"></a>3.3 CollAFL的解决方案</h3><p>使用了一种新的哈希计算方式：</p>
<script type="math/tex; mode=display">
Fmul(cur,prev)=(cur>>x)\oplus(prev>>y)+z</script><p><x,y,z>是要确定的参数，对于不同的边可以不一样</x,y,z></p>
<p>如下图所示，对于每个末尾块，可以选择一系列参数</p>
<p>使用贪心算法逐个搜索每个块的参数</p>
<img src="/2024/01/21/Path%20sensitive%20fuzzing%20for%20Native%20Application/image-20230109141811234.png" class title="image-20230109141811234">
<p>这里还有些不明白）</p>
<h4 id="3-3-1-具有单一先例的块的哈希算法"><a href="#3-3-1-具有单一先例的块的哈希算法" class="headerlink" title="3.3.1 具有单一先例的块的哈希算法"></a>3.3.1 具有单一先例的块的哈希算法</h4><p>如果一个块只有一个先例，那么我们可以直接在末尾块给这条边分配一个哈希，而不是使用前面的计算公式进行计算。</p>
<p>因此，对于只有一个先例块A的块B，我们不需要寻找参数<x,y,z>，而可以使用下列的哈希算法</x,y,z></p>
<script type="math/tex; mode=display">
Fsingle(cur,prev):c</script><p>哈希值c硬编码于块B中。</p>
<p>实验表明，大部分应用超过60%的基础块只有一个先例块</p>
<h4 id="3-3-2具有多个先例的块的哈希算法"><a href="#3-3-2具有多个先例的块的哈希算法" class="headerlink" title="3.3.2具有多个先例的块的哈希算法"></a>3.3.2具有多个先例的块的哈希算法</h4><p>对于一个不可解的块B，我们引入另一个哈希算法来计算边A-&gt;B</p>
<script type="math/tex; mode=display">
Fhash(cur,prev):hash_table_lookup(cur,prev)</script><p>它构建了一个离线的Hash表，包含有所有以不可解的块为结尾的边的哈希。在运行时，他会查询这个预计算好的哈希表，使用他们的开始和结束块作为键来获取这些边的哈希。</p>
<p>Fhash是比Fmul和Fsingle慢很多的，因此要尽量限制不可解块的数量</p>
<p>至今还不明白的一个点：什么是solvable blocks，什么是unsolvable blocks）</p>
<p>使用贪心算法求解这些块的参数，将可解决的块标记为solvable blocks，其他即unsolvable</p>
<h4 id="3-3-3-整体优化方案"><a href="#3-3-3-整体优化方案" class="headerlink" title="3.3.3 整体优化方案"></a>3.3.3 整体优化方案</h4><img src="/2024/01/21/Path%20sensitive%20fuzzing%20for%20Native%20Application/image-20230109170043442.png" class title="image-20230109170043442">
<img src="/2024/01/21/Path%20sensitive%20fuzzing%20for%20Native%20Application/image-20230109164706446.png" class title="image-20230109164706446">
<p>预处理程序。依靠静态分析工具，我们首先得到基本块和目标程序的先例信息。如第一行所示，首先可以获取程序的基本块BBS(basic blocks)，并根据这个块是否有多个先例把它分为两组SingleBBs和MultiBBS。在第二行，他给程序中每个块分配了随机密钥。分配信息存储于Keys中。</p>
<p>确定块算法。如第四行所示，我们首先尝试使用CalcFmul为有多个先例的块寻找适当的参数，并获取可解块集Solv和不可解块集Unsol以及可解块的参数Params和边的哈希Hashes。在第五行，我们使用CalcFash为不可解块Unsol构建了哈希图HashMap，并获取了未被任何边所使用的哈希集合FressHashes</p>
<img src="/2024/01/21/Path%20sensitive%20fuzzing%20for%20Native%20Application/image-20230109174441209.png" class title="image-20230109174441209">
<p>算法2展示了CalcFmul的工作流，即，如何搜寻含多个先例的块的参数。</p>
<p>（不懂：为什么不在生成哈希的时候就保存参数，而是全部生成完再一个个保存参数？）</p>
<img src="/2024/01/21/Path%20sensitive%20fuzzing%20for%20Native%20Application/image-20230111155430656.png" class title="image-20230111155430656">
<p>算法3展示了如何给不可解块构建哈希表。给每条以不可解块结尾的边选择随机未使用过的哈希，并存储在哈希表HashMap中。</p>
<h3 id="3-4表现分析"><a href="#3-4表现分析" class="headerlink" title="3.4表现分析"></a>3.4表现分析</h3><p>开销方面：</p>
<script type="math/tex; mode=display">
cost(Fhash)>cost(Fmul)>cost(Fsingle)\approx0</script><p>使用次数</p>
<script type="math/tex; mode=display">
num(Fsingle)>num(Fmul)>num(Fhash)\approx0</script><p>总的来说：CollAFL使用的哈希计算带来的总体性能成本很小</p>
<h3 id="3-5-实现细节"><a href="#3-5-实现细节" class="headerlink" title="3.5 实现细节"></a>3.5 实现细节</h3><h4 id="3-5-1-CollAFL-for-Applications-With-Source-Code"><a href="#3-5-1-CollAFL-for-Applications-With-Source-Code" class="headerlink" title="3.5.1 CollAFL for Applications With Source Code"></a>3.5.1 CollAFL for Applications With Source Code</h4><p>CollAFL扩展了AFL的llvm模式，并写了Clang链路时间优化传递来</p>
<ol>
<li>获取所需的基本块和边信息</li>
<li>给每个块分配密钥</li>
<li>根据每个基本块的类型解析哈希计算算法</li>
<li>用哈希计算和覆盖跟踪代码检测每个块</li>
</ol>
<p>在第一步，使用CLang默认实施获取后例和先例信息，例如。通过API llvm::TerminatorInst::getSuccessor.然而，离线解决间接控制转移的目标是一个公开的挑战，这会影响我们所需的先例信息的准确性。例如，它可能错误地将一些基本块分类为单个（或没有）先例块。</p>
<p>因此采取两步来改良。第一，将不被任何人直接调用的函数的入口块标记为多先例块。另外，将间接调用指令展开为一组直接调用和一个间接调用指令，类似于去虚拟化技术。因此能够连接基本块在一起，减少单先例的块，能够更多地使用Fmul而不是Fsingle来去计算块的哈希，减少碰撞的可能性。</p>
<p>(不懂：为啥要减少单先例的块，单先例的算法开销不是更小吗？)</p>
<h4 id="3-5-2-CollAFL-Bin-for-Binary-Applications"><a href="#3-5-2-CollAFL-Bin-for-Binary-Applications" class="headerlink" title="3.5.2 CollAFL-Bin for Binary Applications"></a>3.5.2 CollAFL-Bin for Binary Applications</h4><p>选择使用静态二进制检测来应用到边碰撞减少策略。</p>
<p>CollAFL-bin的综合检测过程如下：第一，使用API openBinary来加载二进制程序，并调用API getImage来获取程序镜像。然后通过API getModules获取所有模块，通过API getProcedures识别初始执行模块并获取所有函数。第二，遍历每个函数的所有基本块后获得CFG。有了CFG，就如有源码的CollAFL执行，即在没有冲突的情况下搜索相关的哈希id，并为每个基本块搜索各自的实施模式。最后，为三种实施模式创建调用函数。</p>
<p>静态分析中还有许多问题，间接跳转指令导致的不准确的控制流图….</p>
<p>识别潜在简介跳转和简介调用的目标，并分配保留的空闲HashID给这些潜在边。另外，给这些非返回函数修复了潜在返回边</p>
<p>解决二进制重写的问题，添加标签层</p>
<h2 id="4-Prioritize-Seed-Selection"><a href="#4-Prioritize-Seed-Selection" class="headerlink" title="4 Prioritize Seed Selection"></a>4 Prioritize Seed Selection</h2><p>直接驱动fuzzer到未探索的道路</p>
<ul>
<li>如果一条道路上上有很多未探索的邻近分支，那么这条道路的变异很可能能探索这些未探索的分支</li>
<li>如果一条道路上上有很多未探索的邻近后代，那么这条道路的变异很可能能探索这些未探索的后代</li>
</ul>
<p>提升漏洞发现的效率</p>
<ul>
<li>如果一条道路上有许多内存存储操作，很有可能能够触发潜在的内存破坏漏洞，变异策略同样。</li>
</ul>
<p>基于这些策略，提出以下种子选择策略</p>
<h3 id="4-1-Untouched-Neighbour-Branch-Guided-Policy"><a href="#4-1-Untouched-Neighbour-Branch-Guided-Policy" class="headerlink" title="4.1 Untouched-Neighbour-Branch Guided Policy"></a>4.1 Untouched-Neighbour-Branch Guided Policy</h3><p>能够探索更多为探索过的邻近分支的种子将会被赋予更高的优先级。将该策略称为CollAFL-br</p>
<p>将未探索的邻近边的数量成为测试例T的权重，函数IsUntouched返回1当且仅当边<bb;bb_i>没有被之前任何测试例覆盖</bb;bb_i></p>
<img src="/2024/01/21/Path%20sensitive%20fuzzing%20for%20Native%20Application/image-20230114235220339.png" class title="image-20230114235220339">
<p>随着测试的进行，测试集也会发生变化，因此一个测试例的权重是动态的</p>
<h3 id="4-2-Untouched-Neighbour-Descendant-Guided-Policy"><a href="#4-2-Untouched-Neighbour-Descendant-Guided-Policy" class="headerlink" title="4.2 Untouched-Neighbour-Descendant Guided Policy"></a>4.2 Untouched-Neighbour-Descendant Guided Policy</h3><p>具有更多未探索的邻近后代会更有更高优先级，这种策略会具有更高优先级。这种策略称为CollAFL-desc</p>
<p>将未探索的邻近后代数量称为测试例T的权重</p>
<img src="/2024/01/21/Path%20sensitive%20fuzzing%20for%20Native%20Application/image-20230115001249624.png" class title="image-20230115001249624">
<p>IsUntouched与前面相同，NumDesc返回从函数基本块开始的子路径，其正式定义如下：</p>
<img src="/2024/01/21/Path%20sensitive%20fuzzing%20for%20Native%20Application/image-20230115001441249.png" class title="image-20230115001441249">
<p>基本块的子路径是确定的，可用静态分析计算</p>
<h3 id="4-3-Memory-Access-Guided-Policy"><a href="#4-3-Memory-Access-Guided-Policy" class="headerlink" title="4.3 Memory-Access Guided Policy"></a>4.3 Memory-Access Guided Policy</h3><p>记为CollAFL-mem，有更多内存读取操作的种子会具有更高优先级</p>
<p>将内存操作数量记为测试例T的权重：</p>
<img src="/2024/01/21/Path%20sensitive%20fuzzing%20for%20Native%20Application/image-20230115003225973.png" class title="image-20230115003225973">
<p>函数NumMemInstr返回基本块内的内存操作数</p>
<h3 id="4-4-Implementation-Details"><a href="#4-4-Implementation-Details" class="headerlink" title="4.4 Implementation Details"></a>4.4 Implementation Details</h3><p>在运行时，首先检查测试用例的覆盖位图，并得到这个测试用例所覆盖的所有边和命中数。由于每个边都有不同的哈希值，我们可以从每个边的哈希值解码出它的开始和结束块。然后，对于每个块，我们将根据整体覆盖位图，得到其未触及的邻居分支的列表。加上已收集到的子路径和内存访问操作数，可以相应计算出三种策略的权重。</p>
<h2 id="5-Evaluation"><a href="#5-Evaluation" class="headerlink" title="5 Evaluation"></a>5 Evaluation</h2><img src="/2024/01/21/Path%20sensitive%20fuzzing%20for%20Native%20Application/image-20230115111048707.png" class title="image-20230115111048707">
<img src="/2024/01/21/Path%20sensitive%20fuzzing%20for%20Native%20Application/image-20230115111053655.png" class title="image-20230115111053655">
<h3 id="5-1-Impact-of-Hash-Collision"><a href="#5-1-Impact-of-Hash-Collision" class="headerlink" title="5.1 Impact of Hash Collision"></a>5.1 Impact of Hash Collision</h3><h4 id="5-1-1-Prevalence-of-Hash-Collision"><a href="#5-1-1-Prevalence-of-Hash-Collision" class="headerlink" title="5.1.1 Prevalence of Hash Collision"></a>5.1.1 Prevalence of Hash Collision</h4><p>如表一所示，边碰撞比例非常高，与边的数量成正比。</p>
<p>原因在于，位图大小为64KB(65.5K bytes)，因此最多有65.5K条边存储于其中，这意味着无论使用什么哈希算法，194.5K(260K-65.5K)条边必须与其它边产生碰撞。</p>
<h4 id="5-1-2-Effectiveness-of-the-Trivial-Mitigation"><a href="#5-1-2-Effectiveness-of-the-Trivial-Mitigation" class="headerlink" title="5.1.2 Effectiveness of the Trivial Mitigation"></a>5.1.2 Effectiveness of the Trivial Mitigation</h4><p>这里主要指扩大位图的措施，能够减少碰撞，但降低了执行速度</p>
<p>测试软件越大，减少碰撞的效果越好</p>
<img src="/2024/01/21/Path%20sensitive%20fuzzing%20for%20Native%20Application/image-20230115113021198.png" class title="image-20230115113021198">
<p>随着位图变大，执行速度下降</p>
<img src="/2024/01/21/Path%20sensitive%20fuzzing%20for%20Native%20Application/image-20230115113031418.png" class title="image-20230115113031418">
<p>（一种想法：根据软件大小动态调节位图大小？）</p>
<h4 id="5-1-3-Effectiveness-of-CollAFL’s-Mitigation"><a href="#5-1-3-Effectiveness-of-CollAFL’s-Mitigation" class="headerlink" title="5.1.3 Effectiveness of CollAFL’s Mitigation"></a>5.1.3 Effectiveness of CollAFL’s Mitigation</h4><img src="/2024/01/21/Path%20sensitive%20fuzzing%20for%20Native%20Application/image-20230115113323782.png" class title="image-20230115113323782">
<p>使用三种算法Fsingle，Fmul和Fhash来减少碰撞</p>
<p>表3展示了碰撞缓解的数据，平均而言，CollAFL比AFL少执行了2.93%的指令</p>
<p>CollAFL会适当地增大位图的大小(大于边的数量)，正如表三中所示，libtorrent在位图大小为64KB时，其碰撞率会升到74.84%</p>
<h3 id="5-2-Code-Coverage"><a href="#5-2-Code-Coverage" class="headerlink" title="5.2 Code Coverage"></a>5.2 Code Coverage</h3><h4 id="5-2-1-Total-Coverage-Improvement"><a href="#5-2-1-Total-Coverage-Improvement" class="headerlink" title="5.2.1 Total Coverage Improvement"></a>5.2.1 Total Coverage Improvement</h4><img src="/2024/01/21/Path%20sensitive%20fuzzing%20for%20Native%20Application/image-20230115131457549.png" class title="image-20230115131457549">
<p>表四展示了不同fuzzers在200小时内探索11个应用的路径总数。与AFL相比，CollAFL(应用默认种子选择策略)平均能找到9.9%更多的路径,应用mem,desc,br策略平均能多找15.7%,17.23%,20.78%的路径；与AFLfast相比，采用默认策略可以多找8.45的路径。</p>
<img src="/2024/01/21/Path%20sensitive%20fuzzing%20for%20Native%20Application/image-20230115131628350.png" class title="image-20230115131628350">
<h4 id="5-2-2-Coverage-Growth-Over-Time"><a href="#5-2-2-Coverage-Growth-Over-Time" class="headerlink" title="5.2.2 Coverage Growth Over Time"></a>5.2.2 Coverage Growth Over Time</h4><p>附录的图7展示了200小时内的代码覆盖率增长情况。从增长趋势可以看出</p>
<ol>
<li>CollAFL和CollAFL-fast代码覆盖率增长的比AFL和AFL-fast快，说明碰撞缓解措施是有效的</li>
<li>CollAFL-br增长的比其他都快</li>
<li>AFLfast在路径发现方面并不总是比AFL表现好，一开始能够发现更多的路径，但后来被AFL追上了。说明用较长时间而非24小时来评估fuzzer的性能是值得的</li>
</ol>
<h3 id="5-3-Unique-Crashes"><a href="#5-3-Unique-Crashes" class="headerlink" title="5.3 Unique Crashes"></a>5.3 Unique Crashes</h3><p>比较了CollAFL、AFL、AFLfast发现不同冲突的效率</p>
<h4 id="5-3-1-Total-Crashes-Improvement"><a href="#5-3-1-Total-Crashes-Improvement" class="headerlink" title="5.3.1 Total Crashes Improvement"></a>5.3.1 Total Crashes Improvement</h4><img src="/2024/01/21/Path%20sensitive%20fuzzing%20for%20Native%20Application/image-20230116011026204.png" class title="image-20230116011026204">
<p>上图展示了不同fuzzer在200小时内发现的11个应用的不同冲突，其中100%为基础线(平均效率)</p>
<h4 id="5-3-2-Crashes-Growth-Over-Time"><a href="#5-3-2-Crashes-Growth-Over-Time" class="headerlink" title="5.3.2 Crashes Growth Over Time"></a>5.3.2 Crashes Growth Over Time</h4><p>CollAFL-br,CollAFL-desc和CollAFL-mem在发现冲突方面展现了强劲的增长势头</p>
<h3 id="5-4-Vulnerablities"><a href="#5-4-Vulnerablities" class="headerlink" title="5.4 Vulnerablities"></a>5.4 Vulnerablities</h3><img src="/2024/01/21/Path%20sensitive%20fuzzing%20for%20Native%20Application/image-20230116101955472.png" class title="image-20230116101955472">
<p>如表六所示，在200小时的检测中，发现了超过7500个独特的冲突，并确认了157个漏洞</p>
<p><em>冲突分类分析</em>。首先，利用开源工具afl-collect来消除重复的冲突。(它主要使用GDB插件exploitable)来计算每个崩溃backtrace的哈希值，根据哈希值来去除重复的崩溃。然后使用AddressSanitizer重新变异目标程序，使用去重后的冲突样本进行测试，AddressSanitizer随后可以报告这些崩溃的根本原因，并进一步去重。最后进行手动分析，确认了157个独特的漏洞。</p>
<p>值得注意的是，由于性能开销，我们只利用了AddressSanitizer来分类漏洞，并没有将它用在CollAFL，因此CollAFL有较好的执行速度，但却可能错失潜在的不会引起崩溃的漏洞。</p>
<h3 id="5-5-Randomness-Evaluation"><a href="#5-5-Randomness-Evaluation" class="headerlink" title="5.5 Randomness Evaluation"></a>5.5 Randomness Evaluation</h3><h4 id="5-5-1-Experiment-Setup"><a href="#5-5-1-Experiment-Setup" class="headerlink" title="5.5.1 Experiment Setup"></a>5.5.1 Experiment Setup</h4><p>设置了20次小型实验，每次在60小时内测试12个程序，总共测试了8个fuzzer</p>
<h4 id="5-5-2-Deviation-in-Path-Discovery-and-Crash-Findings"><a href="#5-5-2-Deviation-in-Path-Discovery-and-Crash-Findings" class="headerlink" title="5.5.2 Deviation in Path Discovery and Crash Findings"></a>5.5.2 Deviation in Path Discovery and Crash Findings</h4><img src="/2024/01/21/Path%20sensitive%20fuzzing%20for%20Native%20Application/image-20230116111058626.png" class title="image-20230116111058626">
<p>RSD(relative standard deviation)</p>
<h4 id="5-5-3-Deviation-in-Vulnerability-Finding"><a href="#5-5-3-Deviation-in-Vulnerability-Finding" class="headerlink" title="5.5.3 Deviation in Vulnerability Finding"></a>5.5.3 Deviation in Vulnerability Finding</h4><p>漏洞发现的随机性&gt;冲突发现的随机性&gt;路径发现的随机性</p>
<p>检测方法：计算多少次实验可以找到一个特定的漏洞，以及这些实验用来找到这个漏洞的时间。表8为统计结果</p>
<img src="/2024/01/21/Path%20sensitive%20fuzzing%20for%20Native%20Application/image-20230116111859677.png" class title="image-20230116111859677">
<h3 id="5-6-Comparision-Between-Fuzzers"><a href="#5-6-Comparision-Between-Fuzzers" class="headerlink" title="5.6 Comparision Between Fuzzers"></a>5.6 Comparision Between Fuzzers</h3><h4 id="5-6-1-Fuzzer-Settings"><a href="#5-6-1-Fuzzer-Settings" class="headerlink" title="5.6.1 Fuzzer Settings"></a>5.6.1 Fuzzer Settings</h4><h4 id="5-6-2-Vulnerability-Discovery"><a href="#5-6-2-Vulnerability-Discovery" class="headerlink" title="5.6.2 Vulnerability Discovery"></a>5.6.2 Vulnerability Discovery</h4><img src="/2024/01/21/Path%20sensitive%20fuzzing%20for%20Native%20Application/image-20230116112617826.png" class title="image-20230116112617826">
<p>表9展示了fuzzer在20次实验中平均发现的漏洞数</p>
<h3 id="5-7-Evaluation-Results-On-Binary-Applications"><a href="#5-7-Evaluation-Results-On-Binary-Applications" class="headerlink" title="5.7 Evaluation Results On Binary Applications"></a>5.7 Evaluation Results On Binary Applications</h3><p>比较AFLdyinst和CollAFL-bin的表现。只使用二进制程序作为测试目标</p>
<h4 id="5-7-1-Code-Coverage"><a href="#5-7-1-Code-Coverage" class="headerlink" title="5.7.1 Code Coverage"></a>5.7.1 Code Coverage</h4><p>计算每个fuzzer运行10次，每次100小时所发现的平均路径和边。CollAFL-bin平均可以多覆盖7.9%的路径，2.7%的边，CollAFL-bin(br)可以多覆盖15%的路径和5.7%的边</p>
<img src="/2024/01/21/Path%20sensitive%20fuzzing%20for%20Native%20Application/image-20230116120827813.png" class title="image-20230116120827813">
<h4 id="5-7-2-Bug-finding"><a href="#5-7-2-Bug-finding" class="headerlink" title="5.7.2 Bug finding"></a>5.7.2 Bug finding</h4><img src="/2024/01/21/Path%20sensitive%20fuzzing%20for%20Native%20Application/image-20230116120921586.png" class title="image-20230116120921586">
<p>统计了每个fuzzer检测的冲突和漏洞总数。</p>
<h4 id="5-7-3-Negative-Impact-by-Imprecise-Binary-Analysis"><a href="#5-7-3-Negative-Impact-by-Imprecise-Binary-Analysis" class="headerlink" title="5.7.3 Negative Impact by Imprecise Binary Analysis"></a>5.7.3 Negative Impact by Imprecise Binary Analysis</h4><p>由于不精确的静态二进制分析，二进制版本CollAFL-bin表现得比源码版本CollAFL差。</p>
<img src="/2024/01/21/Path%20sensitive%20fuzzing%20for%20Native%20Application/image-20230116121522641.png" class title="image-20230116121522641">
<h2 id="6-Conclusion"><a href="#6-Conclusion" class="headerlink" title="6 Conclusion"></a>6 Conclusion</h2><img src="/2024/01/21/Path%20sensitive%20fuzzing%20for%20Native%20Application/image-20230116121738173.png" class title="image-20230116121738173">
<img src="/2024/01/21/Path%20sensitive%20fuzzing%20for%20Native%20Application/image-20230116121747478.png" class title="image-20230116121747478"></div><div class="index-category-tag">  <hr></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2024-01-21  <a class="commentCountImg" href="/2024/01/21/NEUZZ%20Efficient%20Fuzzing%20with%20Neural%20Program%20Smoothing/#comment-container"><span class="display-none-class">d41d8cd98f00b204e9800998ecf8427e</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="d41d8cd98f00b204e9800998ecf8427e">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>an hour  <i class="fas fa-pencil-alt"> </i>7.7 k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/01/21/NEUZZ%20Efficient%20Fuzzing%20with%20Neural%20Program%20Smoothing/"> </a></h1><div class="content"><h1 id="NEUZZ-Efficient-Fuzzing-with-Neural-Program-Smoothing"><a href="#NEUZZ-Efficient-Fuzzing-with-Neural-Program-Smoothing" class="headerlink" title="NEUZZ: Efficient Fuzzing with Neural Program Smoothing"></a>NEUZZ: Efficient Fuzzing with Neural Program Smoothing</h1><p><a target="_blank" rel="noopener" href="http://github.com/dongdongshe/neuzz">http://github.com/dongdongshe/neuzz</a></p>
<p><strong>Abstract:</strong> 使用梯度引导技术替代进化算法。梯度引导技术并不能直接用于模糊处理，因为现实世界中的程序行为包含许多不连续性，而基于梯度的方法往往会在这些地方卡住。文中提出一种程序平滑技术来解决这个问题，通过<strong>代理神经网络</strong>模型学习复杂的真实世界程序分支行为的平滑近似值。将这种神经网络模型与梯度引导输入生成方案一起使用，可以显著提高模糊测试的效率。</p></div><div class="index-category-tag">  <hr></div><div class="level is-mobile is-flex"><div class="level-start"><div class="level-item"><a class="article-more button is-small size-small" href="/2024/01/21/NEUZZ%20Efficient%20Fuzzing%20with%20Neural%20Program%20Smoothing/#more">Read more&gt;&gt;</a></div></div></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2024-01-21  <a class="commentCountImg" href="/2024/01/21/NAUTILUS%20Fishing%20for%20Deep%20Bugs%20with%20Grammars/#comment-container"><span class="display-none-class">d41d8cd98f00b204e9800998ecf8427e</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="d41d8cd98f00b204e9800998ecf8427e">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>an hour  <i class="fas fa-pencil-alt"> </i>7.1 k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/01/21/NAUTILUS%20Fishing%20for%20Deep%20Bugs%20with%20Grammars/"> </a></h1><div class="content"><h1 id="NAUTILUS-Fishing-for-Deep-Bugs-with-Grammars"><a href="#NAUTILUS-Fishing-for-Deep-Bugs-with-Grammars" class="headerlink" title="NAUTILUS: Fishing for Deep Bugs with Grammars"></a>NAUTILUS: Fishing for Deep Bugs with Grammars</h1></div><div class="index-category-tag">  <hr></div><div class="level is-mobile is-flex"><div class="level-start"><div class="level-item"><a class="article-more button is-small size-small" href="/2024/01/21/NAUTILUS%20Fishing%20for%20Deep%20Bugs%20with%20Grammars/#more">Read more&gt;&gt;</a></div></div></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2024-01-21  <a class="commentCountImg" href="/2024/01/21/Large%20language%20model%20are%20Zero-Shot%20Fuzzers%20Fuzzing%20Deep-Learning%20Libraries%20via%20Large%20Language%20Models/#comment-container"><span class="display-none-class">d41d8cd98f00b204e9800998ecf8427e</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="d41d8cd98f00b204e9800998ecf8427e">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>35 m  <i class="fas fa-pencil-alt"> </i>5.3 k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/01/21/Large%20language%20model%20are%20Zero-Shot%20Fuzzers%20Fuzzing%20Deep-Learning%20Libraries%20via%20Large%20Language%20Models/"> </a></h1><div class="content"><h1 id="Large-language-model-are-Zero-Shot-Fuzzers-Fuzzing-Deep-Learning-Libraries-via-Large-Language-Models"><a href="#Large-language-model-are-Zero-Shot-Fuzzers-Fuzzing-Deep-Learning-Libraries-via-Large-Language-Models" class="headerlink" title="Large language model are Zero-Shot Fuzzers: Fuzzing Deep-Learning Libraries via Large Language Models"></a>Large language model are Zero-Shot Fuzzers: Fuzzing Deep-Learning Libraries via Large Language Models</h1></div><div class="index-category-tag">  <hr></div><div class="level is-mobile is-flex"><div class="level-start"><div class="level-item"><a class="article-more button is-small size-small" href="/2024/01/21/Large%20language%20model%20are%20Zero-Shot%20Fuzzers%20Fuzzing%20Deep-Learning%20Libraries%20via%20Large%20Language%20Models/#more">Read more&gt;&gt;</a></div></div></div></article></div><!--!--><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous is-invisible is-hidden-mobile"><a href="/page/0/">Previous</a></div><div class="pagination-next"><a href="/page/2/">Next</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link is-current" href="/">1</a></li><li><a class="pagination-link" href="/page/2/">2</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/6/">6</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><!--!--><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="https://github.com/Curator-Kim/Curator-Kim.github.io/blob/22a41709ffc26f62191d72a87ffbb342d46bfce3/img/icon.jpg?raw=true" alt="Curator-Kim"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Curator-Kim</p><p class="is-size-6 is-block">寻几处好景破星光</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>火星</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">53</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">16</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/ppoffice" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/curator-kim"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Email" href="/804242129@qq.com"><i class="fa fa-envelope"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/atom.xml"><i class="fas fa-rss"></i></a></div><div><hr><p id="hitokoto">:D 一言句子获取中...</p><script type="text/javascript" defer>function getYiyan(){
                                $.getJSON("https://v1.hitokoto.cn/", function (data) {
                                if(data){
                                    $('#hitokoto').html("");
                                    $('#hitokoto').append("<strong style='color: #3273dc;'>"+data.hitokoto+"</strong>"+
                                    "<p>"+"From《"+data.from+"》</p><p>Provider-"+data.creator+"</p>");
                                }});}
                                $(function (){getYiyan();$('#hitokoto').click(function(){getYiyan();})});</script></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile" href="https://bulma.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bulma</span></span><span class="level-right"><span class="level-item tag">bulma.io</span></span></a></li></ul></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><!--!--><div class="card widget"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-02-21T11:54:21.947Z">2024-02-21</time></p><p class="title"><a href="/2024/02/21/010editor%20%E7%A0%B4%E8%A7%A3%E8%AE%B0%E5%BD%95/"> </a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-02-07T11:25:11.851Z">2024-02-07</time></p><p class="title"><a href="/2024/02/07/L3HCTF%202024/"> </a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-01-21T13:32:59.304Z">2024-01-21</time></p><p class="title"><a href="/2024/01/21/%E9%99%87%E5%89%91%E6%9D%AF%202023%20Writeup/"> </a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-01-21T13:32:59.278Z">2024-01-21</time></p><p class="title"><a href="/2024/01/21/%E6%A8%A1%E7%B3%8A%E6%B5%8B%E8%AF%95%E6%8A%80%E6%9C%AF%E7%BB%BC%E8%BF%B0/"> </a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-01-21T13:32:59.265Z">2024-01-21</time></p><p class="title"><a href="/2024/01/21/Universal%20Fuzzing%20via%20Large%20Language%20Models/"> </a></p></div></article></div></div><!--!--><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2024/02/"><span class="level-start"><span class="level-item">February 2024</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2024/01/"><span class="level-start"><span class="level-item">January 2024</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2023/08/"><span class="level-start"><span class="level-item">August 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2023/07/"><span class="level-start"><span class="level-item">July 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2023/06/"><span class="level-start"><span class="level-item">June 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><a class="level is-mobile is-marginless" href="/archives/"><span class="level-start"><span class="level-item">查看全部&gt;&gt;</span></span></a></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/CTF/"><span class="tag">CTF</span><span class="tag is-grey-lightest">15</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80/"><span class="tag">汇编语言</span><span class="tag is-grey-lightest">12</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Crypto/"><span class="tag">Crypto</span><span class="tag is-grey-lightest">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ctf/"><span class="tag">ctf</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pwn/"><span class="tag">pwn</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CopperSmith/"><span class="tag">CopperSmith</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DES/"><span class="tag">DES</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/HWS/"><span class="tag">HWS</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/NTRU/"><span class="tag">NTRU</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/RE/"><span class="tag">RE</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Reverse/"><span class="tag">Reverse</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/angr/"><span class="tag">angr</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8A%A0%E5%AF%86%E4%B8%8E%E8%A7%A3%E5%AF%86/"><span class="tag">加密与解密</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/"><span class="tag">参考资料</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/"><span class="tag">论文阅读</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%A2%84%E5%A4%87%E7%9F%A5%E8%AF%86/"><span class="tag">预备知识</span><span class="tag is-grey-lightest">1</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe for updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div><!--!--></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="https://github.com/Curator-Kim/Curator-Kim.github.io/blob/master/img/logo.png?raw=true" alt="Curator-Kim的小站" height="28"></a><p class="size-small"><span>&copy; 2024 Curator-Kim</span>  Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a> &amp; <a href="https://github.com/removeif/hexo-theme-amazing" target="_blank">Amazing</a> <br><span>© <a href="http://www.beian.miit.gov.cn/" target="_blank">粤ICP备88888888号-8（测试）</a><br></span><span>© 版权说明：[本网站所有内容均收集于互联网或自己创作,<br />&nbsp;&nbsp;&nbsp;&nbsp;方便于网友与自己学习交流，如有侵权，请<a href="/message" target="_blank">留言</a>，立即处理]<br /></span><span><span id="statistic-times">loading...</span><script>function createTime(time) {
            var n = new Date(time);
            now.setTime(now.getTime() + 250),
                days = (now - n) / 1e3 / 60 / 60 / 24,
                dnum = Math.floor(days),
                hours = (now - n) / 1e3 / 60 / 60 - 24 * dnum,
                hnum = Math.floor(hours),
            1 == String(hnum).length && (hnum = "0" + hnum),
                minutes = (now - n) / 1e3 / 60 - 1440 * dnum - 60 * hnum,
                mnum = Math.floor(minutes),
            1 == String(mnum).length && (mnum = "0" + mnum),
                seconds = (now - n) / 1e3 - 86400 * dnum - 3600 * hnum - 60 * mnum,
                snum = Math.round(seconds),
            1 == String(snum).length && (snum = "0" + snum),
                document.getElementById("statistic-times").innerHTML = "❤️Site from <strong>"+time.split(" ")[0].replace(/\//g,".")+"</strong> has existed <strong>" + dnum + "</strong> d <strong>" + hnum + "</strong> h <strong>" + mnum + "</strong> m <strong>" + snum + "</strong> s！❤️";
        }var now = new Date();setInterval("createTime('2022/1/21 00:00:00')", 250,"");</script><br></span><div class="size-small"><span>❤️Thx <strong><span id="busuanzi_value_site_uv">99+</span></strong> users <strong><span id="busuanzi_value_site_pv">99+</span></strong> visited！❤️</span></div></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/removeif/hexo-theme-amazing"><i class="fab fa-github"></i></a></p></div><div class="sideMusic"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="/js/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script><meting-js style="width: auto;height: 2000px;" server="netease" type="playlist" id="137510737" theme="#2980b9" loop="all" autoplay="false" order="list" storageName="aplayer-setting" lrctype="0" list-max-height="400px" fixed="true"></meting-js></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><script src="/js/main.js" defer></script><script>$.getScript('/js/comment-issue-data.js',function(){loadIssueData('46a9f3481b46ea0129d8','79c7c9cb847e141757d7864453bcbf89f0655b24','Curator-Kim','blog_comment',false);})</script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.js"></script><script type="text/javascript">var pjax = new Pjax({
            elements: "a",//代表点击链接就更新
            selectors: [  //代表要更新的节点
                ".section",
                "title"
            ],
            cache: true,
            cacheBust:false
        })

        function loadBusuanzi(){
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js", function () {});
        }

        function loadMathJax() { //加载mathjax
            $.getScript("//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML", function () {
                MathJax.Hub.Config({ tex2jax: { inlineMath: [['$', '$'], ['\(', '\)']] } });
                var math = document.getElementsByClassName("entry-content")[0];
                MathJax.Hub.Queue(["Typeset", MathJax.Hub, math]);
            });
        };

        // 开始 PJAX 执行的函数
        document.addEventListener('pjax:send', function () {
        });
        
        // PJAX 完成之后执行的函数，可以和上面的重载放在一起
        document.addEventListener('pjax:complete', function () {
            $(".section").css({opacity:1});
            if(false){
                $.getScript('/js/comment-issue-data.js',function(){loadIssueData('46a9f3481b46ea0129d8','79c7c9cb847e141757d7864453bcbf89f0655b24','Curator-Kim','blog_comment',false);});
            }
            if(false){
                loadMathJax();
            }
            loadMainJs(jQuery, window.moment, window.ClipboardJS, window.IcarusThemeSettings);
            loadBackTop();
            loadBusuanzi();
            if(typeof loadBanner == 'function'){
                loadBanner();
            }
        });</script></body></html>