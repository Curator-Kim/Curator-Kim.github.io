<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>HGAME2023 Writeup - Curator-Kim的小站</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Curator-Kim的小站"><meta name="msapplication-TileImage" content="https://cdn.jsdelivr.net/gh/removeif/removeif-demo@latest/img/favicon.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Curator-Kim的小站"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="太菜了还是，好多不会"><meta property="og:type" content="blog"><meta property="og:title" content="Curator-Kim"><meta property="og:url" content="https://curator-kim.github.io/"><meta property="og:site_name" content="Curator-Kim"><meta property="og:description" content="太菜了还是，好多不会"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://curator-kim.github.io/img/icon.jpg"><meta property="article:published_time" content="2023-02-08T15:21:22.000Z"><meta property="article:modified_time" content="2023-02-11T15:51:20.000Z"><meta property="article:author" content="Curator-Kim"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/icon.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://curator-kim.github.io/2023/02/08/HGAME2023WP/"},"headline":"Curator-Kim的小站","image":["http://curator-kim.github.io/2023/02/08/HGAME2023WP/image-20230111105235628.png","http://curator-kim.github.io/2023/02/08/HGAME2023WP/image-20230113134407263.png","http://curator-kim.github.io/2023/02/08/HGAME2023WP/image-20230113194402722.png","http://curator-kim.github.io/2023/02/08/HGAME2023WP/image-20230113210620040.png","http://curator-kim.github.io/2023/02/08/HGAME2023WP/image-20230114230451423.png","http://curator-kim.github.io/2023/02/08/HGAME2023WP/image-20230114230507622.png","http://curator-kim.github.io/2023/02/08/HGAME2023WP/image-20230211205629037.png","http://curator-kim.github.io/2023/02/08/HGAME2023WP/image-20230211233420042.png","http://curator-kim.github.io/2023/02/08/HGAME2023WP/image-20230211234304199.png","http://curator-kim.github.io/2023/02/08/HGAME2023WP/image-20230210205607282.png","http://curator-kim.github.io/2023/02/08/HGAME2023WP/image-20230210205713753.png","http://curator-kim.github.io/2023/02/08/HGAME2023WP/image-20230210225235897.png","http://curator-kim.github.io/2023/02/08/HGAME2023WP/image-20230211173250905.png","http://curator-kim.github.io/2023/02/08/HGAME2023WP/image-20230211173701676.png","http://curator-kim.github.io/2023/02/08/HGAME2023WP/image-20230211191746354.png","http://curator-kim.github.io/2023/02/08/HGAME2023WP/image-20230211191942453.png","http://curator-kim.github.io/2023/02/08/HGAME2023WP/image-20230211192558886.png","http://curator-kim.github.io/2023/02/08/HGAME2023WP/image-20230211192623614.png","http://curator-kim.github.io/2023/02/08/HGAME2023WP/image-20230211192708722.png","http://curator-kim.github.io/2023/02/08/HGAME2023WP/image-20230211192806264.png"],"datePublished":"2023-02-08T15:21:22.000Z","dateModified":"2023-02-11T15:51:20.000Z","author":{"@type":"Person","name":"Curator-Kim"},"description":"太菜了还是，好多不会"}</script><link rel="canonical" href="http://curator-kim.github.io/2023/02/08/HGAME2023WP/"><link rel="icon" href="https://cdn.jsdelivr.net/gh/removeif/removeif-demo@latest/img/favicon.png"><meta name="referrer" content="no-referrer-when-downgrade"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css?family=Ubuntu:400,600|Source+Code+Pro|Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Microsoft YaHei:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&amp;amp;subset=latin,latin-ext|Inconsolata|Itim|Lobster.css"><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="/js/globalUtils.js"></script><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/pace/1.0.2/pace.min.js"></script><link rel="stylesheet" href="/live2d/waifu.css"><script type="text/javascript" async src="/live2d/autoload.js"></script><meta name="generator" content="Hexo 5.4.0"></head><body class="is-3-column has-navbar-fixed-top"><nav class="navbar navbar-main is-fixed-top"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="https://github.com/Curator-Kim/Curator-Kim.github.io/blob/master/img/logo.png?raw=true" alt="Curator-Kim的小站" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a><a class="navbar-item" href="/album">Album</a><a class="navbar-item" href="/friend">Friend</a><a class="navbar-item" href="/message">Message</a><a class="navbar-item" href="/self-talking">Self-talking</a><a class="navbar-item" href="/music">Music</a><a class="navbar-item" href="/media">Media</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Join Gitter" href="https://gitter.im/hexo-theme-amazing/community"><i class="fab fa-gitter"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/removeif/hexo-theme-amazing"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a><a class="navbar-item" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a></div></div></div></nav><script type="text/javascript" src="/js/theme-setting.js"></script><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><!--!--><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2023-02-08  <a class="commentCountImg" href="/2023/02/08/HGAME2023WP/#comment-container"><span class="display-none-class">7beabc01a411c3118c3cc656e48ebf78</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="7beabc01a411c3118c3cc656e48ebf78">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>26 m  <i class="fas fa-pencil-alt"> </i>4.0 k</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>&nbsp;visits</span></div></div><h1 class="title is-3 is-size-4-mobile">HGAME2023 Writeup</h1><div class="content"><p>太菜了还是，好多不会</p>
<span id="more"></span>
<h1 id="Week1"><a href="#Week1" class="headerlink" title="Week1"></a>Week1</h1><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">from Crypto.Util.number import long_to_bytes</span><br><span class="line">c=110674792674017748243232351185896019660434718342001686906527789876264976328686134101972125493938434992787002915562500475480693297360867681000092725583284616353543422388489208114545007138606543678040798651836027433383282177081034151589935024292017207209056829250152219183518400364871109559825679273502274955582</span><br><span class="line">n=135127138348299757374196447062640858416920350098320099993115949719051354213545596643216739555453946196078110834726375475981791223069451364024181952818056802089567064926510294124594174478123216516600368334763849206942942824711531334239106807454086389211139153023662266125937481669520771879355089997671125020789</span><br><span class="line">f1=11239134987804993586763559028187245057652550219515201768644770733869088185320740938450178816138394844329723311433549899499795775655921261664087997097294813</span><br><span class="line">f2=12022912661420941592569751731802639375088427463430162252113082619617837010913002515450223656942836378041122163833359097910935638423464006252814266959128953</span><br><span class="line">e=65537</span><br><span class="line">phi=(f1-1)*(f2-1)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">print(long_to_bytes(pow(c,d,n)))</span><br></pre></td></tr></table></figure>
<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="test-your-IDA"><a href="#test-your-IDA" class="headerlink" title="test your IDA"></a>test your IDA</h3><p>IDA打开即可</p>
<img src="/2023/02/08/HGAME2023WP/image-20230111105235628.png" class title="image-20230111105235628">
<h3 id="easyasm"><a href="#easyasm" class="headerlink" title="easyasm"></a>easyasm</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">enc=[0x5b,0x54,0x52,0x5e,0x56,0x48,0x44,0x56,0x5f,0x50,0x3,0x5e,0x56,0x6c,0x47,0x3,0x6c,0x41,0x56,0x6c,0x44,0x5c,0x41,0x2,0x57,0x12,0x4e]</span><br><span class="line">flag=&#x27;&#x27;</span><br><span class="line">for i in range(len(enc)):</span><br><span class="line">  flag+=chr((enc[i]^0x33))</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>
<h3 id="easyenc"><a href="#easyenc" class="headerlink" title="easyenc"></a>easyenc</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">enc=[ 0x04, 0xFF, 0xFD, 0x09,</span><br><span class="line">0x01, 0xF3, 0xB0, 0x00,</span><br><span class="line">0x00, 0x05, 0xF0, 0xAD,</span><br><span class="line">0x07, 0x06, 0x17, 0x05,</span><br><span class="line">0xEB, 0x17, 0xFD, 0x17,</span><br><span class="line">0xEA, 0x01, 0xEE, 0x01,</span><br><span class="line">0xEA, 0xB1, 0x05, 0xFA,</span><br><span class="line">0x08, 0x01, 0x17, 0xAC,</span><br><span class="line">0xEC, 0x01, 0xEA, 0xFD,</span><br><span class="line">0xF0, 0x05, 0x07, 0x06,0xF9</span><br><span class="line">]</span><br><span class="line">flag=&#x27;&#x27;</span><br><span class="line">for i in enc:</span><br><span class="line">  flag+=chr(((i+86)%256)^0x32)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>
<h3 id="a-cup-of-tea"><a href="#a-cup-of-tea" class="headerlink" title="a_cup_of_tea"></a>a_cup_of_tea</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line"></span><br><span class="line">int main()&#123;</span><br><span class="line">  unsigned int enc[]=&#123;0x2E63829D,0xC14E400F,0x9B39BFB9,0x5A1F8B14,0x61886DDE,0x6565C6CF,0x9F064F64,0x236A43F6,0x7D6B&#125;,enc1,enc0;</span><br><span class="line"></span><br><span class="line">  int i,j;</span><br><span class="line">  for(j=0;j&lt;4;j++)&#123;</span><br><span class="line">    int sum=-0x543210DD*32;</span><br><span class="line">    enc1=enc[2*j+1];</span><br><span class="line">    enc0=enc[2*j];</span><br><span class="line">  for(i=0;i&lt;32;i++)&#123;</span><br><span class="line">    enc1 -= (sum + enc0) ^ ((enc0 &gt;&gt; 5) + 1164413185) ^ (16 * (enc0 + 54880137));</span><br><span class="line">    enc0 -= (sum + enc1) ^ (16 * enc1 + 305419896) ^ ((enc1 &gt;&gt; 5) + 591751049);</span><br><span class="line">    sum+=0x543210DD;</span><br><span class="line">  &#125;</span><br><span class="line">  enc[2*j]=enc0;</span><br><span class="line">  enc[2*j+1]=enc1;</span><br><span class="line">  &#125;</span><br><span class="line">  printf(&quot;%s&quot;,enc);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="encode"><a href="#encode" class="headerlink" title="encode"></a>encode</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">code =[0x08, 0x06, 0x07, 0x06, 0x01, </span><br><span class="line">  0x06, 0x0D, 0x06,  0x05, 0x06, </span><br><span class="line">  0x0B, 0x07, 0x05, 0x06, 0x0E, </span><br><span class="line">  0x06, 0x03, 0x06,  0x0F, 0x06, </span><br><span class="line">  0x04, 0x06, 0x05,  0x06, 0x0F, </span><br><span class="line">  0x05, 0x09, 0x06,0x03, 0x07, </span><br><span class="line">  0x0F, 0x05, 0x05,0x06, 0x01, </span><br><span class="line">  0x06, 0x03, 0x07,0x09, 0x07, </span><br><span class="line">  0x0F, 0x05, 0x06, 0x06, 0x0F, </span><br><span class="line">  0x06, 0x02, 0x07,  0x0F, 0x05, </span><br><span class="line">  0x01, 0x06, 0x0F, 0x05, 0x02, </span><br><span class="line">  0x07, 0x05, 0x06, 0x06, 0x07, </span><br><span class="line">  0x05, 0x06, 0x02, 0x07, 0x03, </span><br><span class="line">  0x07, 0x05, 0x06,0x0F, 0x05, </span><br><span class="line">  0x05, 0x06, 0x0E, 0x06, 0x07, </span><br><span class="line">  0x06, 0x09, 0x06, 0x0E, 0x06, </span><br><span class="line">  0x05, 0x06, 0x05, 0x06, 0x02, </span><br><span class="line">  0x07, 0x0D, 0x07, 0x00]</span><br><span class="line">flag=&#x27;&#x27;</span><br><span class="line">for i in range(len(code)//2):</span><br><span class="line">  flag+=chr((code[2*i+1]&lt;&lt;4)+code[2*i])</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>
<h1 id="Week2"><a href="#Week2" class="headerlink" title="Week2"></a>Week2</h1><h2 id="Crypto-1"><a href="#Crypto-1" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="Rabin"><a href="#Rabin" class="headerlink" title="Rabin"></a>Rabin</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">from ECC_algorithm import getSquareRoot</span><br><span class="line">from Algorithm import crt</span><br><span class="line">from Crypto.Util.number import long_to_bytes</span><br><span class="line">p=65428327184555679690730137432886407240184329534772421373193521144693375074983</span><br><span class="line">q=98570810268705084987524975482323456006480531917292601799256241458681800554123</span><br><span class="line">c=0x4e072f435cbffbd3520a283b3944ac988b98fb19e723d1bd02ad7e58d9f01b26d622edea5ee538b2f603d5bf785b0427de27ad5c76c656dbd9435d3a4a7cf556</span><br><span class="line">m1=-getSquareRoot(c%p,p)</span><br><span class="line">m2=-getSquareRoot(c%q,q)</span><br><span class="line">print(long_to_bytes(crt([m1,m2],[p,q])))</span><br></pre></td></tr></table></figure>
<h3 id="RSA大冒险"><a href="#RSA大冒险" class="headerlink" title="RSA大冒险"></a>RSA大冒险</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">from Crypto.Util.number import long_to_bytes</span><br><span class="line">import Algorithm</span><br><span class="line">#1</span><br><span class="line">n=315288933426825805688924212616592252450801238550920201591728485170037832236185293620562262212564373</span><br><span class="line">e=65537</span><br><span class="line">p=221529464269769759349693179557659241103</span><br><span class="line"></span><br><span class="line">c=0x6702f40be3f2e1b6fc5ea06d1b000c4ebde5157c02889b9300b69b2d45f284d606bae84abf968f01b0</span><br><span class="line">qr=n//p</span><br><span class="line">m=pow(c,gmpy2.invert(e,p-1),p)</span><br><span class="line">print(pow(m,65537,n)==c)</span><br><span class="line">print(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"># #2</span><br><span class="line"># n=74788398255452600833006995275667385156303318208066703845018835899047541642249211631956818572743022514771471375982167772084425103038607252133106634140832610528192419686108005225277276397797407210527604431131466170506864385585497721578313293000470724782979508268306801922949301532872265907827352070517986364579</span><br><span class="line"># e=65537</span><br><span class="line"># c=0x32f90a5496b4f1817094872336ed76890d120482a98f36393adce3d54da04b1a6932431b65c02320aba2a699f3f5a5814df7250c97797e490e4037d2575162a15e68176bcd6b1449263926e59cdb4083d5afe83ec8f0f4ebd68c0c40a290d5aec10aa03e8de371ae5eb29e4596f7b76d80e394fa515153ca007c542036b03f20</span><br><span class="line"># n2=58291586270230855897847847464314004515356512090345158708849343859273898424491767757290988474773509629354082311175934200369087232429477787414958311627584959811148715414337981686730592018183488550424748798531109668152822563183050998595456519309548963205798500341294941359987406623878029149035264590916561097653</span><br><span class="line"># p=gmpy2.gcd(n,n2)</span><br><span class="line"># q=n//p</span><br><span class="line"># phi=(p-1)*(q-1)</span><br><span class="line"># print(long_to_bytes(pow(c,gmpy2.invert(e,phi),n)))</span><br><span class="line"></span><br><span class="line"># 3</span><br><span class="line"># n=57687805569573540814501334034329540619143973581288688414392180201360033962712440711890754667066506418270714008773288876051561737321648338390525811201806376049977473269236021141765756076756805005067881537548979911007527752944881304359954277998811753011700542606798148300649170003618913089646022889478178689127</span><br><span class="line"># e=3</span><br><span class="line"># c=0xfec61958cefda3eb5f709faa0282bffaded0a323fe1ef370e05ed3744a2e53b55bdd43e9594427c35514505f26e4691ba86c6dcff6d29d69110b15b9f84b0d8eb9ea7c03aaf24fa957314b89febf46a615f81ec031b12fe725f91af9d269873a69748</span><br><span class="line"># print(long_to_bytes(gmpy2.iroot(c,3)[0]))</span><br><span class="line"></span><br><span class="line"># 4</span><br><span class="line"># n=116386008425495406244066638160981699371298928874789571584702923577353414603674936565315161353810919339954009847771804025309209778770922543381030674180320647299711643763256427360268926786148664562727195227099859778200572178703215056598179424866307970709766530478522276413248639226003427624992695339403720611521</span><br><span class="line"># e1=77983</span><br><span class="line"># c1=0x9c4e31c63e8c42ceab4b91f6cab3808b7d9c278a8e1a7fbe281c13db2efeb501e25eae6369c5643240ac3cede109ec2bbe42967b297405b170eaa731b3aa962bdfce5b8ac35ad9c381474fa1b07a332c1e2e0cf652d6d3f49f3b0bbb024c6a2cf63ecd64935b55a752357f62e1a335f105299702738b2816d86eb0d1ffd79ee3</span><br><span class="line"># e2=82729</span><br><span class="line"># c2=0x6981244f3403c0b78eec867cb8713cb73a6acaffbbd9a18e7459831f58f8cc426c67de03272e1824734b45674c28ede6190bb3e14430d4d5be7a6f22e78236cd4c7ed5836461177602730c99ce5f074b8eeb9e3d537635d380264d3c599ca1c2c7ddf9fb43004b20eed8a6cb31ea4fd29625f88c4e1c5436fcd323b8570444b7</span><br><span class="line"># g,a,b=Algorithm.expand_gcd(e1,e2)</span><br><span class="line"># m=pow(c1,a,n)*gmpy2.invert(pow(c2,-b,n),n)%n</span><br><span class="line"># print(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<h3 id="包里有什么"><a href="#包里有什么" class="headerlink" title="包里有什么"></a>包里有什么</h3><p>背包密码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">from Crypto.Util.number import long_to_bytes</span><br><span class="line">m = 1528637222531038332958694965114330415773896571891017629493424</span><br><span class="line">b0 = 69356606533325456520968776034730214585110536932989313137926</span><br><span class="line">c = 93602062133487361151420753057739397161734651609786598765462162</span><br><span class="line">w=b0//2</span><br><span class="line"></span><br><span class="line">l = m.bit_length()-1</span><br><span class="line"></span><br><span class="line">a = [2 &lt;&lt; i for i in range(l)]</span><br><span class="line">flag=&#x27;&#x27;</span><br><span class="line">c=c*gmpy2.invert(w,m)%m</span><br><span class="line">for i in range(len(a),-1,-1):</span><br><span class="line">    if c&gt;=(2&lt;&lt;i):</span><br><span class="line">        flag+=&#x27;1&#x27;</span><br><span class="line">        c-=(2&lt;&lt;i)</span><br><span class="line">    else:</span><br><span class="line">        flag+=&#x27;0&#x27;</span><br><span class="line">flag=flag[::-1]+&#x27;000000&#x27;</span><br><span class="line">print(long_to_bytes(int(flag,2)))</span><br></pre></td></tr></table></figure>
<h3 id="零元购年货商店"><a href="#零元购年货商店" class="headerlink" title="零元购年货商店"></a>零元购年货商店</h3><p>在页面上尝试输入两次用户名abc和def，F12获取相应的cookie，发现二者近似</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">s_def=<span class="string">&#x27;kiHbrnsPwBI7zoV240jWtM3do4tvm9wL+XbrCtC2+ZywtGXQEaNKlhkz7NvZQQtufojxHoY=&#x27;</span></span><br><span class="line">s_abc=<span class="string">&#x27;kiHbrnsPwBI7y4Jz40jWtM3do4tvm9wL+XbrCtC2+Z23sWXQEaNKlhkz7NvZQQtufojxHoY=&#x27;</span></span><br><span class="line">s_xyz=<span class="string">&#x27;kiHbrnsPwBI70plq40jWtM3do4tvm9wL+XbrCtC2+ZGytWXQEaNKlhkz7NvZQQtufojxHoY=&#x27;</span></span><br><span class="line">s_abc=base64.b64decode(s_abc)</span><br><span class="line">s_def=base64.b64decode(s_def)</span><br><span class="line">s=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s_abc)):</span><br><span class="line">    s.append(s_abc[i]^s_def[i])</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)^<span class="built_in">ord</span>(<span class="string">&#x27;d&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">ord</span>(<span class="string">&#x27;b&#x27;</span>)^<span class="built_in">ord</span>(<span class="string">&#x27;e&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">ord</span>(<span class="string">&#x27;c&#x27;</span>)^<span class="built_in">ord</span>(<span class="string">&#x27;f&#x27;</span>))</span><br></pre></td></tr></table></figure>
<p>做异或发现只有部分不一样，且异或不相同的部分与原文异或不相同的结果一样，猜测每次异或的密文都相同</p>
<img src="/2023/02/08/HGAME2023WP/image-20230113134407263.png" class title="image-20230113134407263">
<p>结合阅读源码，我们只需要修改Name域，令其异或后解密的结果为Vidar-Tu即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line">from Crypto.Util.number import long_to_bytes</span><br><span class="line">ss2=&#x27;+EuQ73NUGxuMfxlZhWZUCJvEuLx7C6GTPsPorqxH6tFgkLVq6COXSI9Xu9z8sKqbFXlvB0rPH8Aq5w==&#x27;</span><br><span class="line">ss1=&#x27;+EuQ73NUGxuMfBpahmVXC5jEuLx7C6GTPsPorqxH6tFgkLVq6yqdSI9Xu9z8sKqbFXlvB0rPH8Aq5w==&#x27;</span><br><span class="line">name=&#x27;Vidar-Tu&#x27;</span><br><span class="line">fake=&#x27;11111111&#x27;</span><br><span class="line">a=base64.b64decode(ss1)</span><br><span class="line">print(a)</span><br><span class="line">s=[]</span><br><span class="line">for i in range(len(a)):</span><br><span class="line">    s.append(a[i])</span><br><span class="line"></span><br><span class="line">for i in range(9,17):</span><br><span class="line">    s[i]^=ord(&#x27;1&#x27;)</span><br><span class="line">    s[i]^=ord(name[i-9])</span><br><span class="line"></span><br><span class="line">flag=b&#x27;&#x27;</span><br><span class="line">for i in s:</span><br><span class="line">    flag+=long_to_bytes(i)</span><br><span class="line"></span><br><span class="line">print(base64.b64encode(flag))</span><br></pre></td></tr></table></figure>
<p>注意修改的时候要URLencode</p>
<h2 id="Reverse-1"><a href="#Reverse-1" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="before-main"><a href="#before-main" class="headerlink" title="before_main"></a>before_main</h3><p>在此处找到了真正的码表</p>
<img src="/2023/02/08/HGAME2023WP/image-20230113194402722.png" class title="image-20230113194402722">
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> n2s</span><br><span class="line">s=<span class="string">&#x27;AMHo7dLxUEabf6Z3PdWr6cOy75i4fdfeUzL17kaV7rG=&#x27;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">base64_decode</span>(<span class="params">string</span>):</span></span><br><span class="line">    table=<span class="string">&#x27;qaCpwYM2tO/RP0XeSZv8kLd6nfA7UHJ1No4gF5zr3VsBQbl9juhEGymc+WTxIiDK&#x27;</span></span><br><span class="line">    result=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> string:</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">        <span class="keyword">if</span> i!=<span class="string">&#x27;=&#x27;</span>:</span><br><span class="line">            index=table.index(i)</span><br><span class="line">            result+=(<span class="built_in">bin</span>(index)[<span class="number">2</span>:]).zfill(<span class="number">6</span>)</span><br><span class="line">        <span class="keyword">elif</span> i==<span class="string">&#x27;=&#x27;</span>:</span><br><span class="line">            result=result[:-<span class="number">2</span>]</span><br><span class="line">    <span class="keyword">return</span> n2s(<span class="built_in">int</span>(result,<span class="number">2</span>))</span><br><span class="line"><span class="built_in">print</span>(base64_decode(s))</span><br></pre></td></tr></table></figure>
<h3 id="stream"><a href="#stream" class="headerlink" title="stream"></a>stream</h3><p>python反编译，用pyinstxtractor，搞出pyc后拖进<a target="_blank" rel="noopener" href="https://tool.lu/pyc/">python反编译 - 在线工具 (tool.lu)</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line"># visit https://tool.lu/pyc/ for more information</span><br><span class="line"># Version: Python 3.9</span><br><span class="line"></span><br><span class="line">import base64</span><br><span class="line"></span><br><span class="line">def gen(key):</span><br><span class="line">    s = list(range(256))</span><br><span class="line">    j = 0</span><br><span class="line">    for i in range(256):</span><br><span class="line">        j = (j + s[i] + ord(key[i % len(key)])) % 256</span><br><span class="line">        tmp = s[i]</span><br><span class="line">        s[i] = s[j]</span><br><span class="line">        s[j] = tmp</span><br><span class="line">        i = j = 0</span><br><span class="line">        data = []</span><br><span class="line">        for _ in range(50):</span><br><span class="line">            i = (i + 1) % 256</span><br><span class="line">            j = (j + s[i]) % 256</span><br><span class="line">            tmp = s[i]</span><br><span class="line">            s[i] = s[j]</span><br><span class="line">            s[j] = tmp</span><br><span class="line">            data.append(s[(s[i] + s[j]) % 256])</span><br><span class="line">            return data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def encrypt(text, key):</span><br><span class="line">    result = &#x27;&#x27;</span><br><span class="line">    for c, k in zip(text, gen(key)):</span><br><span class="line">        result += chr(ord(c) ^ k)</span><br><span class="line">        result = base64.b64encode(result.encode()).decode()</span><br><span class="line">        return result</span><br><span class="line"></span><br><span class="line">text = input(&#x27;Flag: &#x27;)</span><br><span class="line">key = &#x27;As_we_do_as_you_know&#x27;</span><br><span class="line">enc = encrypt(text, key)</span><br><span class="line">if enc == &#x27;wr3ClVcSw7nCmMOcHcKgacOtMkvDjxZ6asKWw4nChMK8IsK7KMOOasOrdgbDlx3DqcKqwr0hw701Ly57w63CtcOl&#x27;:</span><br><span class="line">    print(&#x27;yes!&#x27;)</span><br><span class="line">    return None</span><br><span class="line">None(&#x27;try again...&#x27;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>明显是rc4流密码，脚本弄出来的缩进不太对，还得调一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes,bytes_to_long</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen</span>(<span class="params">key</span>):</span></span><br><span class="line">    s = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j = (j + s[i] + <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)])) % <span class="number">256</span></span><br><span class="line">        tmp = s[i]</span><br><span class="line">        s[i] = s[j]</span><br><span class="line">        s[j] = tmp</span><br><span class="line">    i = j = <span class="number">0</span></span><br><span class="line">    data = []</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + s[i]) % <span class="number">256</span></span><br><span class="line">        tmp = s[i]</span><br><span class="line">        s[i] = s[j]</span><br><span class="line">        s[j] = tmp</span><br><span class="line">        data.append(s[(s[i] + s[j]) % <span class="number">256</span>])</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">text, key</span>):</span></span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> c, k <span class="keyword">in</span> <span class="built_in">zip</span>(text, gen(key)):</span><br><span class="line">        result += <span class="built_in">chr</span>(<span class="built_in">ord</span>(c) ^ k)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">enc=<span class="string">&#x27;wr3ClVcSw7nCmMOcHcKgacOtMkvDjxZ6asKWw4nChMK8IsK7KMOOasOrdgbDlx3DqcKqwr0hw701Ly57w63CtcOl&#x27;</span></span><br><span class="line">key=<span class="string">&#x27;As_we_do_as_you_know&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(encrypt(base64.b64decode(enc).decode(),key))</span><br></pre></td></tr></table></figure>
<h3 id="VidarCamera"><a href="#VidarCamera" class="headerlink" title="VidarCamera"></a>VidarCamera</h3><p>拖进去，发现要输入序列号</p>
<img src="/2023/02/08/HGAME2023WP/image-20230113210620040.png" class title="image-20230113210620040">
<p>在onCreate处发现序列号的逻辑</p>
<img src="/2023/02/08/HGAME2023WP/image-20230114230451423.png" class title="image-20230114230451423">
<p>随后找到加密逻辑</p>
<img src="/2023/02/08/HGAME2023WP/image-20230114230507622.png" class title="image-20230114230507622">
<p>类似XTea的加密，只不过要注意加密轮数为33论，且括号要处理</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;string.h&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> main()&#123;</span><br><span class="line">  unsigned <span class="built_in">int</span> iArr[]=&#123;<span class="number">637666042</span>,<span class="number">457511012</span>,-<span class="number">2038734351</span>,<span class="number">578827205</span>,-<span class="number">245529892</span>,-<span class="number">1652281167</span>,<span class="number">435335655</span>,<span class="number">733644188</span>,<span class="number">705177885</span>,-<span class="number">596608744</span>,<span class="number">0</span>&#125;;</span><br><span class="line">  unsigned <span class="built_in">int</span> r1[]=&#123;<span class="number">2233</span>,<span class="number">4455</span>,<span class="number">6677</span>,<span class="number">8899</span>&#125;;</span><br><span class="line">  <span class="built_in">int</span> i2,i3,i4,j;</span><br><span class="line">  <span class="keyword">for</span>(i2=<span class="number">8</span>;i2&gt;=<span class="number">0</span>;i2--)&#123;</span><br><span class="line">    i4=<span class="number">878077251</span>*<span class="number">33</span>;</span><br><span class="line">    <span class="keyword">for</span>(i3=<span class="number">32</span>;i3&gt;=<span class="number">0</span>;i3--)&#123;</span><br><span class="line">      i4-=<span class="number">878077251</span>;</span><br><span class="line">      iArr[i2+<span class="number">1</span>]-= ((((iArr[i2] &lt;&lt; <span class="number">4</span>) ^ (iArr[i2] &gt;&gt; <span class="number">5</span>)) + iArr[i2]) ^ ((r1[(i4 &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>]) + i4));</span><br><span class="line">      iArr[i2]-= (((((r1[i4 &amp; <span class="number">3</span>]) + i4) ^ (((iArr[i2+<span class="number">1</span>] &lt;&lt; <span class="number">4</span>) ^ ((iArr[i2+<span class="number">1</span>]) &gt;&gt; <span class="number">5</span>)) + iArr[i2+<span class="number">1</span>])) ^ i4));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  printf(<span class="string">&quot;%s&quot;</span>,iArr);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="math"><a href="#math" class="headerlink" title="math"></a>math</h3><p>懒得看了，angr跑一会搞定</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>(<span class="params">argv</span>):</span></span><br><span class="line"></span><br><span class="line">  path_to_binary = <span class="string">&#x27;math&#x27;</span>  <span class="comment"># :string</span></span><br><span class="line">  project = angr.Project(path_to_binary)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  initial_state = project.factory.entry_state()</span><br><span class="line"></span><br><span class="line">  simulation = project.factory.simgr(initial_state,veritesting = <span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">is_good</span>(<span class="params">state</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">b&#x27;yes!&#x27;</span> <span class="keyword">in</span> state.posix.dumps(<span class="number">1</span>)  </span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">is_bad</span>(<span class="params">state</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">b&#x27;no no&#x27;</span> <span class="keyword">in</span> state.posix.dumps(<span class="number">1</span>)  </span><br><span class="line"></span><br><span class="line">  simulation.explore(find=is_good,avoid=is_bad)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> simulation.found:</span><br><span class="line"></span><br><span class="line">    solution_state = simulation.found[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(solution_state.posix.dumps(sys.stdin.fileno()))</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">raise</span> Exception(<span class="string">&#x27;Could not find the solution&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">  main(sys.argv)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="Week3"><a href="#Week3" class="headerlink" title="Week3"></a>Week3</h1><h2 id="Crypto-2"><a href="#Crypto-2" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="ezBlock"><a href="#ezBlock" class="headerlink" title="ezBlock"></a>ezBlock</h3><p>简单的差分</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">m_list = [i * 0x1111 for i in range(16)]</span><br><span class="line">c_list=[28590, 33943, 30267, 5412, 11529, 3089, 46924, 59533, 12915, 37743, 64090, 53680, 18933, 49378, 23512, 44742]</span><br><span class="line">s_box = &#123;0: 0x6, 1: 0x4, 2: 0xc, 3: 0x5, 4: 0x0, 5: 0x7, 6: 0x2, 7: 0xe, 8: 0x1, 9: 0xf, 10: 0x3, 11: 0xd, 12: 0x8,</span><br><span class="line">             13: 0xa, 14: 0x9, 15: 0xb&#125;</span><br><span class="line">num=0</span><br><span class="line"></span><br><span class="line">for j in range(4):</span><br><span class="line">  result=[]</span><br><span class="line">  for i in range(len(c_list)):</span><br><span class="line">    possible=[]</span><br><span class="line">    for i1 in range(16):</span><br><span class="line">      for i2 in range(16):</span><br><span class="line">        for i3 in range(16):</span><br><span class="line">          for i4 in range(16):</span><br><span class="line">            for i5 in range(16):</span><br><span class="line">              tmp=(m_list[i]&gt;&gt;(4*j))&amp;0xf</span><br><span class="line">              tmp^=i1</span><br><span class="line">              tmp=s_box[tmp]</span><br><span class="line">              tmp^=i2</span><br><span class="line">              tmp=s_box[tmp]</span><br><span class="line">              tmp^=i3</span><br><span class="line">              tmp=s_box[tmp]</span><br><span class="line">              tmp^=i4</span><br><span class="line">              tmp=s_box[tmp]</span><br><span class="line">              tmp^=i5</span><br><span class="line">              if tmp==(c_list[i]&gt;&gt;(4*j))&amp;0xf:</span><br><span class="line">                possible.append((i1,i2,i3,i4,i5))</span><br><span class="line">    result.append(possible)</span><br><span class="line">  f=result[0]</span><br><span class="line">  for i in range(1,16):</span><br><span class="line">    f=list(set(set(f)).intersection(result[i]))</span><br><span class="line">  print(f)</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">r1=[(2, 3, 2, 0, 5)]</span><br><span class="line">r2=[(4, 9, 9, 7, 13)]</span><br><span class="line">r3=[(15, 4, 15, 5, 8)]</span><br><span class="line">r4=[(4, 15, 4, 4, 13)]</span><br><span class="line">flag=&#x27;&#x27;</span><br><span class="line">for i1 in r1:</span><br><span class="line">    for i2 in r2:</span><br><span class="line">        for i3 in r3:</span><br><span class="line">            for i4 in r4:</span><br><span class="line">                flag=(hex(i4[0])[2:]+hex(i3[0])[2:]+hex(i2[0])[2:]+hex(i1[0])[2:])</span><br><span class="line">                flag+=&#x27;_&#x27;</span><br><span class="line">                flag+=(hex(i4[1])[2:]+hex(i3[1])[2:]+hex(i2[1])[2:]+hex(i1[1])[2:])</span><br><span class="line">                flag+=&#x27;_&#x27;</span><br><span class="line">                flag+=(hex(i4[2])[2:]+hex(i3[2])[2:]+hex(i2[2])[2:]+hex(i1[2])[2:])</span><br><span class="line">                flag+=&#x27;_&#x27;</span><br><span class="line">                flag+=(hex(i4[3])[2:]+hex(i3[3])[2:]+hex(i2[3])[2:]+hex(i1[3])[2:])</span><br><span class="line">                flag+=&#x27;_&#x27;</span><br><span class="line">                flag+=(hex(i4[4])[2:]+hex(i3[4])[2:]+hex(i2[4])[2:]+hex(i1[4])[2:])</span><br><span class="line">                print(flag)</span><br></pre></td></tr></table></figure>
<h3 id="ezDH"><a href="#ezDH" class="headerlink" title="ezDH"></a>ezDH</h3><p>题目描述</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">from sage.all import *</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">from secret import Alice_secret, Bob_secret, FLAG</span><br><span class="line">import random</span><br><span class="line"></span><br><span class="line">f = open(&#x27;output&#x27;, &#x27;w&#x27;)</span><br><span class="line"></span><br><span class="line">N=0x2be227c3c0e997310bc6dad4ccfeec793dca4359aef966217a88a27da31ffbcd6bb271780d8ba89e3cf202904efde03c59fef3e362b12e5af5afe8431cde31888211d72cc1a00f7c92cb6adb17ca909c3b84fcad66ac3be724fbcbe13d83bbd3ad50c41a79fcdf04c251be61c0749ea497e65e408dac4bbcb3148db4ad9ca0aa4ee032f2a4d6e6482093aa7133e5b1800001</span><br><span class="line">g = 2</span><br><span class="line"></span><br><span class="line">A = power_mod(g, Alice_secret, N)</span><br><span class="line">f.write(&quot;Alice send to Bob: &#123;&#123; &#x27;g&#x27;: &#123;g&#125;, &#x27;A&#x27;: &#123;A&#125; &#125;&#125;\n&quot;.format(g=g, A=hex(A)))</span><br><span class="line">B = power_mod(g, Bob_secret, N)</span><br><span class="line">f.write(&quot;Bob send to Alice: &#123;&#123;&#x27;B&#x27;: &#123;B&#125; &#125;&#125;\n&quot;.format(B=hex(B)))</span><br><span class="line"></span><br><span class="line">shared_secret = pow(A, Bob_secret, N)</span><br><span class="line"></span><br><span class="line">p=6864797660130609714981900799081393217269435300143305409394463459185543183397656052122559640661454554977296311391480858037121987999716643812574028291115057151</span><br><span class="line">a=-3</span><br><span class="line">b=1093849038073734274511112390766805569936207598951683748994586394495953116150735016013708737573759623248592132296706313309438452531591012912142327488478985984</span><br><span class="line">E = EllipticCurve(GF(p), [a, b])</span><br><span class="line">G = E.random_point()</span><br><span class="line">Pa = shared_secret * G</span><br><span class="line">f.write(f&quot;Alice send to Bob: &#123;&#123; &#x27;E&#x27;: &#123;E&#125;, &#x27;G&#x27;: &#123;G.xy()&#125;, &#x27;Pa&#x27;: &#123;Pa.xy()&#125; &#125;&#125;\n&quot;)</span><br><span class="line"></span><br><span class="line">k = random.randint(2, p)</span><br><span class="line">m = E.lift_x(Integer(bytes_to_long(FLAG)))</span><br><span class="line">P1 = k * G</span><br><span class="line">P2 = k * Pa</span><br><span class="line">c = m + P2</span><br><span class="line">f.write(f&quot;Bob send to Alice: &#123;&#123; &#123;P1.xy()&#125;, &#123;c.xy()&#125; &#125;&#125;\n&quot;)</span><br></pre></td></tr></table></figure>
<p>可以注意到N-1有较多小因子，可以使用Pohlig-Hellman方法来求得离散对数，然后解ECC即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import long_to_bytes</span><br><span class="line">def babystep_giantstep(g, y, p, q=None):</span><br><span class="line">    if q is None:</span><br><span class="line">        q = p - 1</span><br><span class="line">    m = int(q**0.5 + 0.5)</span><br><span class="line">    # Baby step</span><br><span class="line">    table = &#123;&#125;</span><br><span class="line">    gr = 1  # g^r</span><br><span class="line">    for r in range(m):</span><br><span class="line">        table[gr] = r</span><br><span class="line">        gr = (gr * g) % p</span><br><span class="line">    # Giant step</span><br><span class="line">    try:</span><br><span class="line">        gm = pow(g, -m, p)  # gm = g^&#123;-m&#125;</span><br><span class="line">    except:</span><br><span class="line">        return None</span><br><span class="line">    ygqm = y                # ygqm = y * g^&#123;-qm&#125;</span><br><span class="line">    for q in range(m):</span><br><span class="line">        if ygqm in table:</span><br><span class="line">            return q * m + table[ygqm]</span><br><span class="line">        ygqm = (ygqm * gm) % p</span><br><span class="line">    return None</span><br><span class="line"></span><br><span class="line"># Pohlig–Hellman法</span><br><span class="line">def pohlig_hellman_DLP(g, y, p):</span><br><span class="line">    crt_moduli = []</span><br><span class="line">    crt_remain = []</span><br><span class="line">    for q, q2 in factor(p-1):</span><br><span class="line">        # print(q,q2)</span><br><span class="line">        x = babystep_giantstep(pow(g,(p-1)//(q**q2),p), pow(y,(p-1)//(q**q2),p), p, q**q2)</span><br><span class="line">        if (x is None) or (x &lt;= 1):</span><br><span class="line">            continue</span><br><span class="line">        crt_moduli.append(q**q2)</span><br><span class="line">        crt_remain.append(x)</span><br><span class="line">    x = crt(crt_remain, crt_moduli)</span><br><span class="line">    return x</span><br><span class="line">print(&#x27;start&#x27;)</span><br><span class="line">p=0x2be227c3c0e997310bc6dad4ccfeec793dca4359aef966217a88a27da31ffbcd6bb271780d8ba89e3cf202904efde03c59fef3e362b12e5af5afe8431cde31888211d72cc1a00f7c92cb6adb17ca909c3b84fcad66ac3be724fbcbe13d83bbd3ad50c41a79fcdf04c251be61c0749ea497e65e408dac4bbcb3148db4ad9ca0aa4ee032f2a4d6e6482093aa7133e5b1800001</span><br><span class="line">g = 2</span><br><span class="line">y=0x22888b5ac1e2f490c55d0891f39aab63f74ea689aa3da3e8fd32c1cd774f7ca79538833e9348aebfc8eba16e850bbb94c35641c2e7e7e8cb76032ad068a83742dbc0a1ad3f3bef19f8ae6553f39d8771d43e5f2fcb986bd72459456d073e70d5be4d79ce5f10f76edea01492f11b807ebff0faf6819d62a8e972084e1ed5dd6e0152df2b0477a42246bbaa04389abf639833</span><br><span class="line"></span><br><span class="line">x = pohlig_hellman_DLP(g, y, p)</span><br><span class="line">print(x)</span><br><span class="line">print(pow(g, x, p) == y)</span><br><span class="line"></span><br><span class="line">x=763298723297979584226242509265452306429639396521052028233101832019494785232399729271964221388376632821010862649548789429670851057375901795855235180313900741161592403349942229366915608459286246948319221523754683611262962342297848271246140638750634713429329336679437505962986861155545101512718349115470005425527433246034761</span><br><span class="line">B=0x1889c9c65147470fdb3ad3cf305dc3461d1553ee2ce645586cf018624fc7d8e566e04d416e684c0c379d5819734fd4a09d80add1b3310d76f42fcb1e2f5aac6bcdd285589b3c2620342deffb73464209130adbd3a444b253fc648b40f0acec7493adcb3be3ee3d71a00a2b121c65b06769aada82cd1432a6270e84f7350cd61dddc17fe14de54ab436f41b9c9a0430510dde</span><br><span class="line">shared_secret=int(pow(B,x,p))</span><br><span class="line">p=6864797660130609714981900799081393217269435300143305409394463459185543183397656052122559640661454554977296311391480858037121987999716643812574028291115057151</span><br><span class="line">a=-3</span><br><span class="line">b=1093849038073734274511112390766805569936207598951683748994586394495953116150735016013708737573759623248592132296706313309438452531591012912142327488478985984</span><br><span class="line">E = EllipticCurve(GF(p), [a, b])</span><br><span class="line">G = (6205877918333770287323403670543661734129170085954198767820861962261174202646976379181735257759867760655835711845144326470613882395445975482219869828210975915, 3475351956909044812130266914587199895248867449669290021764126870271692995160201860564302206748373950979891071705183465400186006709376501382325624851012261206)</span><br><span class="line">G=E(G)</span><br><span class="line">Pa = shared_secret * G</span><br><span class="line">P1=(2032638959575737798553734238953177065671021112450002471824225734491735604600003028491729131445734432442510201955977472408728415227018746467250107080483073647, 3510147080793750133751646930018687527128938175786714269902604502700248948154299853980250781583789623838631244520649113071664767897964611902120411142027848868)</span><br><span class="line">P2=(6670373437344180404127983821482178149374116817544688094986412631575854021385459676854475335068369698875988135009698187255523501841013430892133371577987480522, 6648964426034677304189862902917458328845484047818707598329079806732346274848955747700716101983207165347315916182076928764076602008846695049181874187707051395)</span><br><span class="line">P1=E(P1)</span><br><span class="line">P2=E(P2)</span><br><span class="line">m=P2-P1*shared_secret</span><br><span class="line">print(long_to_bytes(m[0]))</span><br></pre></td></tr></table></figure>
<h3 id="RSA大冒险2"><a href="#RSA大冒险2" class="headerlink" title="RSA大冒险2"></a>RSA大冒险2</h3><h4 id="challenge1"><a href="#challenge1" class="headerlink" title="challenge1"></a>challenge1</h4><p>简单的维纳攻击</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import long_to_bytes</span><br><span class="line">import gmpy2</span><br><span class="line">def factor_rsa_wiener(N, e):</span><br><span class="line">    N = Integer(N)</span><br><span class="line">    e = Integer(e)</span><br><span class="line">    cf = (e / N).continued_fraction().convergents()</span><br><span class="line">    for f in cf:</span><br><span class="line">        k = f.numer()</span><br><span class="line">        d = f.denom()</span><br><span class="line">        if k == 0:</span><br><span class="line">            continue</span><br><span class="line">        phi_N = ((e * d) - 1) / k</span><br><span class="line">        b = -(N - phi_N + 1)</span><br><span class="line">        dis = b ^ 2 - 4 * N</span><br><span class="line">        if dis.sign() == 1:</span><br><span class="line">            dis_sqrt = sqrt(dis)</span><br><span class="line">            p = (-b + dis_sqrt) / 2</span><br><span class="line">            q = (-b - dis_sqrt) / 2</span><br><span class="line">            if p.is_integer() and q.is_integer() and (p * q) % N == 0:</span><br><span class="line">                p = p % N</span><br><span class="line">                q = q % N</span><br><span class="line">                if p &gt; q:</span><br><span class="line">                    return (p, q)</span><br><span class="line">                else:</span><br><span class="line">                    return (q, p)</span><br><span class="line">N=50106912620790723077748545370285638630293798103987564459024942397537915131654086715100716388428657018919266434631236880898382514286620710831685926262188628898376237809812120429079356974374541030002893395714637757523689802947777409958739773609927095021686448707688630552930512877986543894720890402942033640883</span><br><span class="line">e=41075178854133592024776262333088701478668890936237383929396694707270483948075119748561904376352154940688225339329231162485943249496993086276241801696944674829482261958846118393348915882539764746235942568552117626057958336132194103496781938903334500301844279687108418200811794859771282626848838075104652072619</span><br><span class="line">c=0x35799c3c06aefd5f975953c146a508e271d6df17da9de372778ecc05beb3abc65be705196e5b3513e79b221c54061b2d099c6b546926fd7a812f92527a5a1184b07ca3d75cee8f8781fc11e4d7aec60f25085dc1cdd0a86336f9ed06911954a5622ee7a622200bdaa18008a50f7d6bd465bfdf655d106201180a6e9733360c2f</span><br><span class="line"></span><br><span class="line">p,q=factor_rsa_wiener(N,e)</span><br><span class="line">d=gmpy2.invert(e,(p-1)*(q-1))</span><br><span class="line">print(long_to_bytes(pow(c,d,N)))</span><br></pre></td></tr></table></figure>
<h4 id="challenge2"><a href="#challenge2" class="headerlink" title="challenge2"></a>challenge2</h4><h4 id="challenge3"><a href="#challenge3" class="headerlink" title="challenge3"></a>challenge3</h4><p>没写出来，简单记录一下如何扩大coppersmith的界</p>
<img src="/2023/02/08/HGAME2023WP/image-20230211205629037.png" class title="image-20230211205629037">
<p>要扩大界，就要增加X或提高格的维度。Small_roots中有个参数epsilon可以调整格的大小，epsilon越小，格的维度就越大，临界值X也就越大</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">68340867186438223292118569682710524595966327481168801678255800028919163918249557519447553078528255888326840419621716908729880235244230459900539486879943421761586611726942757775742624070088176246368128990077459966006579285028594729801017390816903003704541109757846868073362640037019813128220657114558520107057</span></span><br><span class="line"></span><br><span class="line">pbits = <span class="number">512</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">2</span>**<span class="number">5</span>):</span><br><span class="line">	p4 = <span class="number">531320819410375258952658395582915285878636410772332266245849790153420724865787</span>&lt;&lt;(<span class="number">253</span>-<span class="number">248</span>)</span><br><span class="line">	p4 = p4 + i</span><br><span class="line">	kbits = pbits - p4.nbits()</span><br><span class="line">	p4 = p4 &lt;&lt; kbits</span><br><span class="line">	PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">	f = x + p4</span><br><span class="line">	roots = f.small_roots(X=<span class="number">2</span>^kbits, beta=<span class="number">0.4</span>, epsilon=<span class="number">0.01</span>)</span><br><span class="line">	<span class="keyword">if</span> roots:        </span><br><span class="line">		p = p4+<span class="built_in">int</span>(roots[<span class="number">0</span>]) </span><br><span class="line">		<span class="keyword">if</span> n%p==<span class="number">0</span>:</span><br><span class="line">			<span class="built_in">print</span>(i,p)</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">            </span><br><span class="line">q = n//p</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">0x29d543c73f4175f22440eef5954184e9d740cd3785011d560431861ccf6c4ff380d46ad948f9888e8cac2f5e38ce5e994f023d7195b78439b90d53ad23a730cc99b1b75dae1aba416cb6e645c5d135de906be54f344daba47a10492183d03211bfbaa45c09be2bb1913b1453e0538db95c56140cb78dd9c43d21f8312245ef7d</span></span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse_mod(e,f)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"><span class="comment"># b&#x27;now_you_know_how_to_use_coppersmith&#x27;</span></span><br></pre></td></tr></table></figure>
<p>代码来自<a target="_blank" rel="noopener" href="https://lazzzaro.github.io/2023/01/30/match-HGAME-2023-Week-3/">HGAME 2023 Week 3 | Lazzaro (lazzzaro.github.io)</a></p>
<p>详解可参考<a target="_blank" rel="noopener" href="https://jayxv.github.io/2020/08/13/密码学学习笔记之coppersmith/">密码学学习笔记 之 Coppersmith’s Method | Van1sh的小屋 (jayxv.github.io)</a></p>
<h2 id="Reverse-2"><a href="#Reverse-2" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="kunmusic"><a href="#kunmusic" class="headerlink" title="kunmusic"></a>kunmusic</h3><p>dnspy载入，找到一段异或函数</p>
<img src="/2023/02/08/HGAME2023WP/image-20230211233420042.png" class title="image-20230211233420042">
<p>定位到资源中相应的data段，导出并异或104，再扔回dnspy中</p>
<img src="/2023/02/08/HGAME2023WP/image-20230211234304199.png" class title="image-20230211234304199">
<h1 id="Week4"><a href="#Week4" class="headerlink" title="Week4"></a>Week4</h1><h2 id="Crypto-3"><a href="#Crypto-3" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="LLLCG"><a href="#LLLCG" class="headerlink" title="LLLCG"></a>LLLCG</h3><p>忘加括号，导致随机数发生器所产生的数越来越大，去输出的最后两个数相除即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">a=211706345021965978582473856030542488963797994201449979323423068941966827499360254330643660761059646126512449362267299536653014846007447287061921020560680746163996771015454076648897406899412762209754432878014116037419373277500817677466366165305009153721687300459282721043713926718187963843509474811862358934394540968316235913691096821773097999803101850872087152652348919655195059064950709309063524440662042964176719608703800470637173402188360470627959367190007621974120461023600478028657379431478967388771732831581736913923364405932791223918978322835073594228437222375260708633654008776114050868653548224768926836423078646687545848737264877164881877209804049573798397877344471900650280575954361388544157290762599686673743391794334291968967958947854335793334883544798246809088823456507961990982495948593962192819110928127031241510054226950521638602795151665239167297781665208527943562064650065845647352064096741541158097026905997719587649236754043073771580396006996659400786075727635509119346306188199355211363907121655444829191013465436213677340852583667067404296069108000110380914215840428356819199656846719654264083335417511593293657991087225916570365163835434762049651499148316672875581292422338216152800597945075793826356004757024559811240471510233510123181726724193362823604158393795781644493704904947674748316949809335502005645694160044393440624031295738010112716936288125701871983993157292051265758766515441991632654639991296519381648995032771882466681738647022560507077981770319902002804395826390295722279225087452371665056549255103897558881530028741556308952801878431388678775836954428060563710832641571855316899904424635930974350823101948368962289769122687810793059830362486109769756602138985026312808859608863314211699811835852664260840351985154036064417732318710161124472036875547700357109731941252392981699836542358733478738379730064681735729805418443951078149828960253869241822220255973792102580190290331726358522510108371762717787731620217163290882676971026454197693143448225316591840604886185119943300461298605156980220533174740969403961553995022087939781956914033642317920660655714499319745118517278027614502394858920437861157409431736024212975457266770864161424693526349290037650109752356839339182135976323549893398490004538510928460210628623129728348526295833141162252344600843611825320693803265436282928381031595892948401697545417956188774967337556584606710222786366844218297831298309699350008599647519088000053427813749763760824679550436742252965495469071719554705129511919329845336540268882932962953718388456014416647856023706808952003085524185617685185625752553667775368825164414779915944586475601813692464702637640244407590384409004567087816676347797814675955400055978138799338578404067787656077259560700048498779031111667543238906386805793464924822340993159093077917515034504346987580680343017480236847119150722250941784633108109450957451420190000545514327106957342360380720146233809796423338556656165441120671897637603402673385950967221201681448959417963890118997063918245706206925167186281744492944300792943069688661235689579517303463424990769449061452002133595648913461743585809088479332726694508749034283007162073705249235486267445887980326765494523104513594564676249504400592416546032445288249298947715101956435990509030419743040052688783403896343194761708097195382087658160401707100909885939933542227852457201109822599665949910385326864168127451324364997763138128800172536616029112717164602487214150591525733826002541665991105718690542443532425962837232510320176781531424358333763863254483600583144387220526796180672046134069077376701831079272376518674710075662315829425983270952243856944754013546591740242316700556967388841986281681532676019437258119302268609370075375808404939065506876277504270653817002129078411639211723443452406384666521561173740840463234988327866763439662075182802886090971960842010901119138004062587835128727178449593113686402078228676091455912993040436749110702481740682296673369165088788247811288833848288235700662996462689429088740495338812357792085942743152656873777516220033038714424397226221623137280950850684087244004342538690584476495706524761380012635320454752998941051025640540338305710654535528478256452999974938512724497391944057325863444838576550531915066369115596819597873894529477678562452328560972723949479268057104172374662850762452921866590285540204747210451172909001488949870227904090127311075767613104035073943569800266182403616937023591245323440292954780</span><br><span class="line">b=221033941580363403873311035574554178985709787415003684125512017176284102558959892635254360561903342432673257270107734440616955997861931257994488027503944754136255082354819393839059542447248228393813470665296403599607402110116352002602847181676940674654720503924792444998117749748341969727766499899690157212731972800132239690450411869643662853003272593125293511241820848706937382115593985404133030100795101325528838583500473873628197303600540581014108579850010051562554010068110591998932816813195598454914327420661892220040938762016828330027849343321506055192387195514973490848224082774126163746304819739778338705178425692516757524340164358832333693980858710695874051697953075011653700607593145633932269443525738959569470346368639312303670663651294503864381145120459035203521554968920427261887997873805383109814437114886986749268262076896226353565994159163401495591195279123461145638515459103799572379787710141556893841305001488204135637700555450316229054215885818109023108874808981578600520414598405561221054934647174090964228772700313606512465610611714731581728922538352604175367390569577463883219374481075443620400409899035670215707179615285771337748600314416990441003907871568568882390962430404344610474279680343065939090708381924082381423021498640970077479076909681734652308604265896257601242669107840830087479665447690657852886109825402968234257615149378010128483644151427252216459767837892997078687392993212905192321277937211269609733856983805806946191470327348315122269106944658695263800286645313712281341843342632831193499185625945147807365147414293048714960591564730157273917026662494610918104515043210085373721002792248290996463726600432170994672519926504295016400669859119408175051848705293979381241575309679908001709719415847134817196536991783953953636436640545787615580459712592330823381758261629690926283369480640579979821880609153984994912068741522219119944539056630329079096520430865500306985215239572176642065484382211260121294946603945878662041487146071096638350950203578354994361315610513551266959950269781536975918067739452703322781262136461179998708211072088404474086467798220706144532224148381271510829548267663443249211239128168392349655417485217454972594178541621955408662590013128456627383586251263636223918550576991196343771124884867502159556208032937741413991195829141833228354805784696915823276377713447619890962480997666973884863789347160089001432191899295995048038319319429663700801032121122044151466335221748044052241246842605454805578609475081989621432480738414494533803970130417704998509253026924606349225650961013107114702787783209828295963353010554141609959867901376063635059690369070659242002151536609836558317405708151126448858160339661965629719496651202942303191146429892916708912057284522183660102322056191387242824428594281657233253440464391298575326194601534487790774328223840303585530511902204784091570768088497905063165859845079430040038050331142613188348194425319965067942281156805588188309870200486602207919980041792302144641229016106909675996790545196714499602798047891991664236956099928400536085489718593309781105091466579136314487893507564800832388162240749321319891708032065460327451915630787431869051515875119763157257225578251619038913897082430107607097099127647042537910277214609154033726860574747657603152556694678320170563563063793477736920474440611810838426384380575983750552779421450622921277408443732792400304113981076069563116461371566106687351561019647692426243514773785841680130210515750850385607559917277320405635139893497670808754890457688131878332855739229593806744329013317355816999208333555411599130763056887452391960095939404485332281859759761456250472001312632572568428730288863840659289291266652418847426610174619536866222563115759344242746491169921826781979989070951598597532006453963857195802234196325355602109633618281052964627897897738941146059658522363553484624799843461843547974930026183225043521982919101399634944895580012472430055651143242514020430564051025603945312285848478878599654096428952417805391030163733234093391333946260295891442928043912309746607549007600923847117959906911920834529880355344146802176584681522800227787793562158590229021382104940933653717667898847980670644184503554868986320551063207294943529486241277183096968784735626714435773822113055393232488560323951630141711800993254496346719300800698676680613130067896410858714</span><br><span class="line">print(long_to_bytes(a//b))</span><br></pre></td></tr></table></figure>
<h3 id="LLLCG-Revenge"><a href="#LLLCG-Revenge" class="headerlink" title="LLLCG Revenge"></a>LLLCG Revenge</h3><p>题目描述</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from random import randint</span><br><span class="line">from sage.all import next_prime</span><br><span class="line">from flag import flag</span><br><span class="line"></span><br><span class="line">class LCG():</span><br><span class="line">    def __init__(self) -&gt; None:</span><br><span class="line">        self.n = next_prime(2**360)</span><br><span class="line">        self.a = bytes_to_long(flag)</span><br><span class="line">        self.seed = randint(1, self.n-1)</span><br><span class="line"></span><br><span class="line">    def next(self):</span><br><span class="line">        self.seed = (self.seed * self.a + randint(-2**340, 2**340)) % self.n</span><br><span class="line">        return self.seed</span><br><span class="line"></span><br><span class="line">lcg = LCG()</span><br><span class="line"></span><br><span class="line">outputs = []</span><br><span class="line">for i in range(40):</span><br><span class="line">    outputs.append(lcg.next())</span><br><span class="line"></span><br><span class="line">with open(&#x27;output.txt&#x27;, &#x27;w&#x27;) as f:</span><br><span class="line">    f.write(str(outputs))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>cvp问题</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line">output=[<span class="number">1072682018203555327925119662244845307651030128187638239188481252824704441045779384990260887455033442598048593</span>, <span class="number">2314688396626907816348951981922244498047525257125198648911598585289195781243621311428428734722999306352061119</span>, <span class="number">1878430550250179196785659908988356309384108895080459648572663321506487586862412211893692540034053316389122769</span>, <span class="number">375188073005966957576558668944558585024019277401944476621460520241453733436682837114320899506215820612778012</span>, <span class="number">1740601933458038408571714940901061894042573269534104610622455786596450579309938700212469253614325841397164626</span>, <span class="number">2240302364997293339801673638919278393212092190114945661555423503764207618629124969759043539606959348584754988</span>, <span class="number">1197889025088471452713271710311671860783390404923276895521445988512443134612928822580116266576787184846327319</span>, <span class="number">976433246957039051923406391525684432974532672076276505389812516911961753933724206796867970452615647769118718</span>, <span class="number">2043415417033800361129550753544683456060169214233719479382159378983277580824885160245880033681749601883969201</span>, <span class="number">1984763918799029807638751419395183574986098560422088374841672134542121920061633192468066783651721344114013462</span>, <span class="number">803323934991809869121110410690579868721603956649556084555774643704720423234525940066213247898221110694661155</span>, <span class="number">562860304448117793596032009881740849176223397573768843935634452924461109423140979168907236910235449335457185</span>, <span class="number">1309787661874142397912572420627123766513575319494440163191195202278465655066239655207734483496319738864886962</span>, <span class="number">799387331117066937071537642286715753443325832220178467932929642483559948552296702665548644355646564414242300</span>, <span class="number">435895870103290768903875690374192053569964916578820680528075175327491084637138415383245021660882061363762283</span>, <span class="number">1025844481259412257944752953478915300009685293647809183167084041854676759312695888262621576372363286629672305</span>, <span class="number">973440543305925828702283689240323693259060329180507330188561496233563434030267185114642244063757575448592154</span>, <span class="number">1292718969249126780353749729712561553775221894794101215463481964402196628245800785961439477450167809419110539</span>, <span class="number">478182294059469466905772721706884436001530957529397292986252169155570524778049686857846815729987813954732342</span>, <span class="number">375768709824343867177569674956240962127398373290167902349550708257924670715620362106926070669866315490327994</span>, <span class="number">737801845896333377781281959135960913727635869063347917031983291772056771910393840245037591877610657770830161</span>, <span class="number">348428691088064627130781690576475639268867488610621247856232777135056288575397902640759510766842015263274144</span>, <span class="number">1680702650416119838851788530479104078574412867692355094948457303860721150742922784797664370220672127535873755</span>, <span class="number">1033666255241064563800331663210492239063836760152485449704171396333630383760186494767846933371803246651254287</span>, <span class="number">2195508712891949305134457456528675798684502680332628491731480049292987455664470349101876245955005804056241307</span>, <span class="number">507520398206401483765111807616037549888407052916445833246479233401436248719221201756446720114940744005195519</span>, <span class="number">1046312245170954879242738591242143286409643084469319889267777122854632529652359220486460828162882633623043124</span>, <span class="number">1155453102297910649379292354062492377848897700844120804529504153098915369986534818999863690577330586990362930</span>, <span class="number">208279328557739771674397767833776203481724359035216407148500638232582951469697944759450872995381845733757054</span>, <span class="number">2346021407760011280060793630292956804356476368714399605579741704394167646143874988793076456804606169981645561</span>, <span class="number">2343205576546650272689476334210339527067780073646977745921112918236700694729730722103534235552988655079818293</span>, <span class="number">1782546718519449609146423091952204048104745357157493303680021137276022324746722411063399856638972831355565363</span>, <span class="number">1979496865227394742906841121954589136341588203768081740061582015284984831504020263082173777402469126640383916</span>, <span class="number">1349903401857361378116481737373348780088595771193014212794238119897598994450765597137155947217039410249545128</span>, <span class="number">1406938386834683546843935538906881880431881650891210824607115874008384343745694306223673166864514314067157223</span>, <span class="number">1992870407049230676015521975934845717357616500854268872036224279985284147464779084882322526483890974640424282</span>, <span class="number">1293456202398703621860849046442931998590180253861731810212837938545236005160913894478067431208978448403956057</span>, <span class="number">2312092791353497885700354375745181236063423592580471640202110350040708979959048453212739514986781413342677758</span>, <span class="number">1398359779972935198719703490700934330143266041792104397712389202850596464761935545044958311476816387155166661</span>, <span class="number">1035666501005308054522756757046586007464549186661882989265232284053396181385069582816427863101169570469156725</span>]</span><br><span class="line">t=[]</span><br><span class="line">u=[]</span><br><span class="line">p=<span class="number">2348542582773833227889480596789337027375682548908319870707290971532209025114608443463698998384768703031935081</span></span><br><span class="line">k=<span class="number">19</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(output)-<span class="number">1</span>):</span><br><span class="line">    t.append(output[i])</span><br><span class="line">    u.append(output[i+<span class="number">1</span>])</span><br><span class="line">M = Matrix(RationalField(), <span class="number">40</span>, <span class="number">40</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">babai</span>(<span class="params">A, w</span>):</span></span><br><span class="line">    A = A.LLL(delta=<span class="number">0.75</span>)</span><br><span class="line">    G = A.gram_schmidt()[<span class="number">0</span>]</span><br><span class="line">    t = w</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">reversed</span>(<span class="built_in">range</span>(A.nrows())):</span><br><span class="line">        c = ((t * G[i]) / (G[i] * G[i])).<span class="built_in">round</span>()</span><br><span class="line">        t -= A[i] * c</span><br><span class="line">    <span class="keyword">return</span> w - t</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">39</span>):</span><br><span class="line">    M[i,i]=p</span><br><span class="line">    M[<span class="number">39</span>,i]=t[i]</span><br><span class="line">M[<span class="number">39</span>,<span class="number">39</span>]=<span class="number">1</span>/(<span class="number">2</span>**(k+<span class="number">1</span>))</span><br><span class="line">closest=babai(M,vector(u+[<span class="number">0</span>]))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes((closest[-<span class="number">1</span>] * (<span class="number">2</span> ** (k + <span class="number">1</span>))) % p))</span><br></pre></td></tr></table></figure>
<h3 id="ECRSA"><a href="#ECRSA" class="headerlink" title="ECRSA"></a>ECRSA</h3><p>题目描述</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sage.all_cmdline <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">Nbits = <span class="number">512</span></span><br><span class="line">x = bytes_to_long(flag)</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;./output&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_pubkey</span>(<span class="params">Nbits</span>):</span></span><br><span class="line">    p = getPrime(Nbits // <span class="number">2</span>)</span><br><span class="line">    q = getPrime(Nbits // <span class="number">2</span>)</span><br><span class="line">    n = p*q</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        a = getRandomInteger(Nbits // <span class="number">2</span>)</span><br><span class="line">        b = getRandomInteger(Nbits // <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">if</span> gcd(<span class="number">4</span>*a**<span class="number">3</span> + <span class="number">27</span>*b**<span class="number">2</span>, n) == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    E = EllipticCurve(Zmod(n), [a, b])</span><br><span class="line">    e = getPrime(<span class="number">64</span>)</span><br><span class="line">    f.write(<span class="string">f&quot;p=<span class="subst">&#123;p&#125;</span>\nq=<span class="subst">&#123;q&#125;</span>\n&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> n, E, e</span><br><span class="line"></span><br><span class="line">n, E, e = gen_pubkey(Nbits)</span><br><span class="line">pt = E.lift_x(Integer(x))</span><br><span class="line">ct = pt * e</span><br><span class="line">f.write(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>\na = <span class="subst">&#123;E.a4()&#125;</span>\nb = <span class="subst">&#123;E.a6()&#125;</span>\ne = <span class="subst">&#123;e&#125;</span>\n&quot;</span>)</span><br><span class="line">f.write(<span class="string">f&quot;ciphertext = <span class="subst">&#123;long_to_bytes(<span class="built_in">int</span>(ct.xy()[<span class="number">0</span>]))&#125;</span>\n&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>题目中的点ct满足</p>
<script type="math/tex; mode=display">
y^2\equiv x^3+ax+b\ mod\ n</script><p>等价于</p>
<script type="math/tex; mode=display">
\begin{equation}
\begin{cases}
y^2\equiv x^3+ax+b\ mod\ p\\
y^2\equiv x^3+ax+b\ mod\ q

\end{cases}
\end{equation}</script><p>即可以把原题的椭圆$E$分解为两个子椭圆$E_1:y^2\equiv x^3+ax+b\ mod\ p$和$E_2:y^2\equiv x^3+ax+b\ mod\ q$，通过求$e$对每个子椭圆的阶数$E_1.order()\ E_2.order()$的逆，即可得到点$pt$在每个子椭圆上的值，再结合中国剩余定理即可得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">import gmpy2</span><br><span class="line">p=115192265954802311941399019598810724669437369433680905425676691661793518967453</span><br><span class="line">q=109900879774346908739236130854229171067533592200824652124389936543716603840487</span><br><span class="line">n = 12659731371633323406361071735480743870942884407511647144758055911931321534333057725377899993936046070028289182446615763391740446071787318153462098556669611</span><br><span class="line">a = 34573016245861396068378040882622992245754693028152290874131112955018884485688</span><br><span class="line">b = 103282137133820948206682036569671566996381438254897510344289164039717355513886</span><br><span class="line">e = 11415307674045871669</span><br><span class="line">ciphertext = b&#x27;f\xb1\xae\x08`\xe8\xeb\x14\x8a\x87\xd6\x18\x82\xaf1q\xe4\x84\xf0\x87\xde\xedF\x99\xe0\xf7\xdcH\x9ai\x04[\x8b\xbbHR\xd6\xa0\xa2B\x0e\xd4\xdbr\xcc\xad\x1e\xa6\xba\xad\xe9L\xde\x94\xa4\xffKP\xcc\x00\x907\xf3\xea&#x27;</span><br><span class="line"></span><br><span class="line">E1 = EllipticCurve(Zmod(p), [a, b])</span><br><span class="line">p1=E1.lift_x(Integer(bytes_to_long(ciphertext)))</span><br><span class="line">e_inv=gmpy2.invert(e,E1.order())</span><br><span class="line">p2=e_inv*p1</span><br><span class="line"></span><br><span class="line">E2=EllipticCurve(Zmod(q), [a, b])</span><br><span class="line">p1=E2.lift_x(Integer(bytes_to_long(ciphertext)))</span><br><span class="line">e_inv=gmpy2.invert(e,E2.order())</span><br><span class="line">p2_=e_inv*p1</span><br><span class="line">print(p2_[0])</span><br><span class="line">print(long_to_bytes(crt([Integer(p2[0]),Integer(p2_[0])],[p,q])))</span><br></pre></td></tr></table></figure>
<h2 id="Reverse-3"><a href="#Reverse-3" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="vm"><a href="#vm" class="headerlink" title="vm"></a>vm</h3><p>给了提示就好做多了</p>
<p>添加结构体并识别</p>
<img src="/2023/02/08/HGAME2023WP/image-20230210205607282.png" class title="image-20230210205607282">
<p>逐个对vm中的指令进行翻译</p>
<img src="/2023/02/08/HGAME2023WP/image-20230210205713753.png" class title="image-20230210205713753">
<p>case0可以看作是对寄存器赋值等的操作</p>
<p>case1将寄存器中的值压栈</p>
<p>case2则是出栈，将值赋给寄存器</p>
<p>case3则是进行加减乘除移位等运算</p>
<p>case4则是进行判断，类似指令cmp</p>
<p>case5则是无条件跳转指令，类似jmp</p>
<p>case6和case7是条件跳转指令，类似jz和jnz</p>
<p>查看指令序列，逐条翻译进行逆向即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">opt=[</span><br><span class="line">  0x00, 0x03, 0x02, 0x00, #a1-&gt;reg[2]=0</span><br><span class="line">  0x03, 0x00, 0x02, 0x03, #a1-&gt;reg[2]+=a1-&gt;reg[3]</span><br><span class="line">  0x00, 0x00, 0x00, 0x00, #a1-&gt;reg[0]=input[a1-&gt;reg[2]]</span><br><span class="line">  0x00, 0x02, 0x01, 0x00, #a1-&gt;reg[1]=a1-&gt;reg[0]</span><br><span class="line">  0x00, 0x03, 0x02, 0x32, #a1-&gt;reg[2]=0x32</span><br><span class="line">  0x03, 0x00, 0x02, 0x03, #a1-&gt;reg[2]+=a1-&gt;reg[3]</span><br><span class="line">  0x00, 0x00, 0x00, 0x00, #a1-&gt;reg[0]=input[a1-&gt;reg[2]]  (0x9b)</span><br><span class="line">  0x03, 0x00, 0x01, 0x00, #a1-&gt;reg[1]+=a1-&gt;reg[0]</span><br><span class="line">  0x00, 0x03, 0x02, 0x64, #a1-&gt;reg[2]=0x64</span><br><span class="line">  0x03, 0x00, 0x02, 0x03, #a1-&gt;reg[2]+=a1-&gt;reg[3]</span><br><span class="line">  0x00, 0x00, 0x00, 0x00, #a1-&gt;reg[0]=input[a1-&gt;reg[2]]  (0xc9)</span><br><span class="line">  0x03, 0x03, 0x01, 0x00, #a1-&gt;reg[1]^=a1-&gt;reg[0]</span><br><span class="line">  0x00, 0x03, 0x00, 0x08, #a1-&gt;reg[0]=0x8</span><br><span class="line">  0x00, 0x02, 0x02, 0x01, #a1-&gt;reg[2]=a1-&gt;reg[1]</span><br><span class="line">  0x03, 0x04, 0x01, 0x00, #a1-&gt;reg[1]&lt;&lt;=a1-&gt;reg[0]</span><br><span class="line">  0x03, 0x05, 0x02, 0x00, #a1-&gt;reg[2]&gt;&gt;=a1-&gt;reg[0]</span><br><span class="line">  0x03, 0x00, 0x01, 0x02, #a1-&gt;reg[1]+=a1-&gt;reg[2]</span><br><span class="line">  0x00, 0x02, 0x00, 0x01, #a1-&gt;reg[0]=a1-&gt;reg[1]</span><br><span class="line">  0x01, 0x00, #stack[++sp]=a1-&gt;reg[0]</span><br><span class="line">  0x00, 0x03, 0x00, 0x01, #a1-&gt;reg[0]=1</span><br><span class="line">  0x03, 0x00, 0x03, 0x00, #a1-&gt;reg[3]+=a1-&gt;reg[0]</span><br><span class="line">  0x00, 0x02, 0x00, 0x03, #a1-&gt;reg[0]=a1-&gt;reg[3]</span><br><span class="line">  0x00, 0x03, 0x01, 0x28, #a1-&gt;reg[1]=0x28</span><br><span class="line">  0x04, #a1-&gt;reg[0]==a1-&gt;reg[1]? ##长度判断</span><br><span class="line">  0x06, 0x5F, 0x05, 0x00, #相等jump0x5f，不相等jump0x5</span><br><span class="line">  0x00, 0x03, 0x03, 0x00, #a1-&gt;reg[3]=0</span><br><span class="line">  0x02, 0x01, # a1-&gt;reg[1]=stack[a1-&gt;sp--]</span><br><span class="line">  0x00, 0x03, 0x02, 0x96, #a1-&gt;reg[2]=0x96</span><br><span class="line">  0x03, 0x00, 0x02, 0x03, #a1-&gt;reg[2]+=a1-&gt;reg[3]</span><br><span class="line">  0x00, 0x00, 0x00, 0x00, #a1-&gt;reg[0]=input[a1-&gt;reg[0]]</span><br><span class="line">  0x04, #a1-&gt;reg[0]==a1-&gt;reg[1]</span><br><span class="line">  0x07, 0x88, #不相等则结束</span><br><span class="line">  0x00, 0x03, 0x00, 0x01, #a1-&gt;reg[0]=1</span><br><span class="line">  0x03, 0x00, 0x03, 0x00, #a1-&gt;reg[3]+=a1-&gt;reg[0]</span><br><span class="line">  0x00, 0x02, 0x00, 0x03, #a1-&gt;[0]=a1-&gt;reg[3]</span><br><span class="line">  0x00, 0x03, 0x01, 0x28, #</span><br><span class="line">  0x04, 0x07, 0x63, 0xFF, 0xFF</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>解密脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">input=[0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x9b, 0xa8, 0x2, 0xbc, 0xac, 0x9c, 0xce, 0xfa, 0x2, 0xb9, 0xff, 0x3a, 0x74, 0x48, 0x19, 0x69, 0xe8, 0x3, 0xcb, 0xc9, 0xff, 0xfc, 0x80, 0xd6, 0x8d, 0xd7, 0x72, 0x0, 0xa7, 0x1d, 0x3d, 0x99, 0x88, 0x99, 0xbf, 0xe8, 0x96, 0x2e, 0x5d, 0x57, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xc9, 0xa9, 0xbd, 0x8b, 0x17, 0xc2, 0x6e, 0xf8, 0xf5, 0x6e, 0x63, 0x63, 0xd5, 0x46, 0x5d, 0x16, 0x98, 0x38, 0x30, 0x73, 0x38, 0xc1, 0x5e, 0xed, 0xb0, 0x29, 0x5a, 0x18, 0x40, 0xa7, 0xfd, 0xa, 0x1e, 0x78, 0x8b, 0x62, 0xdb, 0xf, 0x8f, 0x9c, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x4800, 0xf100, 0x4000, 0x2100, 0x3501, 0x6400, 0x7801, 0xf900, 0x1801, 0x5200, 0x2500, 0x5d01, 0x4700, 0xfd00, 0x6901, 0x5c00, 0xaf01, 0xb200, 0xec01, 0x5201, 0x4f01, 0x1a01, 0x5000, 0x8501, 0xcd00, 0x2300, 0xf800, 0xc00, 0xcf00, 0x3d01, 0x4501, 0x8200, 0xd201, 0x2901, 0xd501, 0x601, 0xa201, 0xde00, 0xa601, 0xca01, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0]</span><br><span class="line">print(hex(input[0x32]))</span><br><span class="line">print(hex(input[0x64]))</span><br><span class="line">print(opt[0x5f:])</span><br><span class="line"></span><br><span class="line">num1=input[0x32:0x64]</span><br><span class="line">num2=input[0x64:0x96]</span><br><span class="line">cip=input[0x96:0x96+40]</span><br><span class="line">flag=&#x27;&#x27;</span><br><span class="line">for i in range(40):</span><br><span class="line">  n=(cip[39-i]&gt;&gt;8)+((cip[39-i]&amp;0xff)&lt;&lt;8)</span><br><span class="line">  n^=num2[i]</span><br><span class="line">  n-=num1[i]</span><br><span class="line">  flag+=chr(n)</span><br><span class="line"></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>
<h3 id="shellcode"><a href="#shellcode" class="headerlink" title="shellcode"></a>shellcode</h3><p>有一段base64的字符串，结合题目暗示，解码后拖进IDA反编译</p>
<img src="/2023/02/08/HGAME2023WP/image-20230210225235897.png" class title="image-20230210225235897">
<p>结构清晰，只是一段TEA加密而已</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line"></span><br><span class="line">int main()&#123;</span><br><span class="line">  char cip[40]=&#123;32, 105, 179, 228, 208, 36, 105, 147, 68, 209, 22, 168, 245, 213, 130, 170, 218, 240, 121, 54, 6, 253, 50, 127, 211, 192, 96, 52, 57, 73, 33, 183, 162, 105, 114, 229, 250, 81, 106, 131&#125;;</span><br><span class="line">  unsigned int key=1412567261;</span><br><span class="line">  int sum;</span><br><span class="line">  unsigned int *a1,v2,v3;</span><br><span class="line">  a1=(unsigned int *)cip;</span><br><span class="line">  for(int j=4;j&gt;=0;j--)&#123;</span><br><span class="line">      sum=-key;</span><br><span class="line">      sum*=0x20;</span><br><span class="line">      v2=*a1;</span><br><span class="line">      v3=a1[1];</span><br><span class="line">      for(int i=0;i&lt;0x20;++i)&#123;</span><br><span class="line">        v3 -= ((v2 &gt;&gt; 5) + 55) ^ (v2 + sum) ^ (16 * v2 + 44);</span><br><span class="line">        v2 -= ((v3 &gt;&gt; 5) + 33) ^ (v3 + sum) ^ (16 * v3 + 22);</span><br><span class="line">        sum+=key;</span><br><span class="line">      &#125;</span><br><span class="line">      *a1=v2;</span><br><span class="line">      a1[1]=v3;</span><br><span class="line">      a1+=2;</span><br><span class="line">  &#125;</span><br><span class="line">  printf(&quot;%s&quot;,cip);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="ezWin-variables"><a href="#ezWin-variables" class="headerlink" title="ezWin-variables"></a>ezWin-variables</h3><p>用volatilitys打开，查看环境变量</p>
<img src="/2023/02/08/HGAME2023WP/image-20230211173250905.png" class title="image-20230211173250905">
<h3 id="ezWin-auth"><a href="#ezWin-auth" class="headerlink" title="ezWin-auth"></a>ezWin-auth</h3><img src="/2023/02/08/HGAME2023WP/image-20230211173701676.png" class title="image-20230211173701676">
<p>flag在user.txt中，dump出哈希值</p>
<img src="/2023/02/08/HGAME2023WP/image-20230211191746354.png" class title="image-20230211191746354">
<p>可以通过查看notepad的的用户来确定flag</p>
<img src="/2023/02/08/HGAME2023WP/image-20230211191942453.png" class title="image-20230211191942453">
<h3 id="ezWin-7z"><a href="#ezWin-7z" class="headerlink" title="ezWin-7z"></a>ezWin-7z</h3><p>题目暗示找7z压缩包</p>
<img src="/2023/02/08/HGAME2023WP/image-20230211192558886.png" class title="image-20230211192558886">
<p>dump出来</p>
<img src="/2023/02/08/HGAME2023WP/image-20230211192623614.png" class title="image-20230211192623614">
<p>打开，发现加密</p>
<img src="/2023/02/08/HGAME2023WP/image-20230211192708722.png" class title="image-20230211192708722">
<p>查询flag2的Nthash的对应值为asdqwe123，输入，成功解密</p>
<img src="/2023/02/08/HGAME2023WP/image-20230211192806264.png" class title="image-20230211192806264"></div><div class="article-licensing box"><div class="licensing-title"><p>HGAME2023 Writeup</p><p><a href="http://curator-kim.github.io/2023/02/08/HGAME2023WP/">http://curator-kim.github.io/2023/02/08/HGAME2023WP/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><a href="http://Curator-Kim.github.io"><p>Curator-Kim</p></a></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2023-02-08</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2023-02-11</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="recommend-area"><div class="recommend-post"><span class="is-size-6 has-text-grey has-mr-7"># Related Post</span><br><span>  1.<a class="is-size-6" href="/2024/03/14/ICS3Fuzzer%20A%20Framework%20for%20Discovering%20Protocol%20Implementation%20Bugs%20in%20ICS%20Supervisory%20Software%20by%20Fuzzing/" target="_blank"> </a><br></span><span>  2.<a class="is-size-6" href="/2024/02/21/010editor%20%E7%A0%B4%E8%A7%A3%E8%AE%B0%E5%BD%95/" target="_blank"> </a><br></span><span>  3.<a class="is-size-6" href="/2024/02/07/L3HCTF%202024/" target="_blank"> </a><br></span><span>  4.<a class="is-size-6" href="/2024/01/21/%E9%99%87%E5%89%91%E6%9D%AF%202023%20Writeup/" target="_blank"> </a><br></span><span>  5.<a class="is-size-6" href="/2024/01/21/%E6%A8%A1%E7%B3%8A%E6%B5%8B%E8%AF%95%E6%8A%80%E6%9C%AF%E7%BB%BC%E8%BF%B0/" target="_blank"> </a><br></span><span>  6.<a class="is-size-6" href="/2024/01/21/Universal%20Fuzzing%20via%20Large%20Language%20Models/" target="_blank"> </a><br></span><span>  7.<a class="is-size-6" href="/2024/01/21/Skyfire%20Data-Driven%20Seed%20Generation%20for%20Fuzzing/" target="_blank"> </a><br></span><span>  8.<a class="is-size-6" href="/2024/01/21/Path%20sensitive%20fuzzing%20for%20Native%20Application/" target="_blank"> </a><br></span></div></div><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/css/share.min.css"><div class="social-share"></div><script src="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>Alipay</span><span class="qrcode"><img src="https://github.com/Curator-Kim/Curator-Kim.github.io/blob/master/img/alipay.png?raw=true" alt="Alipay"></span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>Wechat</span><span class="qrcode"><img src="https://github.com/Curator-Kim/Curator-Kim.github.io/blob/master/img/wechat.png?raw=true" alt="Wechat"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2023/04/28/BUAACTF2023/"><i class="level-item fas fa-chevron-left"></i><span class="level-item"> </span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2023/01/09/HWS2023%20Winter%20Wp/"><span class="level-item"> </span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--><div class="card"><div class="card-content"><div class="title is-5">Comments</div><div id="comment-container"></div><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/gitalk/1.6.0/gitalk.css"><script> $.getScript('/js/gitalk.min.js', function () { 
            var gitalk = new Gitalk({
            language:'zh-CN',
            id: '7beabc01a411c3118c3cc656e48ebf78',
            repo: 'blog_comment',
            owner: 'Curator-Kim',
            clientID: '46a9f3481b46ea0129d8',
            clientSecret: '79c7c9cb847e141757d7864453bcbf89f0655b24',
            admin: ["Curator-Kim"],
            createIssueManually: true,
            distractionFreeMode: false,
            perPage: 10,
            pagerDirection: 'last',
            proxy: 'https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token',
            
            enableHotKey: true,
            isLocked: false
        })
        gitalk.render('comment-container')});</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="is-flex is-mobile" href="#Week1"><span>Week1</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#Crypto"><span>Crypto</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#RSA"><span>RSA</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#Reverse"><span>Reverse</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#test-your-IDA"><span>test your IDA</span></a></li><li><a class="is-flex is-mobile" href="#easyasm"><span>easyasm</span></a></li><li><a class="is-flex is-mobile" href="#easyenc"><span>easyenc</span></a></li><li><a class="is-flex is-mobile" href="#a-cup-of-tea"><span>a_cup_of_tea</span></a></li><li><a class="is-flex is-mobile" href="#encode"><span>encode</span></a></li></ul></li></ul></li><li><a class="is-flex is-mobile" href="#Week2"><span>Week2</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#Crypto-1"><span>Crypto</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#Rabin"><span>Rabin</span></a></li><li><a class="is-flex is-mobile" href="#RSA大冒险"><span>RSA大冒险</span></a></li><li><a class="is-flex is-mobile" href="#包里有什么"><span>包里有什么</span></a></li><li><a class="is-flex is-mobile" href="#零元购年货商店"><span>零元购年货商店</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#Reverse-1"><span>Reverse</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#before-main"><span>before_main</span></a></li><li><a class="is-flex is-mobile" href="#stream"><span>stream</span></a></li><li><a class="is-flex is-mobile" href="#VidarCamera"><span>VidarCamera</span></a></li><li><a class="is-flex is-mobile" href="#math"><span>math</span></a></li></ul></li></ul></li><li><a class="is-flex is-mobile" href="#Week3"><span>Week3</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#Crypto-2"><span>Crypto</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#ezBlock"><span>ezBlock</span></a></li><li><a class="is-flex is-mobile" href="#ezDH"><span>ezDH</span></a></li><li><a class="is-flex is-mobile" href="#challenge3"><span>challenge3</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#Reverse-2"><span>Reverse</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#kunmusic"><span>kunmusic</span></a></li></ul></li></ul></li><li><a class="is-flex is-mobile" href="#Week4"><span>Week4</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#Crypto-3"><span>Crypto</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#LLLCG"><span>LLLCG</span></a></li><li><a class="is-flex is-mobile" href="#LLLCG-Revenge"><span>LLLCG Revenge</span></a></li><li><a class="is-flex is-mobile" href="#ECRSA"><span>ECRSA</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#Reverse-3"><span>Reverse</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#vm"><span>vm</span></a></li><li><a class="is-flex is-mobile" href="#shellcode"><span>shellcode</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#Misc"><span>Misc</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#ezWin-variables"><span>ezWin-variables</span></a></li><li><a class="is-flex is-mobile" href="#ezWin-auth"><span>ezWin-auth</span></a></li><li><a class="is-flex is-mobile" href="#ezWin-7z"><span>ezWin-7z</span></a></li></ul></li></ul></li></ul></div></div><style>.menu-list > li > a.is-active + .menu-list { display: block; }.menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="https://github.com/Curator-Kim/Curator-Kim.github.io/blob/22a41709ffc26f62191d72a87ffbb342d46bfce3/img/icon.jpg?raw=true" alt="Curator-Kim"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Curator-Kim</p><p class="is-size-6 is-block">寻几处好景破星光</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>火星</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">55</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">16</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/ppoffice" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/curator-kim"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Email" href="/804242129@qq.com"><i class="fa fa-envelope"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/atom.xml"><i class="fas fa-rss"></i></a></div><div><hr><p id="hitokoto">:D 一言句子获取中...</p><script type="text/javascript" defer>function getYiyan(){
                                $.getJSON("https://v1.hitokoto.cn/", function (data) {
                                if(data){
                                    $('#hitokoto').html("");
                                    $('#hitokoto').append("<strong style='color: #3273dc;'>"+data.hitokoto+"</strong>"+
                                    "<p>"+"From《"+data.from+"》</p><p>Provider-"+data.creator+"</p>");
                                }});}
                                $(function (){getYiyan();$('#hitokoto').click(function(){getYiyan();})});</script></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile" href="https://bulma.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bulma</span></span><span class="level-right"><span class="level-item tag">bulma.io</span></span></a></li></ul></div></div></div><!--!--><div class="card widget"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-03-14T03:40:32.352Z">2024-03-14</time></p><p class="title"><a href="/2024/03/14/ICS3Fuzzer%20A%20Framework%20for%20Discovering%20Protocol%20Implementation%20Bugs%20in%20ICS%20Supervisory%20Software%20by%20Fuzzing/"> </a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-02-21T11:54:21.947Z">2024-02-21</time></p><p class="title"><a href="/2024/02/21/010editor%20%E7%A0%B4%E8%A7%A3%E8%AE%B0%E5%BD%95/"> </a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-02-07T11:25:11.851Z">2024-02-07</time></p><p class="title"><a href="/2024/02/07/L3HCTF%202024/"> </a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-01-21T13:32:59.304Z">2024-01-21</time></p><p class="title"><a href="/2024/01/21/%E9%99%87%E5%89%91%E6%9D%AF%202023%20Writeup/"> </a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-01-21T13:32:59.278Z">2024-01-21</time></p><p class="title"><a href="/2024/01/21/%E6%A8%A1%E7%B3%8A%E6%B5%8B%E8%AF%95%E6%8A%80%E6%9C%AF%E7%BB%BC%E8%BF%B0/"> </a></p></div></article></div></div><!--!--><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2024/03/"><span class="level-start"><span class="level-item">March 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2024/02/"><span class="level-start"><span class="level-item">February 2024</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2024/01/"><span class="level-start"><span class="level-item">January 2024</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2023/08/"><span class="level-start"><span class="level-item">August 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2023/07/"><span class="level-start"><span class="level-item">July 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><a class="level is-mobile is-marginless" href="/archives/"><span class="level-start"><span class="level-item">查看全部&gt;&gt;</span></span></a></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/CTF/"><span class="tag">CTF</span><span class="tag is-grey-lightest">15</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80/"><span class="tag">汇编语言</span><span class="tag is-grey-lightest">12</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Crypto/"><span class="tag">Crypto</span><span class="tag is-grey-lightest">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ctf/"><span class="tag">ctf</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pwn/"><span class="tag">pwn</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CopperSmith/"><span class="tag">CopperSmith</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DES/"><span class="tag">DES</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/HWS/"><span class="tag">HWS</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/NTRU/"><span class="tag">NTRU</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/RE/"><span class="tag">RE</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Reverse/"><span class="tag">Reverse</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/angr/"><span class="tag">angr</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8A%A0%E5%AF%86%E4%B8%8E%E8%A7%A3%E5%AF%86/"><span class="tag">加密与解密</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/"><span class="tag">参考资料</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/"><span class="tag">论文阅读</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%A2%84%E5%A4%87%E7%9F%A5%E8%AF%86/"><span class="tag">预备知识</span><span class="tag is-grey-lightest">1</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe for updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div><!--!--><div class="column-right-shadow is-hidden-widescreen"></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="https://github.com/Curator-Kim/Curator-Kim.github.io/blob/master/img/logo.png?raw=true" alt="Curator-Kim的小站" height="28"></a><p class="size-small"><span>&copy; 2024 Curator-Kim</span>  Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a> &amp; <a href="https://github.com/removeif/hexo-theme-amazing" target="_blank">Amazing</a> <br><span>© <a href="http://www.beian.miit.gov.cn/" target="_blank">粤ICP备88888888号-8（测试）</a><br></span><span>© 版权说明：[本网站所有内容均收集于互联网或自己创作,<br />&nbsp;&nbsp;&nbsp;&nbsp;方便于网友与自己学习交流，如有侵权，请<a href="/message" target="_blank">留言</a>，立即处理]<br /></span><span><span id="statistic-times">loading...</span><script>function createTime(time) {
            var n = new Date(time);
            now.setTime(now.getTime() + 250),
                days = (now - n) / 1e3 / 60 / 60 / 24,
                dnum = Math.floor(days),
                hours = (now - n) / 1e3 / 60 / 60 - 24 * dnum,
                hnum = Math.floor(hours),
            1 == String(hnum).length && (hnum = "0" + hnum),
                minutes = (now - n) / 1e3 / 60 - 1440 * dnum - 60 * hnum,
                mnum = Math.floor(minutes),
            1 == String(mnum).length && (mnum = "0" + mnum),
                seconds = (now - n) / 1e3 - 86400 * dnum - 3600 * hnum - 60 * mnum,
                snum = Math.round(seconds),
            1 == String(snum).length && (snum = "0" + snum),
                document.getElementById("statistic-times").innerHTML = "❤️Site from <strong>"+time.split(" ")[0].replace(/\//g,".")+"</strong> has existed <strong>" + dnum + "</strong> d <strong>" + hnum + "</strong> h <strong>" + mnum + "</strong> m <strong>" + snum + "</strong> s！❤️";
        }var now = new Date();setInterval("createTime('2022/1/21 00:00:00')", 250,"");</script><br></span><div class="size-small"><span>❤️Thx <strong><span id="busuanzi_value_site_uv">99+</span></strong> users <strong><span id="busuanzi_value_site_pv">99+</span></strong> visited！❤️</span></div></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/removeif/hexo-theme-amazing"><i class="fab fa-github"></i></a></p></div><div class="sideMusic"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="/js/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script><meting-js style="width: auto;height: 2000px;" server="netease" type="playlist" id="137510737" theme="#2980b9" loop="all" autoplay="false" order="list" storageName="aplayer-setting" lrctype="0" list-max-height="400px" fixed="true"></meting-js></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><script src="/js/main.js" defer></script><script>$.getScript('/js/comment-issue-data.js',function(){loadIssueData('46a9f3481b46ea0129d8','79c7c9cb847e141757d7864453bcbf89f0655b24','Curator-Kim','blog_comment',false);})</script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.js"></script><script type="text/javascript">var pjax = new Pjax({
            elements: "a",//代表点击链接就更新
            selectors: [  //代表要更新的节点
                ".section",
                "title"
            ],
            cache: true,
            cacheBust:false
        })

        function loadBusuanzi(){
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js", function () {});
        }

        function loadMathJax() { //加载mathjax
            $.getScript("//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML", function () {
                MathJax.Hub.Config({ tex2jax: { inlineMath: [['$', '$'], ['\(', '\)']] } });
                var math = document.getElementsByClassName("entry-content")[0];
                MathJax.Hub.Queue(["Typeset", MathJax.Hub, math]);
            });
        };

        // 开始 PJAX 执行的函数
        document.addEventListener('pjax:send', function () {
        });
        
        // PJAX 完成之后执行的函数，可以和上面的重载放在一起
        document.addEventListener('pjax:complete', function () {
            $(".section").css({opacity:1});
            if(false){
                $.getScript('/js/comment-issue-data.js',function(){loadIssueData('46a9f3481b46ea0129d8','79c7c9cb847e141757d7864453bcbf89f0655b24','Curator-Kim','blog_comment',false);});
            }
            if(false){
                loadMathJax();
            }
            loadMainJs(jQuery, window.moment, window.ClipboardJS, window.IcarusThemeSettings);
            loadBackTop();
            loadBusuanzi();
            if(typeof loadBanner == 'function'){
                loadBanner();
            }
        });</script></body></html>