<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Reverse 7 - Curator-Kim的小站</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Curator-Kim的小站"><meta name="msapplication-TileImage" content="https://cdn.jsdelivr.net/gh/removeif/removeif-demo@latest/img/favicon.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Curator-Kim的小站"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="[TOC]"><meta property="og:type" content="blog"><meta property="og:title" content="Curator-Kim"><meta property="og:url" content="https://curator-kim.github.io/"><meta property="og:site_name" content="Curator-Kim"><meta property="og:description" content="[TOC]"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://curator-kim.github.io/img/icon.jpg"><meta property="article:published_time" content="2022-05-27T02:19:27.000Z"><meta property="article:modified_time" content="2022-06-21T06:33:59.036Z"><meta property="article:author" content="Curator-Kim"><meta property="article:tag" content="CTF"><meta property="article:tag" content="Reverse"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/icon.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://curator-kim.github.io/2022/05/27/Reverse-7/"},"headline":"Curator-Kim的小站","image":["http://curator-kim.github.io/2022/05/27/Reverse-7/image-20220507200201619.png","http://curator-kim.github.io/2022/05/27/Reverse-7/image-20220507200239324.png","http://curator-kim.github.io/2022/05/27/Reverse-7/image-20220507155120187.png","http://curator-kim.github.io/2022/05/27/Reverse-7/image-20220510195215506.png","http://curator-kim.github.io/2022/05/27/Reverse-7/image-20220528160552459.png","http://curator-kim.github.io/2022/05/27/Reverse-7/image-20220528160800200.png","http://curator-kim.github.io/2022/05/27/Reverse-7/image-20220510205116532.png","http://curator-kim.github.io/2022/05/27/Reverse-7/image-20220510205150477.png","http://curator-kim.github.io/2022/05/27/Reverse-7/image-20220511112512620.png","http://curator-kim.github.io/2022/05/27/Reverse-7/image-20220518163305874.png","http://curator-kim.github.io/2022/05/27/Reverse-7/image-20220518163424882.png","http://curator-kim.github.io/2022/05/27/Reverse-7/image-20220518163630410.png","http://curator-kim.github.io/2022/05/27/Reverse-7/image-20220518163913162.png","http://curator-kim.github.io/2022/05/27/Reverse-7/image-20220518164217000.png","http://curator-kim.github.io/2022/05/27/Reverse-7/image-20220518164338069.png","http://curator-kim.github.io/2022/05/27/Reverse-7/image-20220519155314534.png","http://curator-kim.github.io/2022/05/27/Reverse-7/image-20220519155402267.png","http://curator-kim.github.io/2022/05/27/Reverse-7/image-20220519162329377.png","http://curator-kim.github.io/2022/05/27/Reverse-7/image-20220519171806342.png","http://curator-kim.github.io/2022/05/27/Reverse-7/image-20220520164811489.png","http://curator-kim.github.io/2022/05/27/Reverse-7/image-20220520164627752.png","http://curator-kim.github.io/2022/05/27/Reverse-7/image-20220520164635309.png","http://curator-kim.github.io/2022/05/27/Reverse-7/image-20220520164644647.png","http://curator-kim.github.io/2022/05/27/Reverse-7/image-20220520163047206.png","http://curator-kim.github.io/2022/05/27/Reverse-7/image-20220527154558056.png","http://curator-kim.github.io/2022/05/27/Reverse-7/image-20220527155009034.png","http://curator-kim.github.io/2022/05/27/Reverse-7/image-20220527164919681.png","http://curator-kim.github.io/2022/05/27/Reverse-7/image-20220527170000216.png","http://curator-kim.github.io/2022/05/27/Reverse-7/image-20220527172908880.png","http://curator-kim.github.io/2022/05/27/Reverse-7/image-20220527172954733.png","http://curator-kim.github.io/2022/05/27/Reverse-7/image-20220528212151886.png","http://curator-kim.github.io/2022/05/27/Reverse-7/image-20220528212810447.png","http://curator-kim.github.io/2022/05/27/Reverse-7/image-20220528212837593.png","http://curator-kim.github.io/2022/05/27/Reverse-7/image-20220528213341784.png","http://curator-kim.github.io/2022/05/27/Reverse-7/image-20220528222429471.png","http://curator-kim.github.io/2022/05/27/Reverse-7/image-20220528234545090.png","http://curator-kim.github.io/2022/05/27/Reverse-7/image-20220621143123237.png"],"datePublished":"2022-05-27T02:19:27.000Z","dateModified":"2022-06-21T06:33:59.036Z","author":{"@type":"Person","name":"Curator-Kim"},"description":"[TOC]"}</script><link rel="canonical" href="http://curator-kim.github.io/2022/05/27/Reverse-7/"><link rel="icon" href="https://cdn.jsdelivr.net/gh/removeif/removeif-demo@latest/img/favicon.png"><meta name="referrer" content="no-referrer-when-downgrade"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css?family=Ubuntu:400,600|Source+Code+Pro|Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Microsoft YaHei:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&amp;amp;subset=latin,latin-ext|Inconsolata|Itim|Lobster.css"><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="/js/globalUtils.js"></script><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/pace/1.0.2/pace.min.js"></script><link rel="stylesheet" href="/live2d/waifu.css"><script type="text/javascript" async src="/live2d/autoload.js"></script><meta name="generator" content="Hexo 5.4.0"></head><body class="is-3-column has-navbar-fixed-top"><nav class="navbar navbar-main is-fixed-top"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="https://github.com/Curator-Kim/Curator-Kim.github.io/blob/master/img/logo.png?raw=true" alt="Curator-Kim的小站" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a><a class="navbar-item" href="/album">Album</a><a class="navbar-item" href="/friend">Friend</a><a class="navbar-item" href="/message">Message</a><a class="navbar-item" href="/self-talking">Self-talking</a><a class="navbar-item" href="/music">Music</a><a class="navbar-item" href="/media">Media</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Join Gitter" href="https://gitter.im/hexo-theme-amazing/community"><i class="fab fa-gitter"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/removeif/hexo-theme-amazing"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a><a class="navbar-item" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a></div></div></div></nav><script type="text/javascript" src="/js/theme-setting.js"></script><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><!--!--><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2022-05-27  <a class="commentCountImg" href="/2022/05/27/Reverse-7/#comment-container"><span class="display-none-class">ad4f58255f00fc0a0e3d0293eb3011df</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="ad4f58255f00fc0a0e3d0293eb3011df">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>28 m  <i class="fas fa-pencil-alt"> </i>4.2 k</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>&nbsp;visits</span></div></div><h1 class="title is-3 is-size-4-mobile">Reverse 7</h1><div class="content"><p>[TOC]</p>
<span id="more"></span>
<h3 id="GKCTF-2021-SoMuchCode"><a href="#GKCTF-2021-SoMuchCode" class="headerlink" title="[GKCTF 2021]SoMuchCode"></a>[GKCTF 2021]SoMuchCode</h3><p>动调是个好东西</p>
<p>动调定位到输入和输出函数，然后在1209行找到关键的encrypt函数</p>
<img src="/2022/05/27/Reverse-7/image-20220507200201619.png" class title="image-20220507200201619">
<p>点进行，按x查看引用，能大概看出是个XTEA算法</p>
<img src="/2022/05/27/Reverse-7/image-20220507200239324.png" class title="image-20220507200239324">
<p>循环12轮</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">*input += ((key[(v75 &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>] ^ input[<span class="number">7</span>]) + (input[<span class="number">1</span>] ^ v75)) ^ (((<span class="number">16</span> * input[<span class="number">7</span>]) ^ (input[<span class="number">1</span>] &gt;&gt; <span class="number">3</span>)) + ((input[<span class="number">7</span>] &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * input[<span class="number">1</span>])));</span><br><span class="line">input[<span class="number">1</span>] += (((key[v120] ^ input[<span class="number">0</span>]) + (input[<span class="number">2</span>] ^ v75)) ^ (((<span class="number">16</span> * input[<span class="number">0</span>]) ^ (input[<span class="number">2</span>] &gt;&gt; <span class="number">3</span>))+ ((input[<span class="number">0</span>] &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * input[<span class="number">2</span>]))));</span><br><span class="line">input[<span class="number">2</span>] += + ((((<span class="number">16</span> * input[<span class="number">1</span>]) ^ (input[<span class="number">3</span>] &gt;&gt; <span class="number">3</span>)) + ((input[<span class="number">1</span>] &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * input[<span class="number">3</span>]))) ^ ((input[<span class="number">3</span>] ^ v75) + (key[v123] ^ input[<span class="number">1</span>])));</span><br><span class="line">input[<span class="number">3</span>] += + ((((<span class="number">16</span> * input[<span class="number">2</span>]) ^ (input[<span class="number">4</span>] &gt;&gt; <span class="number">3</span>)) + ((input[<span class="number">2</span>] &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * input[<span class="number">4</span>]))) ^ ((input[<span class="number">4</span>] ^ v75) + (key[v115 ^ <span class="number">3</span>] ^ input[<span class="number">2</span>])));</span><br><span class="line">input[<span class="number">4</span>]=input[<span class="number">4</span>] + ((((<span class="number">16</span> * input[<span class="number">3</span>]) ^ (input[<span class="number">5</span>] &gt;&gt; <span class="number">3</span>)) + ((input[<span class="number">3</span>] &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * input[<span class="number">5</span>]))) ^ ((input[<span class="number">5</span>] ^ v75) + (key[v99] ^ input[<span class="number">3</span>])));</span><br><span class="line">input[<span class="number">5</span>]=(((key[v120] ^ input[<span class="number">4</span>]) + (input[<span class="number">6</span>] ^ v75)) ^ (((<span class="number">16</span> * input[<span class="number">4</span>]) ^ (input[<span class="number">6</span>] &gt;&gt; <span class="number">3</span>))+ ((input[<span class="number">4</span>] &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * input[<span class="number">6</span>]))))+ v127</span><br><span class="line">input[<span class="number">6</span>]+= ((((<span class="number">16</span> * input[<span class="number">5</span>]) ^ (input[<span class="number">7</span>] &gt;&gt; <span class="number">3</span>)) + ((input[<span class="number">5</span>] &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * input[<span class="number">7</span>]))) ^ ((key[v123] ^ input[<span class="number">5</span>])+ (input[<span class="number">7</span>] ^ v75)));</span><br><span class="line">input[<span class="number">7</span>] += ((input[<span class="number">6</span>]&gt;&gt;<span class="number">5</span>)+(input[<span class="number">0</span>]*<span class="number">4</span>) + ((input[<span class="number">0</span>] &gt;&gt; <span class="number">3</span>) ^ (<span class="number">16</span> * input[<span class="number">6</span>]))) ^ ((input[<span class="number">0</span>] ^ v75) + (key[v210] ^ input[<span class="number">6</span>]));</span><br></pre></td></tr></table></figure>
<p>每轮加密过程如以下形式，v75可以推测是sum值，动调出来发现每轮自增0x33445566</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">input[x] += + ((((16 * input[x-1]) ^ (input[x+1] &gt;&gt; 3)) + ((input[x-1] &gt;&gt; 5) ^ (4 * input[x+1]))) ^ ((input[x+1] ^ v75) + (key[?] ^ input[1])));</span><br></pre></td></tr></table></figure>
<p>动调找到key</p>
<img src="/2022/05/27/Reverse-7/image-20220507155120187.png" class title="image-20220507155120187">
<p>动调找到要对比的数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">.data:00007FF6C82CA6D0 byte_7FF6C82CA6D0 db 5Ch                ; DATA XREF: main+F69↑w</span><br><span class="line">.data:00007FF6C82CA6D0                                         ; main:loc_7FF6C82C3945↑w ...</span><br><span class="line">.data:00007FF6C82CA6D1 byte_7FF6C82CA6D1 db 0ABh               ; DATA XREF: main+1119↑w</span><br><span class="line">.data:00007FF6C82CA6D1                                         ; main:loc_7FF6C82C3AF5↑w</span><br><span class="line">.data:00007FF6C82CA6D2 byte_7FF6C82CA6D2 db 3Ch                ; DATA XREF: main+12C9↑w</span><br><span class="line">.data:00007FF6C82CA6D2                                         ; main:loc_7FF6C82C3CA5↑w</span><br><span class="line">.data:00007FF6C82CA6D3 byte_7FF6C82CA6D3 db 99h                ; DATA XREF: main+147A↑w</span><br><span class="line">.data:00007FF6C82CA6D3                                         ; main:loc_7FF6C82C3E56↑w</span><br><span class="line">.data:00007FF6C82CA6D4 byte_7FF6C82CA6D4 db 29h                ; DATA XREF: main:loc_7FF6C82C3F1F↑w</span><br><span class="line">.data:00007FF6C82CA6D5 byte_7FF6C82CA6D5 db 0E1h               ; DATA XREF: main:loc_7FF6C82C3FEF↑w</span><br><span class="line">.data:00007FF6C82CA6D6 byte_7FF6C82CA6D6 db 40h                ; DATA XREF: main:loc_7FF6C82C40BF↑w</span><br><span class="line">.data:00007FF6C82CA6D7 byte_7FF6C82CA6D7 db 3Fh                ; DATA XREF: main:loc_7FF6C82C418F↑w</span><br><span class="line">.data:00007FF6C82CA6D8 byte_7FF6C82CA6D8 db 0DEh               ; DATA XREF: main:loc_7FF6C82C425F↑w</span><br><span class="line">.data:00007FF6C82CA6D9 byte_7FF6C82CA6D9 db 91h                ; DATA XREF: main:loc_7FF6C82C432F↑w</span><br><span class="line">.data:00007FF6C82CA6DA byte_7FF6C82CA6DA db 77h                ; DATA XREF: main:loc_7FF6C82C43FF↑w</span><br><span class="line">.data:00007FF6C82CA6DB byte_7FF6C82CA6DB db 77h                ; DATA XREF: main:loc_7FF6C82C44CF↑w</span><br><span class="line">.data:00007FF6C82CA6DC byte_7FF6C82CA6DC db 0A6h               ; DATA XREF: main:loc_7FF6C82C459F↑w</span><br><span class="line">.data:00007FF6C82CA6DD byte_7FF6C82CA6DD db 0FEh               ; DATA XREF: main:loc_7FF6C82C466F↑w</span><br><span class="line">.data:00007FF6C82CA6DE byte_7FF6C82CA6DE db 7Dh                ; DATA XREF: main:loc_7FF6C82C473F↑w</span><br><span class="line">.data:00007FF6C82CA6DF byte_7FF6C82CA6DF db 73h                ; DATA XREF: main:loc_7FF6C82C480F↑w</span><br><span class="line">.data:00007FF6C82CA6E0 byte_7FF6C82CA6E0 db 0E6h               ; DATA XREF: main:loc_7FF6C82C48DF↑w</span><br><span class="line">.data:00007FF6C82CA6E1 byte_7FF6C82CA6E1 db 59h                ; DATA XREF: main:loc_7FF6C82C49AF↑w</span><br><span class="line">.data:00007FF6C82CA6E2 byte_7FF6C82CA6E2 db 0CFh               ; DATA XREF: main:loc_7FF6C82C4A7F↑w</span><br><span class="line">.data:00007FF6C82CA6E3 byte_7FF6C82CA6E3 db 0ECh               ; DATA XREF: main:loc_7FF6C82C4B4F↑w</span><br><span class="line">.data:00007FF6C82CA6E4 byte_7FF6C82CA6E4 db 0E3h               ; DATA XREF: main:loc_7FF6C82C4C1F↑w</span><br><span class="line">.data:00007FF6C82CA6E5 byte_7FF6C82CA6E5 db 4Ch                ; DATA XREF: main:loc_7FF6C82C4CEF↑w</span><br><span class="line">.data:00007FF6C82CA6E6 byte_7FF6C82CA6E6 db 60h                ; DATA XREF: main:loc_7FF6C82C4DBF↑w</span><br><span class="line">.data:00007FF6C82CA6E7 byte_7FF6C82CA6E7 db 0C9h               ; DATA XREF: main:loc_7FF6C82C4E8F↑w</span><br><span class="line">.data:00007FF6C82CA6E8 byte_7FF6C82CA6E8 db 0A5h               ; DATA XREF: main:loc_7FF6C82C4F5F↑w</span><br><span class="line">.data:00007FF6C82CA6E9 byte_7FF6C82CA6E9 db 0C0h               ; DATA XREF: main:loc_7FF6C82C502F↑w</span><br><span class="line">.data:00007FF6C82CA6EA byte_7FF6C82CA6EA db 82h                ; DATA XREF: main:loc_7FF6C82C50FF↑w</span><br><span class="line">.data:00007FF6C82CA6EB byte_7FF6C82CA6EB db 96h                ; DATA XREF: main:loc_7FF6C82C526C↑w</span><br><span class="line">.data:00007FF6C82CA6EC byte_7FF6C82CA6EC db 1Eh                ; DATA XREF: main:loc_7FF6C82C53D9↑w</span><br><span class="line">.data:00007FF6C82CA6ED byte_7FF6C82CA6ED db 2Ah                ; DATA XREF: main:loc_7FF6C82C5546↑w</span><br><span class="line">.data:00007FF6C82CA6EE byte_7FF6C82CA6EE db 6Fh                ; DATA XREF: main:loc_7FF6C82C56B3↑w</span><br><span class="line">.data:00007FF6C82CA6EF byte_7FF6C82CA6EF db 55h                ; DATA XREF: main:loc_7FF6C82C5820↑w</span><br></pre></td></tr></table></figure>
<p>写出解题脚本：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">decipher</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> num_rounds, <span class="keyword">unsigned</span> <span class="keyword">int</span> input[<span class="number">8</span>], <span class="keyword">unsigned</span> <span class="keyword">int</span> key[<span class="number">4</span>])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> delta=<span class="number">0x33445566</span>, sum=delta*num_rounds;</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i &lt; num_rounds; i++) &#123;</span><br><span class="line">        input[<span class="number">7</span>]-= ((((<span class="number">16</span> * input[<span class="number">6</span>]) ^ (input[<span class="number">0</span>] &gt;&gt; <span class="number">3</span>)) + ((input[<span class="number">6</span>] &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * input[<span class="number">0</span>]))) ^ ((input[<span class="number">0</span>] ^ sum) + (key[((sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>)^<span class="number">3</span>] ^ input[<span class="number">6</span>])));</span><br><span class="line">        input[<span class="number">6</span>]-= ((((<span class="number">16</span> * input[<span class="number">5</span>]) ^ (input[<span class="number">7</span>] &gt;&gt; <span class="number">3</span>)) + ((input[<span class="number">5</span>] &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * input[<span class="number">7</span>]))) ^ ((key[((sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>)^<span class="number">2</span>] ^ input[<span class="number">5</span>])+ (input[<span class="number">7</span>] ^ sum)));</span><br><span class="line">        input[<span class="number">5</span>]-= ((((<span class="number">16</span> * input[<span class="number">4</span>]) ^ (input[<span class="number">6</span>] &gt;&gt; <span class="number">3</span>)) + ((input[<span class="number">4</span>] &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * input[<span class="number">6</span>]))) ^ ((key[((sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>)^<span class="number">1</span>] ^ input[<span class="number">4</span>]) + (input[<span class="number">6</span>] ^ sum)) );</span><br><span class="line">		input[<span class="number">4</span>]-= ((((<span class="number">16</span> * input[<span class="number">3</span>]) ^ (input[<span class="number">5</span>] &gt;&gt; <span class="number">3</span>)) + ((input[<span class="number">3</span>] &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * input[<span class="number">5</span>]))) ^ ((input[<span class="number">5</span>] ^ sum) + (key[(sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>] ^ input[<span class="number">3</span>])));</span><br><span class="line">		input[<span class="number">3</span>]-= ((((<span class="number">16</span> * input[<span class="number">2</span>]) ^ (input[<span class="number">4</span>] &gt;&gt; <span class="number">3</span>)) + ((input[<span class="number">2</span>] &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * input[<span class="number">4</span>]))) ^ ((input[<span class="number">4</span>] ^ sum) + (key[((sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>) ^ <span class="number">3</span>] ^ input[<span class="number">2</span>])));</span><br><span class="line">		input[<span class="number">2</span>]-= ((((<span class="number">16</span> * input[<span class="number">1</span>]) ^ (input[<span class="number">3</span>] &gt;&gt; <span class="number">3</span>)) + ((input[<span class="number">1</span>] &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * input[<span class="number">3</span>]))) ^ ((input[<span class="number">3</span>] ^ sum) + (key[((sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>)^<span class="number">2</span>] ^ input[<span class="number">1</span>])));</span><br><span class="line">		input[<span class="number">1</span>]-= ((((<span class="number">16</span> * input[<span class="number">0</span>]) ^ (input[<span class="number">2</span>] &gt;&gt; <span class="number">3</span>)) + ((input[<span class="number">0</span>] &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * input[<span class="number">2</span>]))) ^ ((key[((sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>)^<span class="number">1</span>] ^ input[<span class="number">0</span>]) + (input[<span class="number">2</span>] ^ sum)));</span><br><span class="line">		input[<span class="number">0</span>]-= ((((<span class="number">16</span> * input[<span class="number">7</span>]) ^ (input[<span class="number">1</span>] &gt;&gt; <span class="number">3</span>)) + ((input[<span class="number">7</span>] &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * input[<span class="number">1</span>]))) ^ ((key[(sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>] ^ input[<span class="number">7</span>]) + (input[<span class="number">1</span>] ^ sum))) ;</span><br><span class="line">		sum -= delta;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> v[<span class="number">8</span>]=&#123;<span class="number">0x993cab5c</span>,<span class="number">0x3f40e129</span>,<span class="number">0x777791de</span>,<span class="number">0x737dfea6</span>,<span class="number">0xeccf59e6</span>,<span class="number">0xc9604ce3</span>,<span class="number">0x9682c0a5</span>,<span class="number">0x556f2a1e</span>&#125;;</span><br><span class="line">	<span class="comment">//unsigned int v[8]=&#123;0x5cab3c99,0x29e1403f,0xde917777,0xa6fe7d73,0xe659cfec,0xe34c60c9,0xa5c08296,0x1e2a6f55&#125;;</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> k[<span class="number">4</span>]=&#123;<span class="number">0x36b0</span>,<span class="number">0x13816</span>,<span class="number">0x10</span>,<span class="number">0x1e0f3</span>&#125;;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> r=<span class="number">12</span>;<span class="comment">//num_rounds建议取值为32</span></span><br><span class="line">    <span class="comment">// v为要加密的数据是两个32位无符号整数</span></span><br><span class="line">    <span class="comment">// k为加密解密密钥，为4个32位无符号整数，即密钥长度为128位</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;加密前原始数据：%x %x\n&quot;</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    decipher(r, v, k);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;解密后的数据：%s\n&quot;</span>,v);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>GKCTF{9b34a61df773acf0e4dec25ea5fb0e29}</p>
<h3 id="GKCTF-2021-app-debug"><a href="#GKCTF-2021-app-debug" class="headerlink" title="[GKCTF 2021]app-debug"></a>[GKCTF 2021]app-debug</h3><p>一开始用jadx打开，进到mainActivity，有个关键的check函数没有出来，看了网上的wp才知道引用了外部库</p>
<p>IDA打开，发现有.so文件</p>
<img src="/2022/05/27/Reverse-7/image-20220510195215506.png" class title="image-20220510195215506">
<p>进去后搜索main，进到关键加密函数，是一个TEA加密的结构</p>
<img src="/2022/05/27/Reverse-7/image-20220528160552459.png" class title="image-20220528160552459">
<p>但是其中key的值是假的，程序通过TracerPid进行反调试，通过寻找交叉引用可以找到真正的key</p>
<blockquote>
<p><strong>当我们使用IDA attach程序的时候，在/proc/{PID}/status文件的TracerPid字段会写入调试程序的PID</strong></p>
<p><strong>也就是说使用TracerPid反调试的原理就是检测这个字段是否为0，为0说明没有被调试，不为0说明正在被调试，检测调试器直接退出就可以达到反调试的效果</strong></p>
<p>作者：Sharkchilli<br>链接：<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/cae682a27f0c">https://www.jianshu.com/p/cae682a27f0c</a><br><img src="/2022/05/27/Reverse-7/image-20220528160800200.png" class title="image-20220528160800200"></p>
</blockquote>
<h3 id="RCTF2019-DontEatMe"><a href="#RCTF2019-DontEatMe" class="headerlink" title="[RCTF2019]DontEatMe"></a>[RCTF2019]DontEatMe</h3><p>发现存在反调试，把17改为16绕过</p>
<img src="/2022/05/27/Reverse-7/image-20220510205116532.png" class title="image-20220510205116532">
<img src="/2022/05/27/Reverse-7/image-20220510205150477.png" class title="image-20220510205150477">
<p>测试输入：0123456798abcdef0123456798abcdef</p>
<p>分析一下程序的流程，大致是获取十六进制输入，对输入做加密，然后生成迷宫，走迷宫</p>
<p>从迷宫开始分析，大致就是先给某个数据段附了值，然后将该数据段与某一串数据进行异或，异或后的值转为二进制来生成迷宫</p>
<img src="/2022/05/27/Reverse-7/image-20220511112512620.png" class title="image-20220511112512620">
<p>将生成后的迷宫放出来：(s为起点，e为终点)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 </span><br><span class="line">1 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 </span><br><span class="line">1 0 1 1 1 1 1 1 1 0 1 1 1 1 1 1</span><br><span class="line">1 0 1 1 1 1 1 1 1 0 1 1 1 1 1 1</span><br><span class="line">1 0 1 1 1 1 0 0 0 e 0 0 0 1 1 1</span><br><span class="line">1 0 1 1 1 1 0 1 1 1 1 1 0 1 1 1</span><br><span class="line">1 0 1 1 1 1 0 1 1 1 1 1 0 1 1 1</span><br><span class="line">1 0 1 1 1 1 0 0 0 0 1 1 0 1 1 1</span><br><span class="line">1 0 1 1 1 1 1 1 1 0 1 1 0 1 1 1</span><br><span class="line">1 0 1 1 1 1 1 1 1 0 1 1 0 1 1 1</span><br><span class="line">1 0 0 0 0 s 0 0 0 0 1 1 0 1 1 1</span><br><span class="line">1 1 1 1 1 0 1 1 1 1 1 1 0 1 1 1</span><br><span class="line">1 1 1 1 1 0 0 0 0 0 0 0 0 1 1 1</span><br><span class="line">1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span><br><span class="line">1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span><br><span class="line">1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span><br></pre></td></tr></table></figure>
<p>迷宫路径：ddddwwwaaawwwddd</p>
<p>然后要做的就是解密了</p>
<p>中间的解密算法了解了一下才知道是BLOWFISH加密算法</p>
<p>flag{db824ef8605c5235b4bbacfa2ff8e087}</p>
<h3 id="SUSCTF-2022-hell-world"><a href="#SUSCTF-2022-hell-world" class="headerlink" title="[SUSCTF 2022]hell_world"></a>[SUSCTF 2022]hell_world</h3><p>参考<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1H34y187ae?spm_id_from=333.999.0.0">【SUSCTF2022】DigitalCircuits &amp; hell_world &amp; tttree去花_哔哩哔哩_bilibili</a></p>
<p>IDA64打开，可以发现有很多函数，其中有大量代码，难以入手</p>
<img src="/2022/05/27/Reverse-7/image-20220518163305874.png" class title="image-20220518163305874">
<p>shift+f12搜索字符串，查找flag，交叉引用进到相关函数中，可以发现一个类似虚拟机的东西</p>
<img src="/2022/05/27/Reverse-7/image-20220518163424882.png" class title="image-20220518163424882">
<p>动调，case0执行完并没有输出其中的字符串”Input Flag:”，猜测只是将字符串加载到缓冲区中</p>
<img src="/2022/05/27/Reverse-7/image-20220518163630410.png" class title="image-20220518163630410">
<p>case1执行完后，”Input Flag”被输出，猜测该部分作用为输出缓冲区内容</p>
<img src="/2022/05/27/Reverse-7/image-20220518163913162.png" class title="image-20220518163913162">
<p>在case2中单步调试时停止不动，开始输入，可知该部分作用为获得输入</p>
<img src="/2022/05/27/Reverse-7/image-20220518164217000.png" class title="image-20220518164217000">
<p>而case2运行完后接着运行case3，其中v2=5时进入case 5，case 5中”Wrong”提示不能进入该部分，同时猜测该case3作用为判断输入长度</p>
<img src="/2022/05/27/Reverse-7/image-20220518164338069.png" class title="image-20220518164338069">
<p>接下来的流程为case9 -&gt; case10 -&gt; case11-&gt;case10-&gt;case11-&gt;case10…</p>
<p>而case10为加密块，case11为验证块，提取出其中的数组，做异或即可得到flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">a=[<span class="number">0x56</span>,<span class="number">0x0DA</span>,<span class="number">0x0CD</span>,<span class="number">0x3A</span>,<span class="number">0x7E</span>,<span class="number">0x86</span>,<span class="number">0x13</span>,<span class="number">0x0B5</span>,<span class="number">0x1D</span>,<span class="number">0x9D</span>,<span class="number">0x0FC</span>,<span class="number">0x97</span>,<span class="number">0x8C</span>,</span><br><span class="line"><span class="number">0x31</span>,<span class="number">0x6B</span>,<span class="number">0x0C9</span>,<span class="number">0x0FB</span>,<span class="number">0x1A</span>,<span class="number">0x0E2</span>,<span class="number">0x2D</span>,<span class="number">0x0DC</span>,<span class="number">0x0D3</span>,<span class="number">0x0F1</span>,<span class="number">0x0F4</span>,<span class="number">0x36</span>,<span class="number">0x9</span>,</span><br><span class="line"><span class="number">0x20</span>,<span class="number">0x42</span>,<span class="number">0x4</span>,<span class="number">0x6A</span>,<span class="number">0x71</span>,<span class="number">0x53</span>,<span class="number">0x78</span>,<span class="number">0x0A4</span>,<span class="number">0x97</span>,<span class="number">0x8F</span>,<span class="number">0x7A</span>,<span class="number">0x72</span>,<span class="number">0x39</span>,<span class="number">0x0E8</span>,</span><br><span class="line"><span class="number">0x3D</span>,<span class="number">0x0FA</span>,<span class="number">0x40</span>,<span class="number">0x3D</span>]</span><br><span class="line">b=[<span class="number">0x5</span>,<span class="number">0x8F</span>,<span class="number">0x9E</span>,<span class="number">0x79</span>,<span class="number">0x2A</span>,<span class="number">0x0C0</span>,<span class="number">0x68</span>,<span class="number">0x81</span>,<span class="number">0x2D</span>,<span class="number">0x0FC</span>,<span class="number">0x0CF</span>,<span class="number">0x0A4</span>,<span class="number">0x0B5</span>,</span><br><span class="line"><span class="number">0x55</span>,<span class="number">0x5F</span>,<span class="number">0x0E4</span>,<span class="number">0x9D</span>,<span class="number">0x23</span>,<span class="number">0x0D6</span>,<span class="number">0x1D</span>,<span class="number">0x0F1</span>,<span class="number">0x0E7</span>,<span class="number">0x97</span>,<span class="number">0x91</span>,<span class="number">0x6</span>,<span class="number">0x24</span>,<span class="number">0x42</span>,</span><br><span class="line"><span class="number">0x71</span>,<span class="number">0x3C</span>,<span class="number">0x58</span>,<span class="number">0x5C</span>,<span class="number">0x30</span>,<span class="number">0x19</span>,<span class="number">0x0C6</span>,<span class="number">0x0F5</span>,<span class="number">0x0BC</span>,<span class="number">0x4B</span>,<span class="number">0x42</span>,<span class="number">0x5D</span>,<span class="number">0x0DA</span>,</span><br><span class="line"><span class="number">0x58</span>,<span class="number">0x9B</span>,<span class="number">0x24</span>,<span class="number">0x40</span>]</span><br><span class="line">s=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">    s+=<span class="built_in">chr</span>(a[i]^b[i])</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"><span class="comment"># SUSCTF&#123;40a339d4-f940-4fe0-b382-cabb310d2ead&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="CFI-CTF-2018-Automated-Reversing"><a href="#CFI-CTF-2018-Automated-Reversing" class="headerlink" title="[CFI-CTF 2018]Automated Reversing"></a>[CFI-CTF 2018]Automated Reversing</h3><p>下载附件，得到一堆elf文件</p>
<img src="/2022/05/27/Reverse-7/image-20220519155314534.png" class title="image-20220519155314534">
<p>拖进IDA里，只有汇编代码，不过逻辑还是挺简单的，只是做了加减、异或的操作，然后与一个数比较</p>
<img src="/2022/05/27/Reverse-7/image-20220519155402267.png" class title="image-20220519155402267">
<p>那么我们可以做逆操作，利用固定偏移量依次提取出操作符、操作值和比较值，进行逆计算获取这些预期字符，看看它们是什么，然后就出flag了</p>
<p>下载的附件中含有生成代码和解题代码，这里附上</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># generator.py</span></span><br><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">text = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula dolor. Aenean massa. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Donec quam felis, ultricies nec, pellentesque eu, pretium quis, sem. Nulla consequat massa quis enim. Donec pede justo, fringilla vel, aliquet nec, vulputate eget, arcu. In enim justo, rhoncus ut, imperdiet a, venenatis vitae, justo. Nullam dictum felis eu pede mollis pretium. Integer tincidunt. Cras dapibus. The flag is CFI&#123;1s_th1s_4_pr0g_ch4ll_0r_4_r3ve3se_ch4ll?&#125;. Aenean vulputate eleifend tellus. Aenean leo ligula, porttitor eu, consequat vitae, eleifend ac, enim. I stole this idea directly from Defcon Quals 2016. Phasellus viverra nulla ut metus varius laoreet. Quisque rutrum. Aenean imperdiet. Etiam ultricies nisi vel augue. Curabitur ullamcorper ultricies nisi. Nam eget dui. Etiam rhoncus. Maecenas tempus, tellus eget condimentum rhoncus, sem quam semper libero, sit amet adipiscing sem neque sed ipsum.</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i, c <span class="keyword">in</span> <span class="built_in">enumerate</span>(text):</span><br><span class="line">    operator = [<span class="string">&quot;xor&quot;</span>, <span class="string">&quot;sub&quot;</span>, <span class="string">&quot;add&quot;</span>][randint(<span class="number">0</span>, <span class="number">2</span>)]</span><br><span class="line">	key = randint(<span class="number">1</span>, <span class="number">100</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> operator == <span class="string">&quot;xor&quot;</span>:</span><br><span class="line">            check = (<span class="built_in">ord</span>(c) ^ key) &amp; <span class="number">0xff</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> operator == <span class="string">&quot;sub&quot;</span>:</span><br><span class="line">            check = (<span class="built_in">ord</span>(c) - key) &amp; <span class="number">0xff</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> operator == <span class="string">&quot;add&quot;</span>:</span><br><span class="line">            check = (<span class="built_in">ord</span>(c) + key) &amp; <span class="number">0xff</span></span><br><span class="line"></span><br><span class="line">	code = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">		push 0</span></span><br><span class="line"><span class="string">		push 5</span></span><br><span class="line"><span class="string">		mov rdi, rsp</span></span><br><span class="line"><span class="string">		mov rax, 0x23</span></span><br><span class="line"><span class="string">		syscall</span></span><br><span class="line"><span class="string">		pop rax</span></span><br><span class="line"><span class="string">		pop rax</span></span><br><span class="line"><span class="string">		mov rax, [rsp + 0x10]</span></span><br><span class="line"><span class="string">		mov dl, byte ptr [rax]</span></span><br><span class="line"><span class="string">                &#123;&#125; dl, &#123;&#125;</span></span><br><span class="line"><span class="string">		cmp dl, &#123;&#125;</span></span><br><span class="line"><span class="string">		jne error</span></span><br><span class="line"><span class="string">		mov rdi, 0</span></span><br><span class="line"><span class="string">		mov rax, 0x3c</span></span><br><span class="line"><span class="string">		syscall</span></span><br><span class="line"><span class="string">		error:</span></span><br><span class="line"><span class="string">			mov rdi, 1</span></span><br><span class="line"><span class="string">			mov rax, 0x3c</span></span><br><span class="line"><span class="string">			syscall</span></span><br><span class="line"><span class="string">	&quot;&quot;&quot;</span>.<span class="built_in">format</span>(operator, key, check)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;binaries/binary&#123;&#125;&quot;</span>.<span class="built_in">format</span>(i), <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">		elf = make_elf(asm(code))</span><br><span class="line">		f.write(elf)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#solution.py</span></span><br><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1007</span>):</span><br><span class="line">    path = <span class="string">&quot;binaries/binaries/binary&#123;&#125;&quot;</span>.<span class="built_in">format</span>(i)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(path, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        binary = f.read()</span><br><span class="line">        operator = binary[<span class="number">0xca</span>]</span><br><span class="line">        key = binary[<span class="number">0xcb</span>]</span><br><span class="line">        check = binary[<span class="number">0xce</span>]</span><br><span class="line">        <span class="keyword">if</span> operator == <span class="number">0xc2</span>: <span class="comment"># add</span></span><br><span class="line">            flag += <span class="built_in">chr</span>((check - key) &amp; <span class="number">0xff</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">elif</span> operator == <span class="number">0xea</span>: <span class="comment"># sub</span></span><br><span class="line">            flag += <span class="built_in">chr</span>((check + key) &amp; <span class="number">0xff</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            flag += <span class="built_in">chr</span>(check ^ key)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="MRCTF2020-Virtual-tree"><a href="#MRCTF2020-Virtual-tree" class="headerlink" title="[MRCTF2020 Virtual_tree]"></a>[MRCTF2020 Virtual_tree]</h3><p>ida32打开，流程还是挺明白的</p>
<img src="/2022/05/27/Reverse-7/image-20220519162329377.png" class title="image-20220519162329377">
<p>中间存在花指令，修复掉</p>
<p>进到sub_401680中，类似一颗树的前序遍历，取其中的对输入字符串做异或加密</p>
<img src="/2022/05/27/Reverse-7/image-20220519171806342.png" class title="image-20220519171806342">
<p>动调提取出a1的数据：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MLGPOKFCJENIHDBA</span><br></pre></td></tr></table></figure>
<p>然后到sub_5F16F0，一开始以为一直调用的是sub_5f1510这个函数，只不过传入的参数每次都不一样</p>
<p>但实际上动调的时候我们可以发现，实际的函数是这样的…里面调用的函数被替换掉了</p>
<img src="/2022/05/27/Reverse-7/image-20220520164811489.png" class title="image-20220520164811489">
<p>实际上分别是一些加减、异或的操作</p>
<img src="/2022/05/27/Reverse-7/image-20220520164627752.png" class title="image-20220520164627752">
<img src="/2022/05/27/Reverse-7/image-20220520164635309.png" class title="image-20220520164635309">
<img src="/2022/05/27/Reverse-7/image-20220520164644647.png" class title="image-20220520164644647">
<p>接着逆即可,减法的时候需要注意绝对值的问题：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">a =[</span><br><span class="line">  <span class="number">0x17</span>, <span class="number">0x63</span>, <span class="number">0x77</span>, <span class="number">0x03</span>, <span class="number">0x52</span>, <span class="number">0x2E</span>, <span class="number">0x4A</span>, <span class="number">0x28</span>, <span class="number">0x52</span>, <span class="number">0x1B</span>, </span><br><span class="line">  <span class="number">0x17</span>, <span class="number">0x12</span>, <span class="number">0x3A</span>, <span class="number">0x0A</span>, <span class="number">0x6C</span>, <span class="number">0x62</span></span><br><span class="line">]</span><br><span class="line">a[<span class="number">15</span>]=(a[<span class="number">15</span>]-<span class="number">2</span>)%<span class="number">256</span></span><br><span class="line">a[<span class="number">14</span>]^=a[<span class="number">15</span>]</span><br><span class="line">a[<span class="number">12</span>]=(a[<span class="number">2</span>]-a[<span class="number">12</span>])%<span class="number">256</span></span><br><span class="line">a[<span class="number">11</span>]^=a[<span class="number">12</span>]</span><br><span class="line">a[<span class="number">10</span>]=(a[<span class="number">7</span>]-a[<span class="number">10</span>])%<span class="number">256</span></span><br><span class="line">a[<span class="number">9</span>]=(a[<span class="number">8</span>]-a[<span class="number">9</span>])%<span class="number">256</span></span><br><span class="line">a[<span class="number">8</span>]^=a[<span class="number">7</span>]</span><br><span class="line">a[<span class="number">7</span>]=(a[<span class="number">7</span>]-<span class="number">3</span>)%<span class="number">256</span></span><br><span class="line">a[<span class="number">6</span>]=a[<span class="number">1</span>]-a[<span class="number">6</span>]</span><br><span class="line">a[<span class="number">4</span>]^=a[<span class="number">5</span>]</span><br><span class="line">a[<span class="number">3</span>]=(a[<span class="number">7</span>]-a[<span class="number">3</span>]%<span class="number">256</span>)</span><br><span class="line">a[<span class="number">2</span>]=(a[<span class="number">2</span>]-<span class="number">7</span>)%<span class="number">256</span></span><br><span class="line">a[<span class="number">1</span>]^=a[<span class="number">2</span>]</span><br><span class="line">a[<span class="number">0</span>]=(a[<span class="number">0</span>]-<span class="number">10</span>)%<span class="number">256</span></span><br><span class="line">s=<span class="string">&#x27;MLGPOKFCJENIHDBA&#x27;</span></span><br><span class="line">f=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    f+=<span class="built_in">chr</span>(<span class="built_in">ord</span>(s[i])^a[i])</span><br><span class="line"><span class="built_in">print</span>(f)</span><br></pre></td></tr></table></figure>
<h5 id="一些去花小感想"><a href="#一些去花小感想" class="headerlink" title="一些去花小感想"></a>一些去花小感想</h5><p>这题去花指令的过程挺曲折的</p>
<img src="/2022/05/27/Reverse-7/image-20220520163047206.png" class title="image-20220520163047206">
<p>像这样的花指令，以往都是两条指令都nop掉，但实际上这样子操作是错误的，因为jump的时候跳到的还是下面的那条指令，只不过由于加了偏移量的关系，实际上执行的不是call xxxx这条指令，而是另一条指令，实际操作只需要将下面的指令nop一次，将余下的字节在重新整理为代码即可。</p>
<h3 id="羊城杯-2020-babyre"><a href="#羊城杯-2020-babyre" class="headerlink" title="[羊城杯 2020]babyre"></a>[羊城杯 2020]babyre</h3><p>下载文件，运行时会发现缺少了某个库而无法运行</p>
<img src="/2022/05/27/Reverse-7/image-20220527154558056.png" class title="image-20220527154558056">
<p>原因是缺少了libcrypto.so.1.0.0这个库，安装这个库即可，命令如下</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget http://archive.ubuntu.com/ubuntu/pool/main/o/openssl1.0/libssl1.0.0_1.0.2n-1ubuntu5.9_amd64.deb </span><br><span class="line">sudo dpkg -i libssl1.0.0_1.0.2n-1ubuntu5.9_amd64.deb</span><br></pre></td></tr></table></figure>
<p>然后就可以快乐动调了</p>
<p>动调得到密钥数据</p>
<img src="/2022/05/27/Reverse-7/image-20220527155009034.png" class title="image-20220527155009034">
<p>然后可以解main中的DES了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES</span><br><span class="line">target=[</span><br><span class="line">  <span class="number">0x0A</span>, <span class="number">0xF4</span>, <span class="number">0xEE</span>, <span class="number">0xC8</span>, <span class="number">0x42</span>, <span class="number">0x8A</span>, <span class="number">0x9B</span>, <span class="number">0xDB</span>, <span class="number">0xA2</span>, <span class="number">0x26</span>, </span><br><span class="line">  <span class="number">0x6F</span>, <span class="number">0xEE</span>, <span class="number">0xEE</span>, <span class="number">0xE0</span>, <span class="number">0xD8</span>, <span class="number">0xA2</span></span><br><span class="line">]</span><br><span class="line">cipher=<span class="string">b&#x27;\x0A\xF4\xEE\xC8\x42\x8A\x9B\xDB\xA2\x26\x6F\xEE\xEE\xE0\xD8\xA2&#x27;</span></span><br><span class="line">key=<span class="string">b&#x27;\xAD\x52\xF3\x4D\xE2\x2C\x20\xD6&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(key))</span><br><span class="line">cryptor=DES.new(key,DES.MODE_CBC,<span class="string">b&#x27;\x00\x00\x00\x00\x00\x00\x00\x00&#x27;</span>)</span><br><span class="line">m=cryptor.decrypt(cipher)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="comment"># th1s1sth3n1c3k3y</span></span><br></pre></td></tr></table></figure>
<p>把其中SMC的代码调出</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> __fastcall __noreturn <span class="title">sub_40272D</span><span class="params">(__int64 a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+18h] [rbp-128h]</span></span><br><span class="line">  <span class="keyword">int</span> j; <span class="comment">// [rsp+1Ch] [rbp-124h]</span></span><br><span class="line">  <span class="keyword">int</span> k; <span class="comment">// [rsp+24h] [rbp-11Ch]</span></span><br><span class="line">  <span class="keyword">int</span> l; <span class="comment">// [rsp+28h] [rbp-118h]</span></span><br><span class="line">  <span class="keyword">char</span> v5[<span class="number">192</span>]; <span class="comment">// [rsp+30h] [rbp-110h] BYREF</span></span><br><span class="line">  <span class="keyword">char</span> s[<span class="number">16</span>]; <span class="comment">// [rsp+F0h] [rbp-50h] BYREF</span></span><br><span class="line">  _BYTE v7[<span class="number">56</span>]; <span class="comment">// [rsp+100h] [rbp-40h] BYREF</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v8; <span class="comment">// [rsp+138h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v8 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%40s&quot;</span>, s);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> <span class="keyword">int</span>)<span class="built_in">strlen</span>(s) != <span class="number">32</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Wrong!&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  sub_400C91(v5, a1);</span><br><span class="line">  sub_401B8E(v5, s);</span><br><span class="line">  sub_401B8E(v5, v7);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">31</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; i / <span class="number">4</span> &gt; j; ++j )</span><br><span class="line">      s[i] ^= s[j];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( k = <span class="number">1</span>; k &lt;= <span class="number">31</span>; ++k )</span><br><span class="line">    byte_6040D0[k - <span class="number">1</span>] = (<span class="number">2</span> * (s[k - <span class="number">1</span>] ^ <span class="number">0x13</span>) + <span class="number">7</span>) ^ ((<span class="keyword">unsigned</span> __int8)s[k - <span class="number">1</span>] % <span class="number">9u</span> + s[k] + <span class="number">2</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v7[<span class="number">15</span>] == <span class="number">0xC4</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( l = <span class="number">0</span>; l &lt;= <span class="number">30</span>; ++l )</span><br><span class="line">      ;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>调出的代码还有点问题…但大概是出来了，只是中间比较的部分缺少了，只能看汇编了，其中byte_604100是要比较的数据</p>
<img src="/2022/05/27/Reverse-7/image-20220527164919681.png" class title="image-20220527164919681">
<p>提取其中的数据</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ida_chars[] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">0xBD</span>, <span class="number">0xAD</span>, <span class="number">0xB4</span>, <span class="number">0x84</span>, <span class="number">0x10</span>, <span class="number">0x63</span>, <span class="number">0xB3</span>, <span class="number">0xE1</span>, <span class="number">0xC6</span>, <span class="number">0x84</span>, </span><br><span class="line">  <span class="number">0x2D</span>, <span class="number">0x6F</span>, <span class="number">0xBA</span>, <span class="number">0x88</span>, <span class="number">0x74</span>, <span class="number">0xC4</span>, <span class="number">0x90</span>, <span class="number">0x32</span>, <span class="number">0xEA</span>, <span class="number">0x2E</span>, </span><br><span class="line">  <span class="number">0xC6</span>, <span class="number">0x28</span>, <span class="number">0x65</span>, <span class="number">0x70</span>, <span class="number">0xC9</span>, <span class="number">0x75</span>, <span class="number">0x78</span>, <span class="number">0xA0</span>, <span class="number">0x0B</span>, <span class="number">0x9F</span>, </span><br><span class="line">  <span class="number">0xA6</span>, <span class="number">0x00</span>, <span class="number">0x30</span>, <span class="number">0xE4</span>, <span class="number">0xD2</span>, <span class="number">0xC3</span>, <span class="number">0xEF</span>, <span class="number">0x75</span>, <span class="number">0xED</span>, <span class="number">0xA8</span>, </span><br><span class="line">  <span class="number">0xE1</span>, <span class="number">0xA1</span>, <span class="number">0x73</span>, <span class="number">0x81</span>, <span class="number">0xE2</span>, <span class="number">0xE9</span>, <span class="number">0xAB</span>, <span class="number">0xC8</span>, <span class="number">0xBF</span>, <span class="number">0xCA</span>, </span><br><span class="line">  <span class="number">0x52</span>, <span class="number">0xE8</span>, <span class="number">0xED</span>, <span class="number">0x6B</span>, <span class="number">0xA2</span>, <span class="number">0x39</span>, <span class="number">0x86</span>, <span class="number">0x21</span>, <span class="number">0xD0</span>, <span class="number">0xF6</span>, </span><br><span class="line">  <span class="number">0x50</span>, <span class="number">0x3E</span>, <span class="number">0xF3</span>, <span class="number">0x5C</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>中间的加密函数是一个类似AES的结构</p>
<img src="/2022/05/27/Reverse-7/image-20220527170000216.png" class title="image-20220527170000216">
<p>然后是两个异或加密，前一个可逆，后一个需要进行爆破</p>
<img src="/2022/05/27/Reverse-7/image-20220527172908880.png" class title="image-20220527172908880">
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">key=<span class="string">b&#x27;th1s1sth3n1c3k3y&#x27;</span></span><br><span class="line">cipher =[</span><br><span class="line">  <span class="number">0xBD</span>, <span class="number">0xAD</span>, <span class="number">0xB4</span>, <span class="number">0x84</span>, <span class="number">0x10</span>, <span class="number">0x63</span>, <span class="number">0xB3</span>, <span class="number">0xE1</span>, <span class="number">0xC6</span>, <span class="number">0x84</span>, </span><br><span class="line">  <span class="number">0x2D</span>, <span class="number">0x6F</span>, <span class="number">0xBA</span>, <span class="number">0x88</span>, <span class="number">0x74</span>, <span class="number">0xC4</span>, <span class="number">0x90</span>, <span class="number">0x32</span>, <span class="number">0xEA</span>, <span class="number">0x2E</span>, </span><br><span class="line">  <span class="number">0xC6</span>, <span class="number">0x28</span>, <span class="number">0x65</span>, <span class="number">0x70</span>, <span class="number">0xC9</span>, <span class="number">0x75</span>, <span class="number">0x78</span>, <span class="number">0xA0</span>, <span class="number">0x0B</span>, <span class="number">0x9F</span>, </span><br><span class="line">  <span class="number">0xA6</span>, <span class="number">0x00</span>, <span class="number">0x30</span>, <span class="number">0xE4</span>, <span class="number">0xD2</span>, <span class="number">0xC3</span>, <span class="number">0xEF</span>, <span class="number">0x75</span>, <span class="number">0xED</span>, <span class="number">0xA8</span>, </span><br><span class="line">  <span class="number">0xE1</span>, <span class="number">0xA1</span>, <span class="number">0x73</span>, <span class="number">0x81</span>, <span class="number">0xE2</span>, <span class="number">0xE9</span>, <span class="number">0xAB</span>, <span class="number">0xC8</span>, <span class="number">0xBF</span>, <span class="number">0xCA</span>, </span><br><span class="line">  <span class="number">0x52</span>, <span class="number">0xE8</span>, <span class="number">0xED</span>, <span class="number">0x6B</span>, <span class="number">0xA2</span>, <span class="number">0x39</span>, <span class="number">0x86</span>, <span class="number">0x21</span>, <span class="number">0xD0</span>, <span class="number">0xF6</span>, </span><br><span class="line">  <span class="number">0x50</span>, <span class="number">0x3E</span>, <span class="number">0xF3</span>, <span class="number">0x5C</span></span><br><span class="line">]</span><br><span class="line">middle=[<span class="number">0</span>]*<span class="number">32</span></span><br><span class="line">middle[<span class="number">31</span>]=<span class="number">0xc4</span></span><br><span class="line">cryptor=AES.new(key,AES.MODE_ECB)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor</span>():</span></span><br><span class="line">    tmp_ar=[<span class="number">0</span>]*<span class="number">32</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        tmp_ar[i]=middle[i]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">31</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,i//<span class="number">4</span>):</span><br><span class="line">            tmp_ar[i]^=tmp_ar[j]</span><br><span class="line">    f=<span class="string">b&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        f+=long_to_bytes(tmp_ar[i])</span><br><span class="line">    <span class="built_in">print</span>(cryptor.decrypt(f))</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">deep_search</span>(<span class="params">i</span>):</span></span><br><span class="line">    <span class="keyword">if</span> i==-<span class="number">1</span>:</span><br><span class="line">        <span class="comment"># print(middle)</span></span><br><span class="line">        xor()</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        tmp=((<span class="number">2</span>*(j^<span class="number">0x13</span>)+<span class="number">7</span>)^(j%<span class="number">9</span>+middle[i+<span class="number">1</span>]+<span class="number">2</span>))&amp;<span class="number">0xff</span></span><br><span class="line">        <span class="keyword">if</span> tmp==cipher[i]:</span><br><span class="line">            middle[i]=j</span><br><span class="line">            deep_search(i-<span class="number">1</span>)</span><br><span class="line">deep_search(<span class="number">30</span>)</span><br><span class="line">               </span><br></pre></td></tr></table></figure>
<p>运行便可以得到flag了</p>
<img src="/2022/05/27/Reverse-7/image-20220527172954733.png" class title="image-20220527172954733">
<h3 id="SWPU2019-EasiestRe"><a href="#SWPU2019-EasiestRe" class="headerlink" title="[SWPU2019]EasiestRe"></a>[SWPU2019]EasiestRe</h3><p>做最简单的re，挨最毒的打</p>
<p>将加密函数隐藏在子进程，主要通过ReadProcessMemory和WriteProcessMemory这两个函数实现</p>
<img src="/2022/05/27/Reverse-7/image-20220528212151886.png" class title="image-20220528212151886">
<p>在这之前我们需要先了解int 3这个指令，通过搜索我们可以发现int 3会引起异常</p>
<blockquote>
<p>INT3断点是断点的一种，在诸如Ollydbg中的快捷键是F2，是一种很常用的断点类型。INT3指令的<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/机器码">机器码</a>为CC，所以通常也称之为CC指令。当被调试进程执行INT3指令导致一个异常时，调试器就会捕捉这个异常从而停在断点处，然后将断点处的指令恢复成原来的指令。</p>
</blockquote>
<p>而ReadProcessMemory和WriteProcessMemory这两个函数中的基址参数为</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lpBaseAddress = DebugEvent.u.Exception.ExceptionRecord.ExceptionAddress;</span><br></pre></td></tr></table></figure>
<p>也就是说，程序会捕捉子进程中引起异常的地方，对其中内容进行读取和改写</p>
<p>而决定改写地方和改写内容是通过nop数量来实现的</p>
<img src="/2022/05/27/Reverse-7/image-20220528212810447.png" class title="image-20220528212810447">
<p>例如</p>
<img src="/2022/05/27/Reverse-7/image-20220528212837593.png" class title="image-20220528212837593">
<p>那么我们要做的就是将参数v16和v15中的内容写到相应的地方来分析</p>
<p>首先将v16改写</p>
<img src="/2022/05/27/Reverse-7/image-20220528213341784.png" class title="image-20220528213341784">
<p>然后是v15</p>
<img src="/2022/05/27/Reverse-7/image-20220528222429471.png" class title="image-20220528222429471">
<p>然后就是对着算法开逆</p>
<img src="/2022/05/27/Reverse-7/image-20220528234545090.png" class title="image-20220528234545090">
<h3 id="SUCTF2019-hardcpp"><a href="#SUCTF2019-hardcpp" class="headerlink" title="[SUCTF2019]hardcpp"></a>[SUCTF2019]hardcpp</h3><p>脚本去除控制流平坦化</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python deflat.py .\hardCpp 0x4007e0</span><br></pre></td></tr></table></figure>
<p>核心代码不难</p>
<img src="/2022/05/27/Reverse-7/image-20220621143123237.png" class title="image-20220621143123237">
<p>解题代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">enc =[</span><br><span class="line">  0xF3, 0x2E, 0x18, 0x36, 0xE1, 0x4C, 0x22, 0xD1, 0xF9, 0x8C, </span><br><span class="line">  0x40, 0x76, 0xF4, 0x0E, 0x00, 0x05, 0xA3, 0x90, 0x0E, 0xA5,0x00</span><br><span class="line">]</span><br><span class="line">def encrypt(s):</span><br><span class="line">    for i in range(1,21):</span><br><span class="line">        cipher=s[i]</span><br><span class="line">        v3=s[i-1]%7</span><br><span class="line">        cipher=(s[i]+v3)%256</span><br><span class="line">        v6=((s[i-1]^18)*3+2)%256</span><br><span class="line">        cipher=cipher^v6</span><br><span class="line">        </span><br><span class="line">flag=[ord(&#x27;#&#x27;)]</span><br><span class="line">for i in range(1,20):</span><br><span class="line">    cipher=enc[i-1]</span><br><span class="line">    v3=flag[i-1]%7</span><br><span class="line">    v6=((flag[i-1]^18)*3+2)%256</span><br><span class="line">    cipher=cipher^v6</span><br><span class="line">    flag.append(cipher-v3)</span><br><span class="line">s=&#x27;&#x27;</span><br><span class="line">for i in range(len(flag)):</span><br><span class="line">    s+=chr(flag[i])</span><br><span class="line">print(s)</span><br></pre></td></tr></table></figure>
</div><div class="article-licensing box"><div class="licensing-title"><p>Reverse 7</p><p><a href="http://curator-kim.github.io/2022/05/27/Reverse-7/">http://curator-kim.github.io/2022/05/27/Reverse-7/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><a href="http://Curator-Kim.github.io"><p>Curator-Kim</p></a></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2022-05-27</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2022-06-21</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="recommend-area"><div class="recommend-post"><span class="is-size-6 has-text-grey has-mr-7"># Related Post</span><br><span>  1.<a class="is-size-6" href="/2022/09/06/%E7%BE%8A%E5%9F%8E%E6%9D%AFwp/" target="_blank">羊城杯2022 wp</a><br></span><span>  2.<a class="is-size-6" href="/2022/08/14/Crypto-NTRU%E5%AF%86%E7%A0%81%E7%B3%BB%E7%BB%9F/" target="_blank">Crypto NTRU密码系统</a><br></span><span>  3.<a class="is-size-6" href="/2022/08/14/HWS2022%E7%A1%AC%E4%BB%B6%E5%AE%89%E5%85%A8%E5%9C%A8%E7%BA%BF%E5%A4%8F%E4%BB%A4%E8%90%A5/" target="_blank">HWS2022硬件安全在线夏令营</a><br></span><span>  4.<a class="is-size-6" href="/2022/07/24/DASCTF-2022-07-wp/" target="_blank">DASCTF 2022.07 wp</a><br></span><span>  5.<a class="is-size-6" href="/2022/05/27/DASCTF-MAY/" target="_blank">DASCTF MAY</a><br></span><span>  6.<a class="is-size-6" href="/2022/05/09/Reverse-angr/" target="_blank">Reverse angr</a><br></span><span>  7.<a class="is-size-6" href="/2022/05/05/DASCTF-Apr-Writeup/" target="_blank">DASCTF Apr Writeup</a><br></span><span>  8.<a class="is-size-6" href="/2022/04/24/Crypto-CopperSmith/" target="_blank">Crypto-CopperSmith</a><br></span></div></div><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/css/share.min.css"><div class="social-share"></div><script src="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>Alipay</span><span class="qrcode"><img src="https://github.com/Curator-Kim/Curator-Kim.github.io/blob/master/img/alipay.png?raw=true" alt="Alipay"></span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>Wechat</span><span class="qrcode"><img src="https://github.com/Curator-Kim/Curator-Kim.github.io/blob/master/img/wechat.png?raw=true" alt="Wechat"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2022/07/24/DASCTF-2022-07-wp/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">DASCTF 2022.07 wp</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2022/05/27/DASCTF-MAY/"><span class="level-item">DASCTF MAY</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--><div class="card"><div class="card-content"><div class="title is-5">Comments</div><div id="comment-container"></div><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/gitalk/1.6.0/gitalk.css"><script> $.getScript('/js/gitalk.min.js', function () { 
            var gitalk = new Gitalk({
            language:'zh-CN',
            id: 'ad4f58255f00fc0a0e3d0293eb3011df',
            repo: 'blog_comment',
            owner: 'Curator-Kim',
            clientID: '46a9f3481b46ea0129d8',
            clientSecret: '79c7c9cb847e141757d7864453bcbf89f0655b24',
            admin: ["Curator-Kim"],
            createIssueManually: true,
            distractionFreeMode: false,
            perPage: 10,
            pagerDirection: 'last',
            proxy: 'https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token',
            
            enableHotKey: true,
            isLocked: false
        })
        gitalk.render('comment-container')});</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><!--!--><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="https://github.com/Curator-Kim/Curator-Kim.github.io/blob/22a41709ffc26f62191d72a87ffbb342d46bfce3/img/icon.jpg?raw=true" alt="Curator-Kim"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Curator-Kim</p><p class="is-size-6 is-block">寻几处好景破星光</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>火星</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">38</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">17</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/ppoffice" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/curator-kim"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Email" href="/804242129@qq.com"><i class="fa fa-envelope"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/atom.xml"><i class="fas fa-rss"></i></a></div><div><hr><p id="hitokoto">:D 一言句子获取中...</p><script type="text/javascript" defer>function getYiyan(){
                                $.getJSON("https://v1.hitokoto.cn/", function (data) {
                                if(data){
                                    $('#hitokoto').html("");
                                    $('#hitokoto').append("<strong style='color: #3273dc;'>"+data.hitokoto+"</strong>"+
                                    "<p>"+"From《"+data.from+"》</p><p>Provider-"+data.creator+"</p>");
                                }});}
                                $(function (){getYiyan();$('#hitokoto').click(function(){getYiyan();})});</script></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile" href="https://bulma.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bulma</span></span><span class="level-right"><span class="level-item tag">bulma.io</span></span></a></li></ul></div></div></div><!--!--><div class="card widget"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-09-05T16:22:59.000Z">2022-09-06</time></p><p class="title"><a href="/2022/09/06/%E7%BE%8A%E5%9F%8E%E6%9D%AFwp/">羊城杯2022 wp</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-08-14T09:42:10.000Z">2022-08-14</time></p><p class="title"><a href="/2022/08/14/Crypto-NTRU%E5%AF%86%E7%A0%81%E7%B3%BB%E7%BB%9F/">Crypto NTRU密码系统</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-08-13T16:44:15.000Z">2022-08-14</time></p><p class="title"><a href="/2022/08/14/HWS2022%E7%A1%AC%E4%BB%B6%E5%AE%89%E5%85%A8%E5%9C%A8%E7%BA%BF%E5%A4%8F%E4%BB%A4%E8%90%A5/">HWS2022硬件安全在线夏令营</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-07-24T01:55:16.000Z">2022-07-24</time></p><p class="title"><a href="/2022/07/24/DASCTF-2022-07-wp/">DASCTF 2022.07 wp</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-05-27T02:19:27.000Z">2022-05-27</time></p><p class="title"><a href="/2022/05/27/Reverse-7/">Reverse 7</a></p></div></article></div></div><!--!--><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2022/09/"><span class="level-start"><span class="level-item">September 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2022/08/"><span class="level-start"><span class="level-item">August 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2022/07/"><span class="level-start"><span class="level-item">July 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2022/05/"><span class="level-start"><span class="level-item">May 2022</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2022/04/"><span class="level-start"><span class="level-item">April 2022</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><a class="level is-mobile is-marginless" href="/archives/"><span class="level-start"><span class="level-item">查看全部&gt;&gt;</span></span></a></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/CTF/"><span class="tag">CTF</span><span class="tag is-grey-lightest">19</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80/"><span class="tag">汇编语言</span><span class="tag is-grey-lightest">12</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Crypto/"><span class="tag">Crypto</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Reverse/"><span class="tag">Reverse</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/RE/"><span class="tag">RE</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ctf/"><span class="tag">ctf</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pwn/"><span class="tag">pwn</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CopperSmith/"><span class="tag">CopperSmith</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DES/"><span class="tag">DES</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/HWS/"><span class="tag">HWS</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/NTRU/"><span class="tag">NTRU</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Re/"><span class="tag">Re</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SMC/"><span class="tag">SMC</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/angr/"><span class="tag">angr</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/re/"><span class="tag">re</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/"><span class="tag">参考资料</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%A2%84%E5%A4%87%E7%9F%A5%E8%AF%86/"><span class="tag">预备知识</span><span class="tag is-grey-lightest">1</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe for updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div><!--!--><div class="column-right-shadow is-hidden-widescreen"></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="https://github.com/Curator-Kim/Curator-Kim.github.io/blob/master/img/logo.png?raw=true" alt="Curator-Kim的小站" height="28"></a><p class="size-small"><span>&copy; 2022 Curator-Kim</span>  Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a> &amp; <a href="https://github.com/removeif/hexo-theme-amazing" target="_blank">Amazing</a> <br><span>© <a href="http://www.beian.miit.gov.cn/" target="_blank">粤ICP备88888888号-8（测试）</a><br></span><span>© 版权说明：[本网站所有内容均收集于互联网或自己创作,<br />&nbsp;&nbsp;&nbsp;&nbsp;方便于网友与自己学习交流，如有侵权，请<a href="/message" target="_blank">留言</a>，立即处理]<br /></span><span><span id="statistic-times">loading...</span><script>function createTime(time) {
            var n = new Date(time);
            now.setTime(now.getTime() + 250),
                days = (now - n) / 1e3 / 60 / 60 / 24,
                dnum = Math.floor(days),
                hours = (now - n) / 1e3 / 60 / 60 - 24 * dnum,
                hnum = Math.floor(hours),
            1 == String(hnum).length && (hnum = "0" + hnum),
                minutes = (now - n) / 1e3 / 60 - 1440 * dnum - 60 * hnum,
                mnum = Math.floor(minutes),
            1 == String(mnum).length && (mnum = "0" + mnum),
                seconds = (now - n) / 1e3 - 86400 * dnum - 3600 * hnum - 60 * mnum,
                snum = Math.round(seconds),
            1 == String(snum).length && (snum = "0" + snum),
                document.getElementById("statistic-times").innerHTML = "❤️Site from <strong>"+time.split(" ")[0].replace(/\//g,".")+"</strong> has existed <strong>" + dnum + "</strong> d <strong>" + hnum + "</strong> h <strong>" + mnum + "</strong> m <strong>" + snum + "</strong> s！❤️";
        }var now = new Date();setInterval("createTime('2022/1/21 00:00:00')", 250,"");</script><br></span><div class="size-small"><span>❤️Thx <strong><span id="busuanzi_value_site_uv">99+</span></strong> users <strong><span id="busuanzi_value_site_pv">99+</span></strong> visited！❤️</span></div></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/removeif/hexo-theme-amazing"><i class="fab fa-github"></i></a></p></div><div class="sideMusic"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="/js/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script><meting-js style="width: auto;height: 2000px;" server="netease" type="playlist" id="137510737" theme="#2980b9" loop="all" autoplay="false" order="list" storageName="aplayer-setting" lrctype="0" list-max-height="400px" fixed="true"></meting-js></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><script src="/js/main.js" defer></script><script>$.getScript('/js/comment-issue-data.js',function(){loadIssueData('46a9f3481b46ea0129d8','79c7c9cb847e141757d7864453bcbf89f0655b24','Curator-Kim','blog_comment',false);})</script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.js"></script><script type="text/javascript">var pjax = new Pjax({
            elements: "a",//代表点击链接就更新
            selectors: [  //代表要更新的节点
                ".section",
                "title"
            ],
            cache: true,
            cacheBust:false
        })

        function loadBusuanzi(){
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js", function () {});
        }

        function loadMathJax() { //加载mathjax
            $.getScript("//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML", function () {
                MathJax.Hub.Config({ tex2jax: { inlineMath: [['$', '$'], ['\(', '\)']] } });
                var math = document.getElementsByClassName("entry-content")[0];
                MathJax.Hub.Queue(["Typeset", MathJax.Hub, math]);
            });
        };

        // 开始 PJAX 执行的函数
        document.addEventListener('pjax:send', function () {
        });
        
        // PJAX 完成之后执行的函数，可以和上面的重载放在一起
        document.addEventListener('pjax:complete', function () {
            $(".section").css({opacity:1});
            if(false){
                $.getScript('/js/comment-issue-data.js',function(){loadIssueData('46a9f3481b46ea0129d8','79c7c9cb847e141757d7864453bcbf89f0655b24','Curator-Kim','blog_comment',false);});
            }
            if(false){
                loadMathJax();
            }
            loadMainJs(jQuery, window.moment, window.ClipboardJS, window.IcarusThemeSettings);
            loadBackTop();
            loadBusuanzi();
            if(typeof loadBanner == 'function'){
                loadBanner();
            }
        });</script></body></html>