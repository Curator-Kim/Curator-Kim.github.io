<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>DASCTF Apr Writeup - Curator-Kim的小站</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Curator-Kim的小站"><meta name="msapplication-TileImage" content="https://cdn.jsdelivr.net/gh/removeif/removeif-demo@latest/img/favicon.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Curator-Kim的小站"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="学习一下不会的题 [TOC]"><meta property="og:type" content="blog"><meta property="og:title" content="Curator-Kim"><meta property="og:url" content="https://curator-kim.github.io/"><meta property="og:site_name" content="Curator-Kim"><meta property="og:description" content="学习一下不会的题 [TOC]"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://curator-kim.github.io/img/icon.jpg"><meta property="article:published_time" content="2022-05-05T01:47:30.000Z"><meta property="article:modified_time" content="2022-05-05T01:47:30.404Z"><meta property="article:author" content="Curator-Kim"><meta property="article:tag" content="CTF"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/icon.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://curator-kim.github.io/2022/05/05/DASCTF-Apr-Writeup/"},"headline":"Curator-Kim的小站","image":["http://curator-kim.github.io/2022/05/05/DASCTF-Apr-Writeup/image-20220502094119118.png","http://curator-kim.github.io/2022/05/05/DASCTF-Apr-Writeup/image-20220429130724123.png","http://curator-kim.github.io/2022/05/05/DASCTF-Apr-Writeup/image-20220429113346774.png","http://curator-kim.github.io/2022/05/05/DASCTF-Apr-Writeup/image-20220501094018538.png","http://curator-kim.github.io/2022/05/05/DASCTF-Apr-Writeup/image-20220501094141056.png","http://curator-kim.github.io/2022/05/05/DASCTF-Apr-Writeup/image-20220501094312422.png","http://curator-kim.github.io/2022/05/05/DASCTF-Apr-Writeup/image-20220501101543922.png","http://curator-kim.github.io/2022/05/05/DASCTF-Apr-Writeup/image-20220501105618497.png","http://curator-kim.github.io/2022/05/05/DASCTF-Apr-Writeup/image-20220501114317940.png","http://curator-kim.github.io/2022/05/05/DASCTF-Apr-Writeup/image-20220501114525832.png","http://curator-kim.github.io/2022/05/05/DASCTF-Apr-Writeup/image-20220501115815366.png","http://curator-kim.github.io/2022/05/05/DASCTF-Apr-Writeup/image-20220501115942821.png","http://curator-kim.github.io/2022/05/05/DASCTF-Apr-Writeup/image-20220501164423617.png","http://curator-kim.github.io/2022/05/05/DASCTF-Apr-Writeup/image-20220501164607002.png"],"datePublished":"2022-05-05T01:47:30.000Z","dateModified":"2022-05-05T01:47:30.404Z","author":{"@type":"Person","name":"Curator-Kim"},"description":"学习一下不会的题 [TOC]"}</script><link rel="canonical" href="http://curator-kim.github.io/2022/05/05/DASCTF-Apr-Writeup/"><link rel="icon" href="https://cdn.jsdelivr.net/gh/removeif/removeif-demo@latest/img/favicon.png"><meta name="referrer" content="no-referrer-when-downgrade"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css?family=Ubuntu:400,600|Source+Code+Pro|Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Microsoft YaHei:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&amp;amp;subset=latin,latin-ext|Inconsolata|Itim|Lobster.css"><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="/js/globalUtils.js"></script><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/pace/1.0.2/pace.min.js"></script><link rel="stylesheet" href="/live2d/waifu.css"><script type="text/javascript" async src="/live2d/autoload.js"></script><meta name="generator" content="Hexo 5.4.0"></head><body class="is-3-column has-navbar-fixed-top"><nav class="navbar navbar-main is-fixed-top"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="https://github.com/Curator-Kim/Curator-Kim.github.io/blob/master/img/logo.png?raw=true" alt="Curator-Kim的小站" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a><a class="navbar-item" href="/album">Album</a><a class="navbar-item" href="/friend">Friend</a><a class="navbar-item" href="/message">Message</a><a class="navbar-item" href="/self-talking">Self-talking</a><a class="navbar-item" href="/music">Music</a><a class="navbar-item" href="/media">Media</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Join Gitter" href="https://gitter.im/hexo-theme-amazing/community"><i class="fab fa-gitter"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/removeif/hexo-theme-amazing"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a><a class="navbar-item" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a></div></div></div></nav><script type="text/javascript" src="/js/theme-setting.js"></script><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><!--!--><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2022-05-05  <a class="commentCountImg" href="/2022/05/05/DASCTF-Apr-Writeup/#comment-container"><span class="display-none-class">988ca2fc51daee3b31be063ebb319aac</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="988ca2fc51daee3b31be063ebb319aac">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>10 m  <i class="fas fa-pencil-alt"> </i>1.5 k</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>&nbsp;visits</span></div></div><h1 class="title is-3 is-size-4-mobile">DASCTF Apr Writeup</h1><div class="content"><p>学习一下不会的题</p>
<p>[TOC]</p>
<span id="more"></span>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="special-rsa"><a href="#special-rsa" class="headerlink" title="special_rsa"></a>special_rsa</h3><h5 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getPrime1</span>(<span class="params">bitLength, e</span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        i = getPrime(bitLength)</span><br><span class="line">        <span class="keyword">if</span> (i - <span class="number">1</span>) % e ** <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> i</span><br><span class="line">flag=<span class="string">b&#x27;DASCTF&#123;????????????????????&#125;&#x27;</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">lenth = ((<span class="built_in">len</span>(<span class="built_in">bin</span>(m)) - <span class="number">2</span>) // <span class="number">2</span>) + <span class="number">9</span></span><br><span class="line">e=<span class="number">113</span></span><br><span class="line">p = getPrime1(lenth, e)</span><br><span class="line">q = getPrime1(lenth, e)</span><br><span class="line">n=p*q</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">    lenth = ((<span class="built_in">len</span>(<span class="built_in">bin</span>(c)) - <span class="number">2</span>) // <span class="number">2</span>) + <span class="number">9</span></span><br><span class="line">    p = getPrime1(lenth, e)</span><br><span class="line">    q = getPrime1(lenth, e)</span><br><span class="line">    n=p*q</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line">    c=<span class="built_in">pow</span>(c,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<h5 id="分析："><a href="#分析：" class="headerlink" title="分析："></a>分析：</h5><p>首先可以看到题目中生成的n的位数较小，通过factordb.com可以将27轮的n全部分解。而问题在于getPrime1这个函数，它所生成的p和q满足</p>
<script type="math/tex; mode=display">
(p-1)\%e^2\equiv0</script><p>也就是说，无法通过对 $phi$ 求逆来得到 $d$ ，需要通过求解高次同余方程来得到flag。而求解高次同余方程的主要算法为AMM算法。（可是不知道为什么在s=2的情况下，我自己写的AMM和网上找到的大部分AMM脚本都无法求得正确解）好在有sage封装好的函数，可以直接求解这个问题</p>
<p>还在得到方程的全部解后，问题就变成了怎么筛选合适的根，一个直观的想法就是加密时每一轮生成的密文都是小于当轮的n，由此我们可以利用上一轮的n来筛选此轮求得的c</p>
<p>当然，每一轮求得的满足条件的c可能不止一个，但是也不会太多，轮着试即可。</p>
<h5 id="脚本："><a href="#脚本：" class="headerlink" title="脚本："></a>脚本：</h5><p>由于每轮解出来的c都不一样，而我又懒得写一轮过的脚本，就放了个从第四轮截断的脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="number">83436593835736927783034931301466249878138772728555530531816534785622373800125814331410735801</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;round%d&#x27;</span>%i)</span><br><span class="line">    P.&lt;x&gt;=PolynomialRing(Zmod(p[i]),implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">    Q.&lt;y&gt;=PolynomialRing(Zmod(n[i]//p[i]),implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">    f=x^e-c</span><br><span class="line">    g=y^e-c</span><br><span class="line">    root_p=f.monic().roots()</span><br><span class="line">    root_q=g.monic().roots()</span><br><span class="line">    root_n=[]</span><br><span class="line">    <span class="keyword">for</span> pp <span class="keyword">in</span> root_p:</span><br><span class="line">        <span class="keyword">for</span> qq <span class="keyword">in</span> root_q:</span><br><span class="line">            tmp=crt([<span class="built_in">int</span>(pp[<span class="number">0</span>]),<span class="built_in">int</span>(qq[<span class="number">0</span>])],[p[i],n[i]//p[i]])</span><br><span class="line">            <span class="keyword">if</span> tmp&lt;n[i-<span class="number">1</span>]:</span><br><span class="line">                <span class="keyword">if</span> i==<span class="number">0</span>:</span><br><span class="line">                    <span class="built_in">print</span>(n2s(<span class="built_in">int</span>(tmp)))</span><br><span class="line">                c=tmp</span><br><span class="line">            </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;end&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>最后出来一堆乱码，在里面搜“DASCTF”即可</p>
<h3 id="CVE-OF-RSA"><a href="#CVE-OF-RSA" class="headerlink" title="CVE OF RSA"></a>CVE OF RSA</h3><p>roca漏洞，推荐使用以下代码</p>
<p><a target="_blank" rel="noopener" href="https://github.com/jvdsn/crypto-attacks/blob/c26872bdac2e2d95c5be00e6e593c891c849f446/attacks/factorization/roca.py">crypto-attacks/roca.py at c26872bdac2e2d95c5be00e6e593c891c849f446 · jvdsn/crypto-attacks (github.com)</a></p>
<p><img src="/2022/05/05/DASCTF-Apr-Writeup/image-20220502094119118.png" alt="image-20220502094119118"></p>
<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="Crackme"><a href="#Crackme" class="headerlink" title="Crackme"></a>Crackme</h3><p>拖进IDA，shift+f12搜索Wrong，迅速进到关键函数</p>
<p><img src="/2022/05/05/DASCTF-Apr-Writeup/image-20220429130724123.png" alt="image-20220429130724123"></p>
<p>可以看到password长度要求为8，flag要求长度为32，中间存在一些加密函数</p>
<p>有对比函数，尝试动调看对比的是啥玩意</p>
<p>调试不动，存在反调试机制，查了一下是ZwSetInformationThread</p>
<p><a target="_blank" rel="noopener" href="https://ctf-wiki.org/reverse/windows/anti-debug/zwsetinformationthread/">ZwSetInformationThread - CTF Wiki (ctf-wiki.org)</a></p>
<p>字符串中搜索ZwSetInformation，定位到反调试函数，将此处的11h改为其他数字即可</p>
<p><img src="/2022/05/05/DASCTF-Apr-Writeup/image-20220429113346774.png" alt="image-20220429113346774"></p>
<p>继续调，在sub_1031e0处下断点，可以看到this的值为0xeff710，而根据memcmp的参数，我们可以推断出要比较的内容分别放在0xeff7ec、0xeff8f0、0xeff9f4，分别到这两个地方取出要比较的内容，分别为0x9f77c2a4ac5c0a671321bbe1e9972af6、0xd59f8e94b0e1de6e329518a0c444aa94de7c8d44、0x5b9ceeb23bb7d734f31b7514c6b21fe8de334474751b476ad4375188fc67e660da0d5827814353ea7b52856c8665afb4</p>
<p><img src="/2022/05/05/DASCTF-Apr-Writeup/image-20220501094018538.png" alt="image-20220501094018538"></p>
<p><img src="/2022/05/05/DASCTF-Apr-Writeup/image-20220501094141056.png" alt="image-20220501094141056"></p>
<p><img src="/2022/05/05/DASCTF-Apr-Writeup/image-20220501094312422.png" alt="image-20220501094312422"></p>
<p>再去看sub_103510里面对变量做了什么处理，可以看到是调用的库函数进行加密处理。通过这个网站<a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/windows/win32/api/wincrypt/nf-wincrypt-cryptderivekey#:~:text=The CryptDeriveKey function generates cryptographic session keys derived,be a password or any other user data.">CryptDeriveKey function (wincrypt.h) - Win32 apps | Microsoft Docs</a> 可以查询到对应函数的作用。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> __stdcall <span class="title">sub_103510</span><span class="params">(BYTE *pbData, DWORD dwDataLen, ALG_ID Algid, <span class="keyword">int</span> a4, <span class="keyword">int</span> a5)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">bool</span> result; <span class="comment">// al</span></span><br><span class="line">  _DWORD var20; <span class="comment">// [esp+10h] [ebp-20h]</span></span><br><span class="line">  _DWORD var18; <span class="comment">// [esp+18h] [ebp-18h]</span></span><br><span class="line">  BYTE var14[<span class="number">4</span>]; <span class="comment">// [esp+1Ch] [ebp-14h]</span></span><br><span class="line">  DWORD pdwDataLen; <span class="comment">// [esp+20h] [ebp-10h]</span></span><br><span class="line">  HCRYPTPROV phProv; <span class="comment">// [esp+24h] [ebp-Ch]</span></span><br><span class="line">  HCRYPTHASH phHash; <span class="comment">// [esp+28h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  phProv = <span class="number">0</span>;</span><br><span class="line">  phHash = <span class="number">0</span>;</span><br><span class="line">  var20 = <span class="number">0</span>;</span><br><span class="line">  *var14 = <span class="number">0</span>;</span><br><span class="line">  pdwDataLen = <span class="number">0</span>;</span><br><span class="line">  var18 = CryptAcquireContextA(&amp;phProv, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0x18</span>u, <span class="number">0xF0000000</span>);</span><br><span class="line">  <span class="keyword">if</span> ( var18 )</span><br><span class="line">  &#123;</span><br><span class="line">    var18 = CryptCreateHash(phProv, Algid, <span class="number">0</span>, <span class="number">0</span>, &amp;phHash);</span><br><span class="line">    <span class="keyword">if</span> ( var18 )</span><br><span class="line">    &#123;</span><br><span class="line">      var18 = CryptHashData(phHash, pbData, dwDataLen, <span class="number">0</span>);</span><br><span class="line">      <span class="keyword">if</span> ( var18 )</span><br><span class="line">      &#123;</span><br><span class="line">        pdwDataLen = <span class="number">4</span>;</span><br><span class="line">        var18 = CryptGetHashParam(phHash, <span class="number">4u</span>, var14, &amp;pdwDataLen, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">if</span> ( var18 )</span><br><span class="line">        &#123;</span><br><span class="line">          var20 = sub_104540(*var14);</span><br><span class="line">          <span class="keyword">if</span> ( var20 )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="built_in">memset</span>(var20, <span class="number">0</span>, *var14);</span><br><span class="line">            var18 = CryptGetHashParam(phHash, <span class="number">2u</span>, var20, var14, <span class="number">0</span>);</span><br><span class="line">            <span class="keyword">if</span> ( var18 )</span><br><span class="line">            &#123;</span><br><span class="line">              *a4 = var20;</span><br><span class="line">              *a5 = *var14;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">else</span></span><br><span class="line">          &#123;</span><br><span class="line">            var18 = <span class="number">0</span>;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( !var18 &amp;&amp; var20 )</span><br><span class="line">    sub_10453B(var20);</span><br><span class="line">  <span class="keyword">if</span> ( phHash )</span><br><span class="line">    CryptDestroyHash(phHash);</span><br><span class="line">  <span class="keyword">if</span> ( phProv )</span><br><span class="line">    CryptReleaseContext(phProv, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">return</span> var18;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>分析后大概可以知道大概流程如下</p>
<p><img src="/2022/05/05/DASCTF-Apr-Writeup/image-20220501101543922.png" alt="image-20220501101543922"></p>
<p>通过爆破或者在线查询可以得到这些哈希值对应的原像为NocT、uRne，然后模仿加密流程写出解密代码</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;windef.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;wincrypt.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    BOOL v6; <span class="comment">// [esp+4h] [ebp-18h]</span></span><br><span class="line">    HCRYPTKEY phKey; <span class="comment">// [esp+Ch] [ebp-10h] BYREF</span></span><br><span class="line">    HCRYPTPROV phProv; <span class="comment">// [esp+10h] [ebp-Ch] BYREF</span></span><br><span class="line">    HCRYPTHASH phHash; <span class="comment">// [esp+14h] [ebp-8h] BYREF</span></span><br><span class="line"></span><br><span class="line">    phProv = <span class="number">0</span>;</span><br><span class="line">    phHash = <span class="number">0</span>;</span><br><span class="line">    phKey = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    BYTE key[] = &#123; <span class="number">0x5c</span>, <span class="number">0x53</span>, <span class="number">0xa4</span>, <span class="number">0xa4</span>, <span class="number">0x1d</span>, <span class="number">0x52</span>, <span class="number">0x43</span>, <span class="number">0x7a</span>, <span class="number">0x9f</span>, <span class="number">0xa1</span>, <span class="number">0xe9</span>, <span class="number">0xc2</span>, <span class="number">0x6c</span>, <span class="number">0xa5</span>, <span class="number">0x90</span>, <span class="number">0x90</span> &#125;;</span><br><span class="line">    BYTE input[] = &#123; <span class="number">0x5B</span>, <span class="number">0x9C</span>, <span class="number">0xEE</span>, <span class="number">0xB2</span>, <span class="number">0x3B</span>, <span class="number">0xB7</span>, <span class="number">0xD7</span>, <span class="number">0x34</span>, <span class="number">0xF3</span>, <span class="number">0x1B</span>, <span class="number">0x75</span>, <span class="number">0x14</span>, <span class="number">0xC6</span>, <span class="number">0xB2</span>, <span class="number">0x1F</span>, <span class="number">0xE8</span>, <span class="number">0xDE</span>, <span class="number">0x33</span>, <span class="number">0x44</span>, <span class="number">0x74</span>, <span class="number">0x75</span>, <span class="number">0x1B</span>, <span class="number">0x47</span>, <span class="number">0x6A</span>, <span class="number">0xD4</span>, <span class="number">0x37</span>, <span class="number">0x51</span>, <span class="number">0x88</span>, <span class="number">0xFC</span>, <span class="number">0x67</span>, <span class="number">0xE6</span>, <span class="number">0x60</span>, <span class="number">0xDA</span>, <span class="number">0x0D</span>, <span class="number">0x58</span>, <span class="number">0x07</span>, <span class="number">0x81</span>, <span class="number">0x43</span>, <span class="number">0x53</span>, <span class="number">0xEA</span>, <span class="number">0x7B</span>, <span class="number">0x52</span>, <span class="number">0x85</span>, <span class="number">0x6C</span>, <span class="number">0x86</span>, <span class="number">0x65</span>, <span class="number">0xAF</span>, <span class="number">0xB4</span> &#125;;</span><br><span class="line">    DWORD keyLen = <span class="number">0x10</span>;</span><br><span class="line">    DWORD inputLen = <span class="number">0x20</span>;</span><br><span class="line">    DWORD * t = &amp;inputLen;</span><br><span class="line"></span><br><span class="line">    v6 = <span class="built_in">CryptAcquireContextA</span>(&amp;phProv, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0x18</span>u, <span class="number">0xF0000000</span>);</span><br><span class="line">    <span class="keyword">if</span> (v6)</span><br><span class="line">    &#123;</span><br><span class="line">        v6 = <span class="built_in">CryptCreateHash</span>(phProv, <span class="number">0x8003</span>u, <span class="number">0</span>, <span class="number">0</span>, &amp;phHash);</span><br><span class="line">        <span class="keyword">if</span> (v6)</span><br><span class="line">        &#123;</span><br><span class="line">            v6 = <span class="built_in">CryptHashData</span>(phHash, key, keyLen, <span class="number">0</span>);</span><br><span class="line">            <span class="keyword">if</span> (v6)</span><br><span class="line">            &#123;</span><br><span class="line">                v6 = <span class="built_in">CryptDeriveKey</span>(phProv, <span class="number">0x660E</span>u, phHash, <span class="number">1u</span>, &amp;phKey);</span><br><span class="line">                <span class="keyword">if</span> (v6)</span><br><span class="line">                    v6 = <span class="built_in">CryptDecrypt</span>(phKey, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, input, t);</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, input);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (phKey)</span><br><span class="line">        <span class="built_in">CryptDestroyKey</span>(phKey);</span><br><span class="line">    <span class="keyword">if</span> (phHash)</span><br><span class="line">        <span class="built_in">CryptDestroyHash</span>(phHash);</span><br><span class="line">    <span class="keyword">if</span> (phProv)</span><br><span class="line">        <span class="built_in">CryptReleaseContext</span>(phProv, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>最后附加一个c++逆向</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/17bdw/p/6674668.html">[系统安全20]动态调试技巧-C++代码逆向 - 17bdw - 博客园 (cnblogs.com)</a></p>
<h3 id="FakePica"><a href="#FakePica" class="headerlink" title="FakePica"></a>FakePica</h3><p>用jadx打开的时候遇到了代码重构失败的问题，推测是加了壳，上网搜wp开始抄</p>
<p>可以使用这个工具进行脱壳<a target="_blank" rel="noopener" href="https://github.com/CodingGay/BlackDex">CodingGay/BlackDex: BlackDex is an Android unpack(dexdump) tool, it supports Android 5.0~12 and need not rely to any environment. BlackDex can run on any Android mobile phone or emulator, you can unpack APK File in several seconds. (github.com)</a></p>
<p><img src="/2022/05/05/DASCTF-Apr-Writeup/image-20220501105618497.png" alt="image-20220501105618497"></p>
<p>提取出脱壳文件，在拖进jadx中，进到MainActivity，大概逻辑就是对邮箱和密码进行AES/CBC加密，然后与content0和content1进行对比</p>
<p><img src="/2022/05/05/DASCTF-Apr-Writeup/image-20220501114317940.png" alt="image-20220501114317940"></p>
<p>然后写脚本可以得到解密后的邮箱和密码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long,long_to_bytes</span><br><span class="line">content0 = [-<span class="number">114</span>, <span class="number">95</span>, -<span class="number">37</span>, <span class="number">127</span>, -<span class="number">110</span>, <span class="number">113</span>, <span class="number">41</span>, <span class="number">74</span>, <span class="number">40</span>, <span class="number">73</span>, <span class="number">19</span>, <span class="number">124</span>, -<span class="number">57</span>, -<span class="number">88</span>, <span class="number">39</span>, -<span class="number">116</span>, -<span class="number">16</span>, -<span class="number">75</span>, -<span class="number">3</span>, -<span class="number">45</span>, -<span class="number">73</span>, -<span class="number">6</span>, -<span class="number">104</span>, -<span class="number">6</span>, -<span class="number">78</span>, <span class="number">121</span>, <span class="number">110</span>, <span class="number">74</span>, -<span class="number">90</span>, -<span class="number">47</span>, -<span class="number">28</span>, -<span class="number">28</span>]</span><br><span class="line">content1 = [-<span class="number">40</span>, <span class="number">26</span>, <span class="number">95</span>, -<span class="number">49</span>, -<span class="number">40</span>, -<span class="number">123</span>, <span class="number">72</span>, -<span class="number">90</span>, -<span class="number">100</span>, -<span class="number">41</span>, <span class="number">122</span>, -<span class="number">4</span>, <span class="number">25</span>, -<span class="number">101</span>, -<span class="number">58</span>, <span class="number">116</span>]</span><br><span class="line">c0=<span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> content0:</span><br><span class="line">    c0+=long_to_bytes(i%<span class="number">256</span>)</span><br><span class="line">c1=<span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> content1:</span><br><span class="line">    c1+=long_to_bytes(i%<span class="number">256</span>)</span><br><span class="line">key=<span class="string">b&#x27;picapicapicapica&#x27;</span></span><br><span class="line">iv=<span class="string">b&#x27;0102030405060708&#x27;</span></span><br><span class="line">aes=AES.new(key,AES.MODE_CBC,iv)</span><br><span class="line">de_text_1=aes.decrypt(c0)</span><br><span class="line"><span class="built_in">print</span>(de_text_1)</span><br><span class="line">aes2=AES.new(key,AES.MODE_CBC,iv)</span><br><span class="line">de_text_2=aes2.decrypt(c1)</span><br><span class="line"><span class="built_in">print</span>(de_text_2)</span><br><span class="line"><span class="comment"># picacomic@gmail.com</span></span><br><span class="line"><span class="comment"># picacomic</span></span><br></pre></td></tr></table></figure>
<p>最后登录进去即可getflag</p>
<p><img src="/2022/05/05/DASCTF-Apr-Writeup/image-20220501114525832.png" alt="image-20220501114525832"></p>
<h3 id="奇怪的交易"><a href="#奇怪的交易" class="headerlink" title="奇怪的交易"></a>奇怪的交易</h3><p>查到有upx壳，脱掉</p>
<p><img src="/2022/05/05/DASCTF-Apr-Writeup/image-20220501115815366.png" alt="image-20220501115815366"></p>
<p>拖进IDA，发现是python逆向，用pyinstxtractor+<a target="_blank" rel="noopener" href="https://tool.lu/pyc/">python反编译 - 在线工具 (tool.lu)</a>尝试搞出源代码，发现大部分恢复失败</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">objcopy --dump-section pydata=pydata.dump DAS</span><br></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 pyinstxtractor.py pydata.dump </span><br></pre></td></tr></table></figure>
<p><img src="/2022/05/05/DASCTF-Apr-Writeup/image-20220501115942821.png" alt="image-20220501115942821"></p>
<h4 id="翻译字节码"><a href="#翻译字节码" class="headerlink" title="翻译字节码"></a>翻译字节码</h4><p>dis模块得到字节码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> marshal</span><br><span class="line"><span class="keyword">import</span> dis</span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&#x27;aaa.pyc&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">data=f.read()</span><br><span class="line">Pycode=data[<span class="number">16</span>:]</span><br><span class="line">Pyobj=marshal.loads(Pycode)</span><br><span class="line">dis.dis(Pyobj)</span><br></pre></td></tr></table></figure>
<p>大概翻译了一下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> cup <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">flag=<span class="built_in">input</span>(<span class="string">&#x27;请输入flag&#x27;</span>)</span><br><span class="line">pubkey=[<span class="number">12702192797044914024075774649965354105344232304099465264316470282606351700311177624703682814557100043599414982439635470829841890299241342602374578366076034128412992290094164613120745611751102797279925764448133764246126488845600641524814194290745105708735258127757986238766868988676022258542038318776640732920027324986285887310132372524224961045858183153047991881042129131551711617627844146600513830709959185824512201669420128585170924683844128155435146399996585220865423125338735154727569986267948480523307784641442521735105741341230032585576300299944879647981670048377150556292280650846158185797588466680532743801893</span>,<span class="number">12680615221091469696163926483122992106481999501435284497098601343706982733487916553201934931961274845294041438909951977672521864927961654544622905443692482152403380984734291652023321187458458985625147422841102922314725726207365632256563373977251725785357590588556314671253970422319546403985257810950046085994573229162322957630767327089195523762665081311711474689269184996318744510300057603532953644164998953897411177604349567514705039306693117602798453972917348902600111420473965929048876821563646206875034926505783009957256212261250539005023918242209009676914632796839852778318989278092929214021282438144809708279435</span>]</span><br><span class="line">m=libnum.s2n(flag)</span><br><span class="line">c=<span class="built_in">str</span>(<span class="built_in">pow</span>(m,pubkey[<span class="number">1</span>],pubkey[<span class="number">0</span>]))</span><br><span class="line">strange1=[]</span><br><span class="line">strange2=[<span class="number">3532577106</span>, <span class="number">1472742623</span>, <span class="number">3642468664</span>, <span class="number">4193500461</span>, <span class="number">2398676029</span>, <span class="number">617653972</span>, <span class="number">1474514999</span>, <span class="number">1471783658</span>, <span class="number">1012864704</span>, <span class="number">3615627536</span>, <span class="number">993855884</span>, <span class="number">438456717</span>, <span class="number">3358938551</span>, <span class="number">3906991208</span>, <span class="number">198959101</span>, <span class="number">3317190635</span>, <span class="number">3656923078</span>, <span class="number">613157871</span>, <span class="number">2398768861</span>, <span class="number">97286225</span>, <span class="number">2336972940</span>, <span class="number">1471645170</span>, <span class="number">3233163154</span>, <span class="number">583597118</span>, <span class="number">2863776301</span>, <span class="number">3183067750</span>, <span class="number">1384330715</span>, <span class="number">2929694742</span>, <span class="number">3522431804</span>, <span class="number">2181488067</span>, <span class="number">3303062236</span>, <span class="number">3825712422</span>, <span class="number">145643141</span>, <span class="number">2148976293</span>, <span class="number">2940910035</span>, <span class="number">506798154</span>, <span class="number">994590281</span>, <span class="number">2231904779</span>, <span class="number">3389770074</span>, <span class="number">2814269052</span>, <span class="number">1105937096</span>, <span class="number">1789727804</span>, <span class="number">3757028753</span>, <span class="number">2469686072</span>, <span class="number">1162286478</span>, <span class="number">680814033</span>, <span class="number">2934024098</span>, <span class="number">2162521262</span>, <span class="number">4048876895</span>, <span class="number">2121620700</span>, <span class="number">4240287315</span>, <span class="number">2391811140</span>, <span class="number">3396611602</span>, <span class="number">3091349617</span>, <span class="number">3031523010</span>, <span class="number">2486958601</span>, <span class="number">3164065171</span>, <span class="number">1285603712</span>, <span class="number">798920280</span>, <span class="number">2337813135</span>, <span class="number">4186055520</span>, <span class="number">3523024366</span>, <span class="number">1077514121</span>, <span class="number">1436444106</span>, <span class="number">2731983230</span>, <span class="number">1507202797</span>, <span class="number">500756149</span>, <span class="number">198754565</span>, <span class="number">2382448647</span>, <span class="number">880454148</span>, <span class="number">1970517398</span>, <span class="number">3217485349</span>, <span class="number">1161840191</span>, <span class="number">560498076</span>, <span class="number">1782600856</span>, <span class="number">2643721918</span>, <span class="number">1285196205</span>, <span class="number">788797746</span>, <span class="number">1195724574</span>, <span class="number">4061612551</span>, <span class="number">103427523</span>, <span class="number">2502688387</span>, <span class="number">4147162188</span>, <span class="number">617564657</span>, <span class="number">978211984</span>, <span class="number">1781482121</span>, <span class="number">2205798970</span>, <span class="number">3939973102</span>, <span class="number">3826603515</span>, <span class="number">659557668</span>, <span class="number">2582884932</span>, <span class="number">1561884856</span>, <span class="number">2217488804</span>, <span class="number">1189296962</span>, <span class="number">169145316</span>, <span class="number">2781742156</span>, <span class="number">1323893433</span>, <span class="number">824667876</span>, <span class="number">408202876</span>, <span class="number">3759637634</span>, <span class="number">4094868412</span>, <span class="number">1508996065</span>, <span class="number">162419237</span>, <span class="number">3732146944</span>, <span class="number">3083560189</span>, <span class="number">3955940127</span>, <span class="number">2393776934</span>, <span class="number">2470191468</span>, <span class="number">3620861513</span>, <span class="number">481927014</span>, <span class="number">2756226070</span>, <span class="number">3154651143</span>, <span class="number">1261069441</span>, <span class="number">2063238535</span>, <span class="number">2222237213</span>, <span class="number">101459755</span>, <span class="number">3159774417</span>, <span class="number">1721190841</span>, <span class="number">1078395785</span>, <span class="number">176506553</span>, <span class="number">3552913423</span>, <span class="number">1566142515</span>, <span class="number">1938949000</span>, <span class="number">1499289517</span>, <span class="number">3315102456</span>, <span class="number">829714860</span>, <span class="number">3843359394</span>, <span class="number">952932374</span>, <span class="number">1283577465</span>, <span class="number">2045007203</span>, <span class="number">3957761944</span>, <span class="number">3767891405</span>, <span class="number">2917089623</span>, <span class="number">3296133521</span>, <span class="number">482297421</span>, <span class="number">1734231412</span>, <span class="number">3670478932</span>, <span class="number">2575334979</span>, <span class="number">2827842737</span>, <span class="number">3413631016</span>, <span class="number">1533519803</span>, <span class="number">4008428470</span>, <span class="number">3890643173</span>, <span class="number">272960248</span>, <span class="number">317508587</span>, <span class="number">3299937500</span>, <span class="number">2440520601</span>, <span class="number">27470488</span>, <span class="number">1666674386</span>, <span class="number">1737927609</span>, <span class="number">750987808</span>, <span class="number">2385923471</span>, <span class="number">2694339191</span>, <span class="number">562925334</span>, <span class="number">2206035395</span>]</span><br><span class="line">i=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> i&lt;<span class="built_in">len</span>(c):</span><br><span class="line">    strange3=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> c[i:i+<span class="number">4</span>]:</span><br><span class="line">        strange3=(strange3&lt;&lt;<span class="number">8</span>)+<span class="built_in">ord</span>(ii)</span><br><span class="line">    strange1.append(strange3)</span><br><span class="line">    i=i+<span class="number">4</span></span><br><span class="line">i&lt;<span class="built_in">len</span>(c)</span><br><span class="line">strange4=[<span class="number">54</span>,<span class="number">54</span>,<span class="number">54</span>,<span class="number">54</span>]</span><br><span class="line">ᘠ=<span class="built_in">len</span>(strange4)</span><br><span class="line">res=encrypt(ᘠ,strange1,strange4)</span><br><span class="line"><span class="keyword">if</span> strange1==strange2:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;You are right!&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>大致流程就是先进行一个RSA加密，然后是一个encrypt函数，这里的encrypt猜测从cup中import过来，因此下面需要对打包好的pyz进行逆向</p>
<h4 id="pyinstaller加密"><a href="#pyinstaller加密" class="headerlink" title="pyinstaller加密"></a>pyinstaller加密</h4><p>这里实际上用了一个pyinstaller加密</p>
<p>解包pyz文件（注意这里需要在python3.10环境下才能解包成功）</p>
<p><img src="/2022/05/05/DASCTF-Apr-Writeup/image-20220501164423617.png" alt="image-20220501164423617"></p>
<p>然后注意从可执行文件解包回来的文件中，含有下面这个文件，其中含有加密的密钥，对其进行反编译可以得到</p>
<p><img src="/2022/05/05/DASCTF-Apr-Writeup/image-20220501164607002.png" alt="image-20220501164607002"></p>
<p>然后通过脚本对cup.pyc.encrypted进行解密，得到cup.pyc文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">import tinyaes</span><br><span class="line">import zlib</span><br><span class="line"> </span><br><span class="line">CRYPT_BLOCK_SIZE = 16</span><br><span class="line"> </span><br><span class="line"># 从crypt_key.pyc获取key，也可自行反编译获取</span><br><span class="line">key = bytes(&#x27;0000000000000tea&#x27;, &#x27;utf-8&#x27;)</span><br><span class="line"> </span><br><span class="line">inf = open(&#x27;cup.pyc.encrypted&#x27;, &#x27;rb&#x27;) # 打开加密文件</span><br><span class="line">outf = open(&#x27;cup.pyc&#x27;, &#x27;wb&#x27;) # 输出文件</span><br><span class="line"> </span><br><span class="line"># 按加密块大小进行读取</span><br><span class="line">iv = inf.read(CRYPT_BLOCK_SIZE)</span><br><span class="line"> </span><br><span class="line">cipher = tinyaes.AES(key, iv)</span><br><span class="line"> </span><br><span class="line"># 解密</span><br><span class="line">plaintext = zlib.decompress(cipher.CTR_xcrypt_buffer(inf.read()))</span><br><span class="line"></span><br><span class="line"># 补pyc头(最后自己补也行)</span><br><span class="line">outf.write(b&#x27;\x6f\x0d\x0d\x0a\0\0\0\0\0\0\0\0\0\0\0\0&#x27;)</span><br><span class="line"></span><br><span class="line"># 写入解密数据</span><br><span class="line">outf.write(plaintext)</span><br><span class="line"> </span><br><span class="line">inf.close()</span><br><span class="line">outf.close()</span><br></pre></td></tr></table></figure>
<p>最后看字节码可以分析出XXTEA加密（累</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">MX</span>(<span class="params">z, y, total, key, p, e</span>):</span></span><br><span class="line">    temp1 = (z.value&gt;&gt;<span class="number">5</span> ^ y.value&lt;&lt;<span class="number">2</span>) + (y.value&gt;&gt;<span class="number">3</span> ^ z.value&lt;&lt;<span class="number">4</span>)</span><br><span class="line">    temp2 = (total.value ^ y.value) + (key[(p&amp;<span class="number">3</span>) ^ e.value] ^ z.value)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> c_uint32(temp1 ^ temp2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">n, v, key</span>):</span></span><br><span class="line">    delta = <span class="number">0x9e3779b9</span> </span><br><span class="line">    rounds = <span class="number">6</span> + <span class="number">52</span>//n</span><br><span class="line"></span><br><span class="line">    total = c_uint32(<span class="number">0</span>)</span><br><span class="line">    z = c_uint32(v[n-<span class="number">1</span>])</span><br><span class="line">    e = c_uint32(<span class="number">0</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> rounds &gt; <span class="number">0</span>:</span><br><span class="line">        total.value += delta  </span><br><span class="line">        e.value = (total.value &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span></span><br><span class="line">        <span class="keyword">for</span> p <span class="keyword">in</span> <span class="built_in">range</span>(n-<span class="number">1</span>):</span><br><span class="line">            y = c_uint32(v[p+<span class="number">1</span>])</span><br><span class="line">            v[p] = c_uint32(v[p] + MX(z,y,total,key,p,e).value).value</span><br><span class="line">            z.value = v[p]</span><br><span class="line">        y = c_uint32(v[<span class="number">0</span>])</span><br><span class="line">        v[n-<span class="number">1</span>] = c_uint32(v[n-<span class="number">1</span>] + MX(z,y,total,key,n-<span class="number">1</span>,e).value).value</span><br><span class="line">        z.value = v[n-<span class="number">1</span>]</span><br><span class="line">        rounds -= <span class="number">1</span> </span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">n, v, key</span>):</span></span><br><span class="line">    delta = <span class="number">0x9E3779B9</span></span><br><span class="line">    rounds = <span class="number">6</span> + <span class="number">52</span>//n </span><br><span class="line">    </span><br><span class="line">    total = c_uint32(rounds * delta)</span><br><span class="line">    y = c_uint32(v[<span class="number">0</span>])</span><br><span class="line">    e = c_uint32(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> rounds &gt; <span class="number">0</span>:</span><br><span class="line">        e.value = (total.value &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span></span><br><span class="line">        <span class="keyword">for</span> p <span class="keyword">in</span> <span class="built_in">range</span>(n-<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>):</span><br><span class="line">            z = c_uint32(v[p-<span class="number">1</span>])</span><br><span class="line">            v[p] = c_uint32((v[p] - MX(z,y,total,key,p,e).value)).value</span><br><span class="line">            y.value = v[p]</span><br><span class="line">        z = c_uint32(v[n-<span class="number">1</span>])  </span><br><span class="line">        v[<span class="number">0</span>] = c_uint32(v[<span class="number">0</span>] - MX(z,y,total,key,<span class="number">0</span>,e).value).value</span><br><span class="line">        y.value = v[<span class="number">0</span>]  </span><br><span class="line">        total.value -= delta</span><br><span class="line">        rounds -= <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> v </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#  test  </span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment"># 该算法中每次可加密不只64bit的数据，并且加密的轮数由加密数据长度决定</span></span><br><span class="line"></span><br><span class="line">    k = [<span class="number">54</span>, <span class="number">54</span>, <span class="number">54</span>, <span class="number">54</span>]</span><br><span class="line">    n = <span class="number">155</span></span><br><span class="line"></span><br><span class="line">    res=[<span class="number">3532577106</span>, <span class="number">1472742623</span>, <span class="number">3642468664</span>, <span class="number">4193500461</span>, <span class="number">2398676029</span>, <span class="number">617653972</span>, <span class="number">1474514999</span>, <span class="number">1471783658</span>, <span class="number">1012864704</span>, <span class="number">3615627536</span>, <span class="number">993855884</span>, <span class="number">438456717</span>, <span class="number">3358938551</span>, <span class="number">3906991208</span>, <span class="number">198959101</span>, <span class="number">3317190635</span>, <span class="number">3656923078</span>, <span class="number">613157871</span>, <span class="number">2398768861</span>, <span class="number">97286225</span>, <span class="number">2336972940</span>, <span class="number">1471645170</span>, <span class="number">3233163154</span>, <span class="number">583597118</span>, <span class="number">2863776301</span>, <span class="number">3183067750</span>, <span class="number">1384330715</span>, <span class="number">2929694742</span>, <span class="number">3522431804</span>, <span class="number">2181488067</span>, <span class="number">3303062236</span>, <span class="number">3825712422</span>, <span class="number">145643141</span>, <span class="number">2148976293</span>, <span class="number">2940910035</span>, <span class="number">506798154</span>, <span class="number">994590281</span>, <span class="number">2231904779</span>, <span class="number">3389770074</span>, <span class="number">2814269052</span>, <span class="number">1105937096</span>, <span class="number">1789727804</span>, <span class="number">3757028753</span>, <span class="number">2469686072</span>, <span class="number">1162286478</span>, <span class="number">680814033</span>, <span class="number">2934024098</span>, <span class="number">2162521262</span>, <span class="number">4048876895</span>, <span class="number">2121620700</span>, <span class="number">4240287315</span>, <span class="number">2391811140</span>, <span class="number">3396611602</span>, <span class="number">3091349617</span>, <span class="number">3031523010</span>, <span class="number">2486958601</span>, <span class="number">3164065171</span>, <span class="number">1285603712</span>, <span class="number">798920280</span>, <span class="number">2337813135</span>, <span class="number">4186055520</span>, <span class="number">3523024366</span>, <span class="number">1077514121</span>, <span class="number">1436444106</span>, <span class="number">2731983230</span>, <span class="number">1507202797</span>, <span class="number">500756149</span>, <span class="number">198754565</span>, <span class="number">2382448647</span>, <span class="number">880454148</span>, <span class="number">1970517398</span>, <span class="number">3217485349</span>, <span class="number">1161840191</span>, <span class="number">560498076</span>, <span class="number">1782600856</span>, <span class="number">2643721918</span>, <span class="number">1285196205</span>, <span class="number">788797746</span>, <span class="number">1195724574</span>, <span class="number">4061612551</span>, <span class="number">103427523</span>, <span class="number">2502688387</span>, <span class="number">4147162188</span>, <span class="number">617564657</span>, <span class="number">978211984</span>, <span class="number">1781482121</span>, <span class="number">2205798970</span>, <span class="number">3939973102</span>, <span class="number">3826603515</span>, <span class="number">659557668</span>, <span class="number">2582884932</span>, <span class="number">1561884856</span>, <span class="number">2217488804</span>, <span class="number">1189296962</span>, <span class="number">169145316</span>, <span class="number">2781742156</span>, <span class="number">1323893433</span>, <span class="number">824667876</span>, <span class="number">408202876</span>, <span class="number">3759637634</span>, <span class="number">4094868412</span>, <span class="number">1508996065</span>, <span class="number">162419237</span>, <span class="number">3732146944</span>, <span class="number">3083560189</span>, <span class="number">3955940127</span>, <span class="number">2393776934</span>, <span class="number">2470191468</span>, <span class="number">3620861513</span>, <span class="number">481927014</span>, <span class="number">2756226070</span>, <span class="number">3154651143</span>, <span class="number">1261069441</span>, <span class="number">2063238535</span>, <span class="number">2222237213</span>, <span class="number">101459755</span>, <span class="number">3159774417</span>, <span class="number">1721190841</span>, <span class="number">1078395785</span>, <span class="number">176506553</span>, <span class="number">3552913423</span>, <span class="number">1566142515</span>, <span class="number">1938949000</span>, <span class="number">1499289517</span>, <span class="number">3315102456</span>, <span class="number">829714860</span>, <span class="number">3843359394</span>, <span class="number">952932374</span>, <span class="number">1283577465</span>, <span class="number">2045007203</span>, <span class="number">3957761944</span>, <span class="number">3767891405</span>, <span class="number">2917089623</span>, <span class="number">3296133521</span>, <span class="number">482297421</span>, <span class="number">1734231412</span>, <span class="number">3670478932</span>, <span class="number">2575334979</span>, <span class="number">2827842737</span>, <span class="number">3413631016</span>, <span class="number">1533519803</span>, <span class="number">4008428470</span>, <span class="number">3890643173</span>, <span class="number">272960248</span>, <span class="number">317508587</span>, <span class="number">3299937500</span>, <span class="number">2440520601</span>, <span class="number">27470488</span>, <span class="number">1666674386</span>, <span class="number">1737927609</span>, <span class="number">750987808</span>, <span class="number">2385923471</span>, <span class="number">2694339191</span>, <span class="number">562925334</span>, <span class="number">2206035395</span>]</span><br><span class="line"></span><br><span class="line">    res = decrypt(n, res, k)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># print(res)</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> res:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(i&gt;&gt;<span class="number">24</span>),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>((i&amp;<span class="number">0x00ff0000</span>)&gt;&gt;<span class="number">16</span>),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>((i&amp;<span class="number">0x0000ff00</span>)&gt;&gt;<span class="number">8</span>),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(i&amp;<span class="number">0x000000ff</span>),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"> </span><br><span class="line"> <span class="comment">#c= 10610336534759505889607399322387179316771488492347274741918862678692508953185876570981227584004676580623553664818853686933004290078153620168054665086468417541382824708104480882577200529822968531743002301934310349005341104696887943182074473298650903541494918266823037984054778903666406545980557074219162536057146090758158128189406073809226361445046225524917089434897957301396534515964547462425719205819342172669899546965221084098690893672595962129879041507903210851706793788311452973769358455761907303633956322972510500253009083922781934406731633755418753858930476576720874219359466503538931371444470303193503733920039</span></span><br><span class="line"> </span><br></pre></td></tr></table></figure>
<p>最后通过RSA的维纳攻击即可恢复出flag</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a target="_blank" rel="noopener" href="https://gift1a.github.io/2022/04/23/DASCTF-FATE-Reverse/#more">DASCTF-FATE-Reverse | Hexo (gift1a.github.io)</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_48218081/article/details/124390229">Re]2022DASCTF Apr X FATE 防疫挑战赛_批某人的博客-CSDN博客</a></li>
<li><a target="_blank" rel="noopener" href="http://www.yunzh1jun.com/2022/04/25/DASCTF/#FakePica">DASCTF 2022 - 云之君 (yunzh1jun.com)</a></li>
<li><a target="_blank" rel="noopener" href="https://ppppz.net/">https://ppppz.net/</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.t0hka.top/index.php/archives/36/">_(:3」」还是被发现了 (t0hka.top)</a></li>
<li><a target="_blank" rel="noopener" href="https://bbs.pediy.com/thread-271253.htm">[原创]Python逆向——Pyinstaller逆向-软件逆向-看雪论坛-安全社区|安全招聘|bbs.pediy.com</a></li>
</ul>
</div><div class="article-licensing box"><div class="licensing-title"><p>DASCTF Apr Writeup</p><p><a href="http://curator-kim.github.io/2022/05/05/DASCTF-Apr-Writeup/">http://curator-kim.github.io/2022/05/05/DASCTF-Apr-Writeup/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><a href="http://Curator-Kim.github.io"><p>Curator-Kim</p></a></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2022-05-05</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2022-05-05</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="recommend-area"><div class="recommend-post"><span class="is-size-6 has-text-grey has-mr-7"># Related Post</span><br><span>  1.<a class="is-size-6" href="/2022/04/24/Crypto-CopperSmith/" target="_blank">Crypto-CopperSmith</a><br></span><span>  2.<a class="is-size-6" href="/2022/04/23/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80-12-%E7%AB%AF%E5%8F%A3/" target="_blank">汇编语言 14 端口</a><br></span><span>  3.<a class="is-size-6" href="/2022/04/22/Reverse-6/" target="_blank">Reverse 6</a><br></span><span>  4.<a class="is-size-6" href="/2022/04/22/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80-11-int%E6%8C%87%E4%BB%A4/" target="_blank">汇编语言 11 int指令</a><br></span><span>  5.<a class="is-size-6" href="/2022/04/06/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80-10-%E5%86%85%E4%B8%AD%E6%96%AD/" target="_blank">汇编语言(10) 内中断</a><br></span><span>  6.<a class="is-size-6" href="/2022/04/05/2022-DASCTF-Mar-Writeup/" target="_blank">2022 DASCTF Mar Writeup</a><br></span><span>  7.<a class="is-size-6" href="/2022/04/01/BUAACTF-2022-WP/" target="_blank">BUAACTF 2022 WP</a><br></span><span>  8.<a class="is-size-6" href="/2022/03/31/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80-9-%E6%A0%87%E5%BF%97%E5%AF%84%E5%AD%98%E5%99%A8/" target="_blank">汇编语言(9) 标志寄存器</a><br></span></div></div><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/css/share.min.css"><div class="social-share"></div><script src="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>Alipay</span><span class="qrcode"><img src="https://github.com/Curator-Kim/Curator-Kim.github.io/blob/master/img/alipay.png?raw=true" alt="Alipay"></span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>Wechat</span><span class="qrcode"><img src="https://github.com/Curator-Kim/Curator-Kim.github.io/blob/master/img/wechat.png?raw=true" alt="Wechat"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2022/04/24/Crypto-CopperSmith/"><span class="level-item">Crypto-CopperSmith</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--><div class="card"><div class="card-content"><div class="title is-5">Comments</div><div id="comment-container"></div><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/gitalk/1.6.0/gitalk.css"><script> $.getScript('/js/gitalk.min.js', function () { 
            var gitalk = new Gitalk({
            language:'zh-CN',
            id: '988ca2fc51daee3b31be063ebb319aac',
            repo: 'blog_comment',
            owner: 'Curator-Kim',
            clientID: '46a9f3481b46ea0129d8',
            clientSecret: '79c7c9cb847e141757d7864453bcbf89f0655b24',
            admin: ["Curator-Kim"],
            createIssueManually: true,
            distractionFreeMode: false,
            perPage: 10,
            pagerDirection: 'last',
            proxy: 'https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token',
            
            enableHotKey: true,
            isLocked: false
        })
        gitalk.render('comment-container')});</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><!--!--><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="https://github.com/Curator-Kim/Curator-Kim.github.io/blob/22a41709ffc26f62191d72a87ffbb342d46bfce3/img/icon.jpg?raw=true" alt="Curator-Kim"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Curator-Kim</p><p class="is-size-6 is-block">寻几处好景破星光</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>火星</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">31</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">14</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/ppoffice" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/curator-kim"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Email" href="/804242129@qq.com"><i class="fa fa-envelope"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/atom.xml"><i class="fas fa-rss"></i></a></div><div><hr><p id="hitokoto">:D 一言句子获取中...</p><script type="text/javascript" defer>function getYiyan(){
                                $.getJSON("https://v1.hitokoto.cn/", function (data) {
                                if(data){
                                    $('#hitokoto').html("");
                                    $('#hitokoto').append("<strong style='color: #3273dc;'>"+data.hitokoto+"</strong>"+
                                    "<p>"+"From《"+data.from+"》</p><p>Provider-"+data.creator+"</p>");
                                }});}
                                $(function (){getYiyan();$('#hitokoto').click(function(){getYiyan();})});</script></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile" href="https://bulma.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bulma</span></span><span class="level-right"><span class="level-item tag">bulma.io</span></span></a></li></ul></div></div></div><!--!--><div class="card widget"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-05-05T01:47:30.000Z">2022-05-05</time></p><p class="title"><a href="/2022/05/05/DASCTF-Apr-Writeup/">DASCTF Apr Writeup</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-04-24T02:42:57.000Z">2022-04-24</time></p><p class="title"><a href="/2022/04/24/Crypto-CopperSmith/">Crypto-CopperSmith</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-04-23T12:54:25.000Z">2022-04-23</time></p><p class="title"><a href="/2022/04/23/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80-12-%E7%AB%AF%E5%8F%A3/">汇编语言 14 端口</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-04-22T01:36:24.000Z">2022-04-22</time></p><p class="title"><a href="/2022/04/22/Reverse-6/">Reverse 6</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-04-22T01:36:10.000Z">2022-04-22</time></p><p class="title"><a href="/2022/04/22/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80-11-int%E6%8C%87%E4%BB%A4/">汇编语言 11 int指令</a></p></div></article></div></div><!--!--><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2022/05/"><span class="level-start"><span class="level-item">May 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2022/04/"><span class="level-start"><span class="level-item">April 2022</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2022/03/"><span class="level-start"><span class="level-item">March 2022</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2022/02/"><span class="level-start"><span class="level-item">February 2022</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2022/01/"><span class="level-start"><span class="level-item">January 2022</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><a class="level is-mobile is-marginless" href="/archives/"><span class="level-start"><span class="level-item">查看全部&gt;&gt;</span></span></a></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/CTF/"><span class="tag">CTF</span><span class="tag is-grey-lightest">14</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80/"><span class="tag">汇编语言</span><span class="tag is-grey-lightest">12</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Crypto/"><span class="tag">Crypto</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/RE/"><span class="tag">RE</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Reverse/"><span class="tag">Reverse</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ctf/"><span class="tag">ctf</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pwn/"><span class="tag">pwn</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CopperSmith/"><span class="tag">CopperSmith</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DES/"><span class="tag">DES</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Re/"><span class="tag">Re</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SMC/"><span class="tag">SMC</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/re/"><span class="tag">re</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99/"><span class="tag">参考资料</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%A2%84%E5%A4%87%E7%9F%A5%E8%AF%86/"><span class="tag">预备知识</span><span class="tag is-grey-lightest">1</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe for updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div><!--!--><div class="column-right-shadow is-hidden-widescreen"></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="https://github.com/Curator-Kim/Curator-Kim.github.io/blob/master/img/logo.png?raw=true" alt="Curator-Kim的小站" height="28"></a><p class="size-small"><span>&copy; 2022 Curator-Kim</span>  Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a> &amp; <a href="https://github.com/removeif/hexo-theme-amazing" target="_blank">Amazing</a> <br><span>© <a href="http://www.beian.miit.gov.cn/" target="_blank">粤ICP备88888888号-8（测试）</a><br></span><span>© 版权说明：[本网站所有内容均收集于互联网或自己创作,<br />&nbsp;&nbsp;&nbsp;&nbsp;方便于网友与自己学习交流，如有侵权，请<a href="/message" target="_blank">留言</a>，立即处理]<br /></span><span><span id="statistic-times">loading...</span><script>function createTime(time) {
            var n = new Date(time);
            now.setTime(now.getTime() + 250),
                days = (now - n) / 1e3 / 60 / 60 / 24,
                dnum = Math.floor(days),
                hours = (now - n) / 1e3 / 60 / 60 - 24 * dnum,
                hnum = Math.floor(hours),
            1 == String(hnum).length && (hnum = "0" + hnum),
                minutes = (now - n) / 1e3 / 60 - 1440 * dnum - 60 * hnum,
                mnum = Math.floor(minutes),
            1 == String(mnum).length && (mnum = "0" + mnum),
                seconds = (now - n) / 1e3 - 86400 * dnum - 3600 * hnum - 60 * mnum,
                snum = Math.round(seconds),
            1 == String(snum).length && (snum = "0" + snum),
                document.getElementById("statistic-times").innerHTML = "❤️Site from <strong>"+time.split(" ")[0].replace(/\//g,".")+"</strong> has existed <strong>" + dnum + "</strong> d <strong>" + hnum + "</strong> h <strong>" + mnum + "</strong> m <strong>" + snum + "</strong> s！❤️";
        }var now = new Date();setInterval("createTime('2022/1/21 00:00:00')", 250,"");</script><br></span><div class="size-small"><span>❤️Thx <strong><span id="busuanzi_value_site_uv">99+</span></strong> users <strong><span id="busuanzi_value_site_pv">99+</span></strong> visited！❤️</span></div></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/removeif/hexo-theme-amazing"><i class="fab fa-github"></i></a></p></div><div class="sideMusic"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="/js/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script><meting-js style="width: auto;height: 2000px;" server="netease" type="playlist" id="137510737" theme="#2980b9" loop="all" autoplay="false" order="list" storageName="aplayer-setting" lrctype="0" list-max-height="400px" fixed="true"></meting-js></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><script src="/js/main.js" defer></script><script>$.getScript('/js/comment-issue-data.js',function(){loadIssueData('46a9f3481b46ea0129d8','79c7c9cb847e141757d7864453bcbf89f0655b24','Curator-Kim','blog_comment',false);})</script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.js"></script><script type="text/javascript">var pjax = new Pjax({
            elements: "a",//代表点击链接就更新
            selectors: [  //代表要更新的节点
                ".section",
                "title"
            ],
            cache: true,
            cacheBust:false
        })

        function loadBusuanzi(){
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js", function () {});
        }

        function loadMathJax() { //加载mathjax
            $.getScript("//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML", function () {
                MathJax.Hub.Config({ tex2jax: { inlineMath: [['$', '$'], ['\(', '\)']] } });
                var math = document.getElementsByClassName("entry-content")[0];
                MathJax.Hub.Queue(["Typeset", MathJax.Hub, math]);
            });
        };

        // 开始 PJAX 执行的函数
        document.addEventListener('pjax:send', function () {
        });
        
        // PJAX 完成之后执行的函数，可以和上面的重载放在一起
        document.addEventListener('pjax:complete', function () {
            $(".section").css({opacity:1});
            if(false){
                $.getScript('/js/comment-issue-data.js',function(){loadIssueData('46a9f3481b46ea0129d8','79c7c9cb847e141757d7864453bcbf89f0655b24','Curator-Kim','blog_comment',false);});
            }
            if(false){
                loadMathJax();
            }
            loadMainJs(jQuery, window.moment, window.ClipboardJS, window.IcarusThemeSettings);
            loadBackTop();
            loadBusuanzi();
            if(typeof loadBanner == 'function'){
                loadBanner();
            }
        });</script></body></html>